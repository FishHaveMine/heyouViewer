"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),version="2020-7-1-17-48",Glodon=window.Glodon||{};Glodon.Version=version,function(){function e(e,t){for(var n=t.split("."),o=e,i=n.length,a=0;a<i;a++)void 0===o[n[a]]&&(o[n[a]]={}),o=o[n[a]];return o}e(Glodon,"Web.Lang.Utility.Namespace").ensureNamespace=e}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Common"),t=function(e){"string"==typeof e&&(e=JSON.parse(res)),this.code=e.code,this.message=e.message};t.prototype={getErrorCode:function(){return this.code},getErrorMessage:function(){return this.message}},e.Error=t}();var Vector3=function(){function e(t,n,o){_classCallCheck(this,e),this.x=t||0,this.y=n||0,this.z=o||0}return _createClass(e,[{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,o=this.z-e.z;return t*t+n*n+o*o}}]),e}(),Box3=function(){function e(t,n){_classCallCheck(this,e),this.min=t||new Vector3(1/0,1/0,1/0),this.max=n||new Vector3(-1/0,-1/0,-1/0)}return _createClass(e,[{key:"getSize",value:function(){return new Vector3(this.max.x-this.min.x,this.max.y-this.min.y,this.max.z-this.min.z)}},{key:"setFromCenterAndSize",value:function(e,t){var n=new Vector3(t.x,t.y).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"getCenter",value:function(){return new Vector3(this.min.x+this.max.x,this.min.y+this.max.y,this.min.z+this.max.z).multiplyScalar(.5)}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}}]),e}();!function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Algorithm"),t=function(){function e(t,n){_classCallCheck(this,e),this.points=t,this.searchRangeSquared=Math.pow(n,2),this.EPSILON_SQR=.1,this.clusters=[]}return _createClass(e,[{key:"meanShift",value:function(e){for(var t=e.clone(),n=[];;){var o=this.rangeSearch(t);this.connect(n,o);var i=this.mean(o);if(t.distanceToSquared(i)<=this.EPSILON_SQR)break;t=i}return n}},{key:"mean",value:function(e){var t=new Vector3,n=!0,o=!1,i=void 0;try{for(var a,r=e[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;t.add(s)}}catch(e){o=!0,i=e}finally{try{!n&&r.return&&r.return()}finally{if(o)throw i}}return t.multiplyScalar(1/e.length),t}},{key:"rangeSearch",value:function(e){var t=[],n=!0,o=!1,i=void 0;try{for(var a,r=this.points[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;e.distanceToSquared(s)<=this.searchRangeSquared&&t.push(s)}}catch(e){o=!0,i=e}finally{try{!n&&r.return&&r.return()}finally{if(o)throw i}}return t}},{key:"clustering",value:function(){var e=1,t=!0,n=!1,o=void 0;try{for(var i,a=this.points[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var r=i.value;if(!r.stopMoving){var s=this.meanShift(r);this.mergeClusters({points:s,center:this.mean(s),id:e++})}}}catch(e){n=!0,o=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw o}}}},{key:"mergeClusters",value:function(e){var t=!1,n=!0,o=!1,i=void 0;try{for(var a,r=this.clusters[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;if(e.center.distanceToSquared(s.center)<=4*this.searchRangeSquared){this.connect(s.points,e.points,!0),s.center=this.mean(s.points),this.updateClusterBbox(s),t=!0;break}}}catch(e){o=!0,i=e}finally{try{!n&&r.return&&r.return()}finally{if(o)throw i}}!1===t&&(this.updateClusterBbox(e),this.clusters.push(e))}},{key:"updateClusterBbox",value:function(e){var t=(new Box3).setFromPoints(e.points);e.bbox=t}},{key:"connect",value:function(e,t,n){var o=!0,i=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var l=r.value;l.stopMoving&&!n||e.push(l),l.stopMoving=!0}}catch(e){i=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}return e}}]),e}();e.MeanShift=t}();var Vector2=function(){function e(t,n){_classCallCheck(this,e),this.x=t||0,this.y=n||0}return _createClass(e,[{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"normalize",value:function(){return this.multiplyScalar(1/this.length())}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),o=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*o+e.x,this.y=i*o+a*n+e.y,this}},{key:"setLength",value:function(e){return this.multiplyScalar(e/this.length())}},{key:"angle",value:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e}}]),e}(),Box2=function(){function e(t,n){_classCallCheck(this,e),this.min=t||new Vector2(1/0,1/0),this.max=n||new Vector2(-1/0,-1/0)}return _createClass(e,[{key:"getSize",value:function(){return new Vector2(this.max.x-this.min.x,this.max.y-this.min.y)}},{key:"setFromCenterAndSize",value:function(e,t){var n=new Vector2(t.x,t.y).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"getCenter",value:function(){return new Vector2(this.min.x+this.max.x,this.min.y+this.max.y).multiplyScalar(.5)}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}}]),e}();if(function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Algorithm"),t=function e(){_classCallCheck(this,e)};t.toThreeJsBox2=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],o=!0,i=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var l=r.value,d=Math.min(t,100)/100,c=Math.max(l[1][1]-l[0][1],l[1][0]-l[0][0]),u=c*d,p=new Vector2(l[0][0],l[0][1]),h=new Vector2(l[1][0],l[1][1]),f=new Box2(p,h),m=f.getSize();n.push((new Box2).setFromCenterAndSize(f.getCenter(),m.addScalar(2*u)))}}catch(e){i=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}var g=0,v=!0,b=!1,y=void 0;try{for(var w,C=n[Symbol.iterator]();!(v=(w=C.next()).done);v=!0){w.value.indices=[g++]}}catch(e){b=!0,y=e}finally{try{!v&&C.return&&C.return()}finally{if(b)throw y}}return n},t.toDrawingBox2=function(e){var t=[],n=!0,o=!1,i=void 0;try{for(var a,r=e[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value,l=[];l.push([s.min.x,s.min.y]),l.push([s.max.x,s.max.y]),t.push(l)}}catch(e){o=!0,i=e}finally{try{!n&&r.return&&r.return()}finally{if(o)throw i}}return t},t.merge=function(e,t){for(var n=e.length,o=0;o<=n;o++){if(o===n){e.push(t);break}var i=e[o];if(i.intersectsBox(t)){i.union(t),i.indices=i.indices.concat(t.indices);break}}},t.mergeBoundingBox=function(e){for(var n=e,o=[];;){for(var i=0;i<n.length;i++)t.merge(o,n[i]);if(o.length===n.length)break;n=o.slice(0,o.length),o=[]}return o},e.BoundingBoxUtil=t}(),function(){function e(e){function t(){}return t.prototype=e,new t}function t(t,n){var o=e(n.prototype);o.constructor=t,t.prototype=o}Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Type").inheritPrototype=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.HttpRequest"),t=function(e){var t,n={type:"get",cache:!0,headers:{"Content-type":"application/x-www-form-urlencoded"},data:null,async:!0,success:null,failure:null},o=Object.assign(n,e);t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),t.onreadystatechange=function(){if(4==t.readyState){var e=t.status;e>=200&&e<300||0==e?o.success&&o.success(t.responseText,t.responseXML):o.failure&&o.failure(e)}},t.open(o.type,o.url,o.async);for(var i in o.headers)t.setRequestHeader(i,o.headers[i]);t.send(o.data)},n=function(e,t){var n={};if(n[e])t&&t();else{var o=document.createElement("script");o.type="text/javascript",o.src=e,document.head.appendChild(o),n[e]=!0,o.readyState?o.onreadystatechange=function(){"loaded"!=o.readyState&&"complete"!=o.readyState||(o.onreadystatechange=null,t&&t())}:o.onload=function(){t&&t()}}},o=function(e,n){return new Promise(function(o,i){t({url:e,method:"GET",success:function(e){try{var t=JSON.parse(e)}catch(t){return o(e)}"success"==t.code||"noCode"==n?o("noCode"==n?t:t.data):i("requestError，dataCode:"+t.code+", dataMessage:"+t.message)},failure:function(e){i(e)}})})};e.ajax=t,e.promiseJSONRequest=o,e.getScript=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.FullScreen"),t=function(e){if(!e)return!1;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},n=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},o=function(){return document.webkitIsFullScreen||!!document.mozFullScreenElement||!!document.msFullScreenElement||!1},i=function(e){var t=function(){e&&e()};document.onfullscreenchange=t,document.onwebkitfullscreenchange=t,document.documentElement.onwebkitfullscreenchange=t,document.onmozfullscreenchange=t,document.onmsfullscreenchange=t};e.fullScreen=t,e.exitFullScreen=n,e.onFullScreenChanged=i,e.isFullScreen=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.ClientHelper"),t=function(){var e=navigator.userAgent,t=/(?:Windows Phone)/.test(e),n=/(?:SymbianOS)/.test(e)||t,o=/(?:Android)/.test(e),i=/(?:Firefox)/.test(e),a=(/(?:Chrome|CriOS)/.test(e),/(?:iPad|PlayBook)/.test(e)||o&&!/(?:Mobile)/.test(e)||i&&/(?:Tablet)/.test(e));return!(/(?:iPhone)/.test(e)&&!a||o||n||a)},n=function(){return/(?:iPhone)/.test(navigator.userAgent)},o=function(e){var t=function(e){return e.replace("viewToken.json","").replace(/\.\//g,"/").replace(/\/\//g,"/")};if(e.indexOf("://")>-1){var n=e.split("://");e=n[0]+"://"+t(n[1])}else e="./"!=e.slice(0,2)?t(e):"."+t(e.slice(1));return e},i=function(e,t,n){n=n||"asc";var o=!1;return t?t.indexOf(".")>-1&&(o=!0):t="name",e=e.sort(function(e,i){if(o){var a=l(e,t),r=l(i,t);return"asc"==n?a.localeCompare(r):r.localeCompare(a)}return"asc"==n?e[t].localeCompare(i[t]):i[t].localeCompare(e[t])}),s(e,t,o)},a=function(e,t,n){n=n||"asc";var o=!1;return t?t.indexOf(".")>-1&&(o=!0):t="name",e=e.sort(r(t,o)),s(e,t,o)},r=function(e,t){return function(n,o){function i(e,t,n){if(n){for(s=t;(n=i(e,s))<76&&n>65;)++s;return+e.slice(t-1,s)}return n=h&&h.indexOf(e.charAt(t)),n>-1?n+76:(n=e.charCodeAt(t)||0)<45||n>127?n:n<46?65:n<48?n-1:n<58?n+18:n<65?n-11:n<91?n+11:n<97?n-37:n<123?n+5:n-63}var a,r;t?(a=l(n,e),r=l(o,e)):(a=n[e],r=o[e]);var s,d,c=1,u=0,p=0,h=String.alphabet;if((a+="")!=(r+=""))for(;c;)if(d=i(a,u++),c=i(r,p++),d<76&&c<76&&d>66&&c>66&&(d=i(a,u,u),c=i(r,p,u=s),p=s),d!=c)return d<c?-1:1;return 0}},s=function(e,t,n){var o=[],i=[],a=[],r=[];return e.map(function(e,s){var d;d=n?l(e,t):e[t],/^[a-zA-Z]*$/.test(d.slice(0,1))?o.push(e):/^[\u4e00-\u9fa5]*$/.test(d.slice(0,1))?i.push(e):/^\d+(\.\d+)?$/.test(d.slice(0,1))?a.push(e):r.push(e)}),r.concat(a,o,i)},l=function(e,t){var n=t.split("."),o=e;return n.map(function(e,t){o=o[e]}),o},d=function(){return!!(window.ActiveXObject||"ActiveXObject"in window)},c=function(e,t,n,o,i,a){var r=void 0,s=void 0,l=void 0,d=void 0,c=0,u=Math.sqrt((n-e)*(n-e)+(o-t)*(o-t));if(0===u)return[0,{x:n,y:o}];var p=Math.sqrt((i-e)*(i-e)+(a-t)*(a-t));if(0===p)return[0,{x:i,y:a}];var h=Math.sqrt((n-i)*(n-i)+(o-a)*(o-a));if(0===h)return c=u,[c,{x:n,y:o}];if(u<p){if(o===a?r=n<i?0:Math.PI:(d=(i-n)/h,d-1>1e-5&&(d=1),r=Math.acos(d),o>a&&(r=2*Math.PI-r)),d=(e-n)/u,d-1>1e-5&&(d=1),s=Math.acos(d),o>t&&(s=2*Math.PI-s),l=s-r,l<0&&(l=-l),l>Math.PI&&(l=2*Math.PI-l),l>Math.PI/2)return[u,{x:n,y:o}];if(n===i)return[p*Math.sin(l),{x:n,y:t}];if(o===a)return[p*Math.sin(l),{x:e,y:o}];var f=0,m=0,g=(a-o)/i-n,v=-1/g,b=t-e*v;return f=(a-i*g-b)/(v-g),m=v*f+b,[u*Math.sin(l),{x:f,y:m}]}if(o===a?r=n<i?Math.PI:0:(d=(n-i)/h,d-1>1e-5&&(d=1),r=Math.acos(d),a>o&&(r=2*Math.PI-r)),d=(e-i)/p,d-1>1e-5&&(d=1),s=Math.acos(d),a>t&&(s=2*Math.PI-s),l=s-r,l<0&&(l=-l),l>Math.PI&&(l=2*Math.PI-l),l>Math.PI/2)return[p,{x:i,y:a}];if(n===i)return[p*Math.sin(l),{x:n,y:t}];if(o===a)return[p*Math.sin(l),{x:e,y:o}];var y=0,w=0,C=(a-o)/i-n,M=-1/C,k=t-e*M;return y=(a-i*C-k)/(M-C),w=M*y+k,[p*Math.sin(l),{x:y,y:w}]},u=function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}},p=function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(e){return!1}};e.getIsDesktop=t,e.getIsIphone=n,e.getIsIE=d,e.formatURL=o,e.sortByName=i,e.sortByRules=a,e.PointToLineDistance=c,e.isWebGLAvailable=u,e.isWebGL2Available=p}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.MouseMotion"),t=function(e){function t(){n&&"walk"==e.getViewer().getEditorManager().editor.name||(o.addClass("motion-zoom"),i=Date.now(),setTimeout(function(){Date.now()-i>180&&o.removeClass("motion-zoom")},200))}var n=!1,o=e.getDomElement(),i=void 0,a=!1,r=!1,s=null;Glodon.Bimface.Viewer.Viewer3D&&e instanceof Glodon.Bimface.Viewer.Viewer3D&&(n=!0),o.addEventListener("keydown",function(e){17==event.keyCode&&(a=!0)}),o.addEventListener("keyup",function(e){17==event.keyCode&&(a=!1)}),o.addEventListener("mousedown",function(t){e._opt.enableZoomRect||a||(s={x:t.clientX,y:t.clientY})}),o.addEventListener("mousemove",function(t){if(s&&!r&&!(Math.abs(s.x-t.clientX)<2&&Math.abs(s.y-t.clientY)<2)){if(n){var i=e.getUseLeftHandedInput();if("walk"==e.getViewer().getEditorManager().editor.name)1==t.buttons&&o.addClass("motion-rotate");else{var a=e._getIsCursorEnabled();1==t.buttons?a&&o.addClass(i?"motion-rotate":"motion-translate"):o.addClass(i?"motion-translate":"motion-rotate")}}else 1==t.buttons&&o.addClass("motion-translate");r=!0}}),o.addEventListener("mousewheel",t,!1),o.addEventListener("DOMMouseScroll",t,!1),o.addEventListener("mouseup",function(e){s=!1,r=!1,o.removeClass("motion-translate"),o.removeClass("motion-rotate")})};e.setCursor=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(e,t){var n=document.createElement(e);return n.setAttribute("class",t),n};e.create=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);return n.setAttribute("class",t),n};e.createNS=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(e){return e.indexof("#")?document.getElementById(e.replace("#","")):e.indexof(".")?document.getElementsByClassName(e.replace(".","")):document.getElementsByTagName(e)};e.select=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),n=function(e){var n={element:null,handle:null,axis:"all",cursor:"move",distance:0,start:null,move:null,stop:null,bBoxDetection:!1},o=Object.assign(n,e),i=o.element;if(!i)return!1;var a=o.handle||i,r=void 0,s=!1,l=this,d=function(e){return Math.pow(e.x,2)+Math.pow(e.y,2)>Math.pow(o.distance,2)&&(o.start&&o.start(r),!0)},c=function(e){var t=navigator.userAgent;return t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!isOpera?1==e:0==e};this.resize=function(e,t,n){t=t||{x:0,y:0};var i=e.getBoundingClientRect(),a=e.parentElement.getBoundingClientRect(),r=i.left-a.left,s=i.top-a.top,l=e.offsetWidth,d=e.offsetHeight,c=e.parentElement.offsetWidth,u=e.parentElement.offsetHeight,p=Math.min(r+t.x,c-l),h=Math.min(s+t.y,u-d),f=r+t.x<0?0:p>0&&p||0,m=s+t.y<0?0:h>0&&h||0;n&&0!=f&&0!=m||(e.style.left=f+"px",e.style.top=m+"px",e.style.transform="none",o.record&&o.record(f,m))};var u=function(e){var t=i.getBoundingClientRect(),n=i.parentElement.getBoundingClientRect(),a=t.left-n.left,r=t.top-n.top;if(o.bBoxDetection)l.resize(i,e);else{var s=a+e.x,d=r+e.y;switch(o.axis){case"x":i.style.left=s+"px";break;case"y":i.style.top=d+"px";break;case"all":default:i.style.left=s+"px",i.style.top=d+"px"}}},p=function(e){var n=e;if(t){if(!c(n.button))return;r={x:n.clientX,y:n.clientY},document.addEventListener("mousemove",h)}else r={x:n.touches[0].clientX,y:n.touches[0].clientY},a.addEventListener("touchmove",h);o.start&&o.start(r)},h=function(e){var n=e;if(t)var i={x:n.clientX,y:n.clientY};else var i={x:n.touches[0].clientX,y:n.touches[0].clientY};var a={x:i.x-r.x,y:i.y-r.y};s?(o.move&&o.move(r,i,a),r=i,u(a)):s=d(a),e.preventDefault(),e.stopPropagation()},f=function(){s&&o.end&&o.end(r),s=!1,document.removeEventListener("mousemove",h),a.removeEventListener("touchmove",h)};t?(a.style.cursor=o.cursor,a.style.userSelect="none",a.addEventListener("mousedown",p),document.addEventListener("mouseup",f)):(a.addEventListener("touchend",f),a.addEventListener("touchstart",p))};e.drag=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(t){var n={element:null,axis:"all",minWidth:100,minHeight:100,distance:0,start:null,sizable:null,stop:null},o=Object.assign(n,t),i=o.element;if(!i)return!1;var a,r,s=void 0,l=!1,d=e.create("div","bf-resize"),c=function(e){return Math.pow(e.x,2)+Math.pow(e.y,2)>Math.pow(o.distance,2)&&(o.start&&o.start(s),!0)},u=function(e){var t=navigator.userAgent;return t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!isOpera?1==e:0==e},p=function(e){var t=i.offsetLeft,n=i.offsetTop,s=a+e.x<o.minWidth?o.minWidth:a+e.x,l=r+e.y<o.minHeight?o.minHeight:r+e.y;switch(o.resize&&o.resize(s,l),i.style.left=t+"px",i.style.top=n+"px",o.axis){case"x":i.style.width=s+"px";break;case"y":i.style.height=l+"px";break;case"all":default:i.style.width=s+"px",i.style.height=l+"px"}},h=function(e){a=i.clientWidth,r=i.clientHeight;var t=e;u(t.button)&&(s={x:t.clientX,y:t.clientY},document.addEventListener("mousemove",f),document.addEventListener("touchmove",f))},f=function(e){var t=e,n={x:t.clientX,y:t.clientY},i={x:n.x-s.x,y:n.y-s.y};l?(o.sizable&&o.sizable(s,n,i),p(i)):l=c(i)},m=function(){l&&o.end&&o.end(s),l=!1,document.removeEventListener("mousemove",f),document.removeEventListener("touchmove",f)};i.addClass("bf-sizable"),i.appendChild(d),d.addEventListener("mousedown",h),d.addEventListener("touchstart",h),document.addEventListener("mouseup",m),document.addEventListener("touchend",m)};e.sizable=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(t){var n=this,o={element:null,min:0,max:100,cur:50,step:1,isShowProgress:!0,input:null,change:null,currentColor:"#11dab7",defaultColor:"#999"},i=Object.assign(o,t);this._opt=i;var a=e.create("div","bf-range"),r=e.create("input","bf-input-range");n.input=r,r.setAttribute("type","range"),r.setAttribute("step",i.step),r.setAttribute("min",i.min),r.setAttribute("max",i.max),r.setAttribute("value",i.cur);var s=e.create("span","bf-range-min");s.innerText=i.min;var l=e.create("span","bf-range-cur");n.cur=l,l.innerText=i.cur;var d=e.create("span","bf-range-max");d.innerText=i.max;var c=e.create("span","bf-range-progress");a.appendChild(r),i.isShowProgress&&(a.appendChild(s),a.appendChild(l),a.appendChild(d)),a.appendChild(c),i.element.appendChild(a),n.setProgress(i.cur),r.addEventListener("input",function(){n.setProgress(this.value),i.input&&i.input(this.value)}),r.addEventListener("change",function(){n.setProgress(this.value),i.change&&i.change(this.value)})};t.prototype.setProgress=function(e){var t=this._opt,n=t.max-t.min,o=this.input,i=this.cur,a=(e-t.min)/n*100;o.value=e,o.style.background="linear-gradient(to right,"+t.currentColor+" 0%,"+t.currentColor+"  "+a+"%,"+t.defaultColor+" "+a+"%, "+t.defaultColor+" 100%)",i.innerText=e},t.prototype.reset=function(){this.setProgress(this._opt.cur)},e.range=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=function(e){var t={element:null,min:0,max:100,from:null,to:null,step:1,currentColor:"#11dab7",defaultColor:"#999",change:null};this._opt=Object.assign(t,e),this._opt.from=this._opt.from||this._opt.min,this._opt.to=this._opt.to||this._opt.max,this.init()};t.prototype={init:function(){var t=e.create("div","bf-multiple-range"),n=e.create("div","bf-range-track"),o=e.create("span","bf-slider bf-slider-min");o.id="minSlider",o.type="minimum";var i=e.create("span","bf-slider bf-slider-max");i.id="maxSlider",i.type="maximum",this._state={from:this._opt.from,to:this._opt.to},n.style.backgroundColor=this._opt.currentColor,t.style.backgroundColor=this._opt.defaultColor,t.appendChild(n),t.appendChild(o),t.appendChild(i),this._opt.element.appendChild(t),this._track=n,this._sliders={min:o,max:i},this._element=t,this.bindEvent(),this.update(!1)},bindEvent:function(){var e,t,n=this,o=!1,i=function(n){var n=n||event;t=n.screenX,e=this,o=!0},a=function(i){if(o){var i=i||event,a=i.screenX-t,r=Math.round(a/n._pix/n._opt.step)*n._opt.step;0!=r&&(t=r*n._pix+t,"minimum"==e.type?n._state.from+=r:n._state.to+=r,n.recalculate(e),n.update(!0))}},r=function(){e=null,o=!1};this._sliders.min.addEventListener("mousedown",i),this._sliders.max.addEventListener("mousedown",i),document.addEventListener("mousemove",a),document.addEventListener("mouseup",r)},update:function(e){var t=this._sliders.min.offsetWidth,n=this._sliders.max.offsetWidth;if(!this._pix){var o=this._element.offsetWidth,i=this._opt.max-this._opt.min,a=(o-t-n)/i;this._pix=a}var r=(this._state.from-this._opt.min)*this._pix,s=(this._state.to-this._opt.min)*this._pix+t+n;this._track.style.left=r+t/2+"px",this._track.style.width=s-r-t/2-n/2+"px",this._sliders.min.style.left=r+"px",this._sliders.max.style.left=s+"px",this._opt.change&&e&&this._opt.change(this._state)},recalculate:function(e){this._state.to>=this._opt.max&&(this._state.to=this._opt.max),this._state.from<=this._opt.min&&(this._state.from=this._opt.min),e&&("maximum"==e.type&&this._state.to<=this._state.from&&(this._state.to=this._state.from),"minimum"==e.type&&this._state.from>=this._state.to&&(this._state.from=this._state.to))},getProgress:function(){return this._state},setProgress:function(e){this._state=e,this.recalculate(),this.update(!1)}},e.multipleRange=t}(),function(){var e=function(e){var t,n;this.addEventListener("touchstart",function(e){t=Date.now()}),this.addEventListener("touchend",function(o){(n=Date.now())-t<200&&e(o)})};HTMLElement.prototype.tap=e}(),function(){(window.ActiveXObject||"ActiveXObject"in window)&&(HTMLElement.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)},window.Element&&function(e){e.matches=e.matches||e.matchesSelector||e.webkitMatchesSelector||e.msMatchesSelector||function(e){for(var t=this,n=(t.parentNode||t.document).querySelectorAll(e),o=-1;n[++o]&&n[o]!=t;);return!!n[o]}}(Element.prototype),window.Element&&function(e){e.closest=e.closest||function(e){for(var t=this;t.matches&&!t.matches(e);)t=t.parentNode;return t.matches?t:null}}(Element.prototype))}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.UUID"),t=function(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")};e.createUUID=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),t=function(e,t){var n=null,o=Date.now();return void 0==t&&(t=30),function(){var i=Date.now(),a=t-(i-o),r=this,s=arguments;clearTimeout(n),a<=0?(e.apply(r,s),o=Date.now()):n=setTimeout(e,a)}};e.throttle=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang"),t=function(){this.container={}};t.prototype.addEvent=function(e,t){return"string"==typeof e&&"function"==typeof t&&(void 0===this.container[e]?this.container[e]=[t]:this.container[e].push(t)),this},t.prototype.fireEvent=function(e){if(e&&this.container[e]){var t=Array.prototype.slice.call(arguments);t.shift();for(var n=this.container[e].length,o=0;o<n;o++){this.container[e][o].apply(null,t)}}return this},t.prototype.removeEvent=function(e,t){if("function"==typeof t&&"string"==typeof e){var n=this.container[e];if(n instanceof Array){for(var o=0,i=n.length;o<i;o+=1)if(n[o]===t){n.splice(o,1);break}0==n.length&&delete this.container[e]}return this}},e.EventManager=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Geometry"),t=function(e,t,n){this.x=e,this.y=t,this.z=n};t.prototype={get:function(){return{x:this.x,y:this.y,z:this.z}},set:function(e,t,n){this.x=e,this.y=t,this.z=n}},e.Point3d=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Geometry"),t=function(t,n){var o={},i=new e.Point3d,a=new e.Point3d;return i.set(t.x,t.y,t.z),a.set(n.x,n.y,n.z),o.min=i,o.max=a,o};e.BoundingBox=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Graphics.Utility"),t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t};e.RGBToHex=t}(),!hostConfig)var hostConfig={APIHost:"https://api.bimface.com",resourceHost:"https://m.bimface.com",staticHost:"https://static.bimface.com",dataEnvType:"BIMFACE"};!function(){function e(e,t){function n(e){return"FloorPlan"==e||"CeilingPlan"==e}if("DrawingSheet"!=t.viewType)return null;var o=t.viewInfo,i=o.preview.width,a=o.preview.height,r=o.outline[0],s=o.outline[2],l=o.outline[1],d=o.outline[3],c=s-r,u=d-l;o=t;for(var p=o.portsAndViews,h=0;h<p.length;h++){var f=p[h];if(n(f.viewType)){var m=function(t,n,o,s,d){var p=e.x/i,h=(a-e.y)/a;if("Elevation"==d.viewType){h=(i-e.x)/i,p=e.y/a;var f=d.viewPoint.viewDirection;1!=Math.round(f[0])&&-1!=Math.round(f[1])||(p=(a-e.y)/a)}var m=(t-r)/c,g=(n-r)/c;if(p<m||p>g)return null;var v=(o-l)/u,b=(s-l)/u;if(h<v||h>b)return null;var y=(p-m)/(g-m),w=(h-v)/(b-v),C=((d.outline[2]-d.outline[0])*y+d.outline[0])*d.viewPoint.scale,M=((d.outline[3]-d.outline[1])*w+d.outline[1])*d.viewPoint.scale;return new THREE.Vector3(C,M,0)}(f.viewport[0],f.viewport[3],f.viewport[1],f.viewport[4],f);if(null!=m){if(n(f.viewType))null!==m&&(m.z=f.elevation);else if("Elevation"==f.viewType){var g=f.viewPoint.viewDirection,v=f.cropBox;0!=Math.round(g[0])?null!==m&&(m.z=m.y,m.y=m.x,m.x=g[0]<0?v[3]:v[0]):0!=Math.round(g[1])&&null!==m&&(m.z=m.y,m.y=g[1]<0?v[4]:v[1])}return m}}}return null}function t(e,t,n){if("DrawingSheet"!=t.viewType)return!1;var o=t.preview.width,i=t.preview.height,a=t.outline[0],r=t.outline[2],s=t.outline[1],l=t.outline[3],d=t.portsAndViews;for(var c in d){var u=d[c];if("FloorPlan"===u.viewType){var p=u.viewPoint.scale,h=u.outline[0]*p,f=u.outline[2]*p,m=u.outline[1]*p,g=u.outline[3]*p;if(!(e.x<h||e.x>f||e.y<m||e.y>g)){var v=(e.x-h)/(f-h),b=(e.y-m)/(g-m),y=u.viewport[3]-u.viewport[0],w=u.viewport[4]-u.viewport[1];n(o*((u.viewport[0]+y*v-a)/(r-a)),i-i*((u.viewport[1]+w*b-s)/(l-s)),u)}}}return!0}var n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Graphics.Utility.Relation"),o=function(e,t,n){Glodon.Web.Lang.Utility.HttpRequest.ajax({url:hostConfig.resourceHost+"/"+e+"/metadata/views.json",success:function(o){var i=JSON.parse(o).viewList,o=[];for(var a in i){var r=i[a];r.viewType==t&&(r.preview.path=hostConfig.resourceHost+"/"+e+"/"+r.preview.path,o.push(r))}n&&n(o)}})},i=function(e,t,n){Glodon.Web.Lang.Utility.HttpRequest.ajax({url:hostConfig.resourceHost+"/"+e+"/metadata/drawings.json",success:function(e){for(var o=JSON.parse(e).drawingList,i=0;i<o.length;i++){var a=o[i];if(a.viewInfo.id==t){n&&n(a);break}}}})},a=function(t,n){if("DrawingSheet"==n.viewType)return e(t,n);if("FloorPlan"!=n.viewType)return console.warn("Not support yet!"),null;var o=n.preview.width,i=n.preview.height,a=n.outline[0],r=n.outline[2],s=n.outline[1],l=n.outline[3],d=r-a,c=l-s,u=(0-a)/d,p=l/c,h=(t.x-o*u)/o,f=(i*p-t.y)/i;return h=h*d*n.viewPoint.scale,f=f*c*n.viewPoint.scale,new Glodon.Web.Geometry.Point3d(h,f,n.elevation)},r=function(e,n){var o=[];if(t(e,n,function(e,t,n){o.append({x:e,y:t})}))return 0==o.length?null:o;if("FloorPlan"!=n.viewType)return console.warn("Not support yet!"),null;var i=n.preview.width,a=n.preview.height,r=n.outline[0],s=n.outline[2],l=n.outline[1],d=n.outline[3],c=s-r,u=d-l,p=(0-r)/(s-r),h=d/(d-l),f=e.x/(c*n.viewPoint.scale),m=e.y/(u*n.viewPoint.scale);return f=f*i+i*p,m=a*h-m*a,{x:f,y:m,z:0}};n.getViews=o,n.getDrawingSheets=i,n.point2DToPoint3D=a,n.point3DToPoint2D=r}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Graphics.Utility"),t=function(e){var t=new Image;return new Promise(function(n,o){t.onload=function(){n(t)},t.onerror=function(e){o(e)},t.crossOrigin="anonymous",t.src=e,!0===t.complete&&n(t)})};e.ImageContainer=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Graphics"),t=Glodon.Web.Graphics.Utility.RGBToHex,n=function(e,t,n,o){this.red=e,this.green=t,this.blue=n,this.alpha=o},o=function(e,t){/^#[0-9a-fA-F]{6}$/.test(e)&&(this.red=parseInt(e.slice(1,3),16),this.green=parseInt(e.slice(3,5),16),this.blue=parseInt(e.slice(5),16)),"number"==typeof t?(t>1&&(t=1),t<0&&(t=0),this.alpha=t):this.alpha=1},i=function(){arguments.length<4?o.apply(this,arguments):n.apply(this,arguments)};i.prototype={getRGB:function(){return"rgba("+this.red+","+this.green+","+this.blue+")"},getRGBA:function(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"},
getHEX:function(){return""+t(this.red)+t(this.green)+t(this.blue)},getAlpha:function(){return this.alpha},fromObject:function(e){return this.red=e.red,this.green=e.green,this.blue=e.blue,this.alpha=e.alpha,this}},e.Color=i}(),function(){SVGElement.prototype.getClass=HTMLElement.prototype.getClass=function(e){return this.getAttribute("class")},SVGElement.prototype.hasClass=HTMLElement.prototype.hasClass=function(e){var t=this.getClass();return!!t&&(t&&t.split(" ")).indexOf(e)>-1},SVGElement.prototype.addClass=HTMLElement.prototype.addClass=function(e){var t=this.getClass(),n=t&&t.split(" ");return t?-1==n.indexOf(e)&&(n.push(e),t=n.join(" "),this.setAttribute("class",""+t)):this.setAttribute("class",""+e),this},SVGElement.prototype.removeClass=HTMLElement.prototype.removeClass=function(e){if(!this.hasClass(e))return this;var t=this.getClass().replace(e,"").trim();return t?this.setAttribute("class",""+t):this.removeAttribute("class"),this},SVGElement.prototype.toggleClass=HTMLElement.prototype.toggleClass=function(e,t){var n=(this.getClass(),this.hasClass(e));return void 0!=t?(t&&!n&&this.addClass(e),t||this.removeClass(e)):n?this.removeClass(e):this.addClass(e),!n}}(),function(){Array.prototype.getObjectByAttribute=function(e,t){for(var n=this,o=n.length,i=0;i<o;i++)if(n[i][e]==t)return n[i];return!1},Array.prototype.removeObjectByAttribute=function(e,t){for(var n=this,o=n.length,i=0;i<o;i++)if(n[i][e]==t)return n=n.splice(i,1);return!1},Array.prototype.getAllObjectByAttribute=function(e,t){for(var n=this,o=n.length,i=0,a=[];i<o;i++)n[i][e]==t&&a.push(n[i]);return a},Array.prototype.removeByValue=function(e){for(var t=this,n=t.length,o=n-1;o>=0;o--)t[o]==e&&t.splice(o,1);return t},Array.prototype.insert=function(e,t){return this.splice(e,0,t),this}}(),function(){SVGElement.prototype.setCss=HTMLElement.prototype.setCss=function(e){if(e)for(var t in e)this.style[t]=e[t]},SVGElement.prototype.getCss=HTMLElement.prototype.getCss=function(){return this.style}}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Data"),t=(Glodon.Web.Lang.Utility.HttpRequest,null),n={getInstance:function(){return null==t&&(t={},t.sendingPeriod=6e4,t.requestList=[],t.isEnabled=!0,t.modelType="",t.modelId="",t.handleId=null,t.send=function(e,n,o){if(t.isEnabled){var i={functionName:e+"."+n},a=Object.assign(i,o);this.requestList.push(a)}},t.intervalAction=function(){if(t.isEnabled){var e=t.requestList,n=e.length;if(n>0){var o=e.slice(0,n);t._send(o),e.splice(0,n)}}},t.handleId=setInterval(t.intervalAction,t.sendingPeriod),t._send=function(e){var t="https://api.bimface.com/inside/track?ModelType="+this.modelType+"&ModelId="+this.modelId,n={Events:e},o={"Content-Type":"application/json"};fetch(t,{method:"PUT",mode:"cors",body:JSON.stringify(n),headers:o,cache:"default"}).then(function(e){})},t.setIsEnabled=function(e){t.isEnabled=!0===e,t.isEnabled&&null===t.handleId?t.handleId=setInterval(t.intervalAction,t.sendingPeriod):t.isEnabled||null===t.handleId||(clearInterval(t.handleId),t.handleId=null)},t.getIsEnabled=function(){return t.isEnabled}),t}};e.StatisticsDataManager=n}(),function(e){function t(){s||(s=!0,a())}
var n,o,i,a,r,s,l,d='<svg><symbol id="gld-bf-scene-front" viewBox="0 0 1024 1024"><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path><path d="M256 416h352v352H256z" fill="#FFFFFF" fill-opacity=".65" ></path></symbol><symbol id="gld-bf-scene-back" viewBox="0 0 1024 1024"><path d="M416 256h352v352H416z" fill="#FFFFFF" fill-opacity=".65" ></path><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path></symbol><symbol id="gld-bf-scene-left" viewBox="0 0 1024 1024"><path d="M224 384l160-160v384l-160 160z" fill="#FFFFFF" fill-opacity=".65" ></path><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path></symbol><symbol id="gld-bf-scene-right" viewBox="0 0 1024 1024"><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path><path d="M640 416l128-128v339.2l-128 128z" fill="#FFFFFF" fill-opacity=".6" ></path></symbol><symbol id="gld-bf-scene-top" viewBox="0 0 1024 1024"><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path><path d="M268.8 384l128-128h358.4l-128 128z" fill="#FFFFFF" fill-opacity=".65" ></path></symbol><symbol id="gld-bf-scene-bottom" viewBox="0 0 1024 1024"><path d="M640 768l160-160H416l-160 160z" fill="#FFFFFF" fill-opacity=".65" ></path><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#FFFFFF" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#FFFFFF" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#FFFFFF" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#FFFFFF" ></path></symbol><symbol id="gld-bf-scene" viewBox="0 0 1024 1024"><path d="M608 416v352H256V416h352m32-32H224v416h416V384z" fill="#333333" ></path><path d="M768 256v352H416V256h352m32-32H384v416h416V224z" fill="#333333" ></path><path d="M768 256v371.2L627.2 768H256V396.8L396.8 256H768m32-32H384l-160 160v416h416l160-160V224z" fill="#333333" ></path><path d="M755.2 256l-128 128H268.8l128-128h358.4M800 224H384l-160 160v32h416l160-160V224zM755.2 640l-128 128H268.8l128-128h358.4m44.8-32H384l-160 160v32h416l160-160v-32z" fill="#333333" ></path></symbol><symbol id="gld-bf-arrow-right" viewBox="0 0 1024 1024"><path d="M538.624 466.176L150.698667 853.248l60.245333 60.416 449.024-448L210.432 25.002667l-59.733333 60.928z"  ></path><path d="M879.957333 466.176L492.032 853.248l60.245333 60.416 449.024-448L551.765333 25.002667l-59.733333 60.928z"  ></path></symbol><symbol id="gld-bf-BIMFACE-logo" viewBox="0 0 6963 1024"><path d="M13.23008 23.3472l172.2368 172.2368V23.3472zM0 208.81408h172.19584L0 36.61824zM202.01472 23.3472v172.2368L374.21056 23.3472zM387.4816 208.81408V36.61824L215.2448 208.81408zM417.30048 23.3472l172.19584 172.2368V23.3472zM404.02944 36.61824v172.19584h172.2368zM606.04416 23.3472v172.2368L778.28096 23.3472zM791.51104 208.81408V36.61824L619.3152 208.81408zM821.32992 23.3472l172.19584 172.2368V23.3472zM808.05888 36.61824v172.19584h172.2368zM1010.0736 36.61824v172.19584h172.2368zM1023.34464 225.40288l172.19584 172.19584V225.40288zM1010.0736 238.63296v172.19584h172.2368zM1109.44256 513.51552l86.09792-86.09792h-172.19584zM1010.0736 440.64768v172.19584h172.2368zM1010.0736 629.43232v172.19584l172.2368-172.19584zM1195.54048 814.85824V642.6624l-172.19584 172.19584zM1010.0736 831.44704v172.19584l172.2368-172.19584zM808.05888 831.44704v172.19584l172.2368-172.19584zM821.32992 1016.91392h172.19584v-172.2368zM619.3152 831.44704l172.19584 172.19584V831.488zM606.04416 1016.91392h172.2368l-172.2368-172.2368zM404.02944 831.44704v172.19584L576.3072 831.488zM417.30048 1016.91392h172.19584v-172.2368zM808.05888 427.4176v172.19584l172.2368-172.19584zM993.52576 612.84352v-172.19584l-172.19584 172.19584zM791.51104 599.6544v-172.2368H619.3152zM606.04416 440.64768v172.19584h172.2368zM404.02944 427.4176v172.19584l172.2368-172.19584zM589.49632 612.84352v-172.19584l-172.19584 172.19584zM0 225.36192v172.2368l172.19584-172.2368zM13.23008 410.8288h172.2368V238.63296zM13.23008 427.37664l172.2368 172.2368v-172.2368zM0 612.84352h172.19584L0 440.64768zM0 629.43232v172.19584l172.19584-172.19584zM13.23008 814.85824h172.2368V642.6624zM13.23008 831.44704l172.2368 172.19584V831.488zM0 1016.91392h172.19584L0 844.67712zM1314.77504 23.3472l172.19584 172.2368V23.3472zM1301.54496 208.81408h172.19584L1301.54496 36.61824zM1473.7408 225.40288l-172.19584 172.19584V225.40288zM1486.97088 410.8288H1314.816l172.19584-172.19584zM1314.77504 427.4176l172.19584 172.19584v-172.19584zM1301.54496 612.84352h172.19584l-172.19584-172.19584zM1473.7408 629.43232l-172.19584 172.19584v-172.19584zM1486.97088 814.8992H1314.816l172.19584-172.2368zM1314.77504 831.44704l172.19584 172.19584V831.488zM1301.54496 1016.91392h172.19584l-172.19584-172.2368zM1606.20544 23.3472l172.2368 172.2368 110.592-172.19584zM2099.32288 523.4688l175.39072 175.39072 112.72192-175.43168zM2389.4016 559.88224l-102.52288 159.58016h215.08096l-102.52288-159.58016-4.99712-7.7824M1592.9344 36.61824v172.19584h172.2368zM1592.9344 225.40288v172.19584l172.2368-172.19584zM2083.10272 506.88V225.40288h-281.47712zM1794.99008 208.81408h288.11264L1909.18656 38.2976zM2099.69152 225.40288v282.17344h282.13248zM1778.44224 410.8288V238.63296l-172.2368 172.19584zM1778.44224 599.6544v-172.2368h-172.2368zM1592.9344 440.64768v172.19584h172.2368zM1592.9344 629.43232v172.19584l172.2368-172.19584zM1778.44224 814.85824V642.6624l-172.2368 172.19584zM1606.20544 831.44704l172.2368 172.19584V831.488zM1592.9344 1016.91392h172.2368l-172.19584-172.2368zM2899.7632 23.3472l110.63296 172.2368L3182.592 23.3472zM2514.1248 698.85952l175.39072-175.39072h-288.11264zM3023.6672 208.81408h172.19584V36.61824zM3195.86304 397.59872V225.40288H3023.6672zM2705.73568 506.88l281.47712-281.47712h-281.47712zM2705.73568 208.81408h288.11264L2879.65184 38.2976zM2689.14688 225.40288l-282.13248 282.17344h282.13248zM3010.39616 238.63296v172.19584H3182.592zM3010.39616 599.6544l172.19584-172.2368h-172.19584zM3195.86304 612.84352v-172.19584l-172.19584 172.19584zM3195.86304 801.62816v-172.19584H3023.6672zM3182.592 814.85824l-172.19584-172.19584v172.19584zM3010.39616 831.44704v172.19584L3182.592 831.488zM3023.6672 1016.91392h172.19584v-172.2368zM4172.84096 530.06336c0 27.4432-22.24128 49.68448-49.68448 49.68448M4123.15648 480.37888c27.4432 0 49.68448 22.24128 49.68448 49.68448M6010.88 917.54496H5504.2048a139.10016 139.10016 0 0 1-139.10016-139.10016V261.81632a139.10016 139.10016 0 0 1 139.10016-139.10016v0.08192l457.03168-0.08192h49.68448a49.68448 49.68448 0 0 0 0-99.36896H5504.2048a238.46912 238.46912 0 0 0-238.46912 238.46912v516.62848a238.46912 238.46912 0 0 0 238.46912 238.46912H6010.88a49.68448 49.68448 0 0 0 0-99.36896"  ></path><path d="M4123.15648 480.37888H3477.34016V222.08512a99.36896 99.36896 0 0 1 99.36896-99.36896h546.65216a49.64352 49.64352 0 0 0-0.2048-99.36896H3576.70912a198.73792 198.73792 0 0 0-198.69696 198.73792V1014.5792h99.328V579.74784h645.81632a49.68448 49.68448 0 1 0 0-99.36896M5121.88416 946.05312L4704.78848 60.29312l-0.4096-0.94208v-0.04096a59.5968 59.5968 0 0 0-109.3632 0v0.04096l-0.28672 0.69632-417.13664 886.00576a49.68448 49.68448 0 0 0 89.9072 42.31168l382.23872-812.35968 382.23872 812.35968a49.68448 49.68448 0 0 0 89.9072-42.31168M6855.39328 579.74784h49.68448a49.68448 49.68448 0 0 0 0-99.36896h-645.81632V222.08512a99.36896 99.36896 0 0 1 99.36896-99.36896v-0.12288l99.328 0.12288h447.11936a49.68448 49.68448 0 0 0 0-99.36896H6358.6304a198.69696 198.69696 0 0 0-198.69696 198.73792v596.09088a198.69696 198.69696 0 0 0 198.656 198.73792H6905.11872a49.68448 49.68448 0 0 0 0-99.36896H6358.6304a99.36896 99.36896 0 0 1-99.36896-99.36896v-238.42816h596.13184z"  ></path><path d="M4550.49216 817.72544l99.24608-237.9776 99.20512 237.9776z"  ></path></symbol><symbol id="gld-bf-warning-1" viewBox="0 0 1024 1024"><path d="M469.333333 682.666667h85.333334v85.333333h-85.333334v-85.333333z m0-384h85.333334v341.333333h-85.333334V298.666667z m42.666667 640c235.648 0 426.666667-191.018667 426.666667-426.666667S747.648 85.333333 512 85.333333 85.333333 276.352 85.333333 512s191.018667 426.666667 426.666667 426.666667z m0 85.333333C229.248 1024 0 794.752 0 512S229.248 0 512 0s512 229.248 512 512-229.248 512-512 512z"  ></path></symbol><symbol id="gld-bf-room-addnode" viewBox="0 0 1024 1024"><path d="M224 352v257.6a80 80 0 0 1 64 77.536V672h256.704A176.064 176.064 0 0 1 704 512.704L704 352h32v160.704a176 176 0 1 1-191.296 191.328L288 704l-0.032-15.136-0.128 4.384A80 80 0 1 1 192 609.6V352h32z m496 192a144 144 0 1 0 0 288 144 144 0 0 0 0-288z m16 64l-0.032 64H800v32h-64.032L736 768h-32l-0.032-64H640v-32h63.968L704 608h32zM208 640a48 48 0 1 0 0 96 48 48 0 0 0 0-96z m0-448A80 80 0 0 1 288 271.136V256h352v32H288l-0.032-15.136-0.128 4.384A80 80 0 1 1 208 192z m512 0a80 80 0 1 1 0 160 80 80 0 0 1 0-160z m-512 32a48 48 0 1 0 0 96 48 48 0 0 0 0-96z m512 0a48 48 0 1 0 0 96 48 48 0 0 0 0-96z"  ></path></symbol><symbol id="gld-bf-room-deletenode" viewBox="0 0 1024 1024"><path d="M224 352v257.6a80 80 0 0 1 64 77.536V672h256.704A176.064 176.064 0 0 1 704 512.704L704 352h32v160.704a176 176 0 1 1-191.296 191.328L288 704l-0.032-15.136-0.128 4.384A80 80 0 1 1 192 609.6V352h32z m496 192a144 144 0 1 0 0 288 144 144 0 0 0 0-288z m-512 96a48 48 0 1 0 0 96 48 48 0 0 0 0-96zM800 672v32h-160v-32h160zM208 192A80 80 0 0 1 288 271.136V256h352v32H288l-0.032-15.136-0.128 4.384A80 80 0 1 1 208 192z m512 0a80 80 0 1 1 0 160 80 80 0 0 1 0-160z m-512 32a48 48 0 1 0 0 96 48 48 0 0 0 0-96z m512 0a48 48 0 1 0 0 96 48 48 0 0 0 0-96z"  ></path></symbol><symbol id="gld-bf-room-dragnode" viewBox="0 0 1024 1024"><path d="M512 640v128h96l-112 128-112-128h96v-128h32z m256-256l128 112-128 112v-96.032L640 512v-32l128-0.032V384zM224 384v96h128v32H224v96l-128-112L224 384z m272 32a80 80 0 1 1 0 160 80 80 0 0 1 0-160z m0 32a48 48 0 1 0 0 96 48 48 0 0 0 0-96z m0-352L608 224h-96v128h-32V224h-96l112-128z"  ></path></symbol><symbol id="gld-bf-success--fill" viewBox="0 0 1024 1024"><path d="M512 1024A512 512 0 1 1 512 0a512 512 0 0 1 0 1024zM288 448L192 544 416 768 832 352 736 256l-320 320-128-128z"  ></path></symbol><symbol id="gld-bf-information--fill" viewBox="0 0 1024 1024"><path d="M512 1024A512 512 0 1 1 512 0a512 512 0 0 1 0 1024z m64-320V384H384v64h64v256H384v64h256v-64H576zM448 192v128h128V192H448z"  ></path></symbol><symbol id="gld-bf-warning--fill" viewBox="0 0 1024 1024"><path d="M512 1024A512 512 0 1 1 512 0a512 512 0 0 1 0 1024zM448 192v384h128V192H448z m0 448v128h128v-128H448z"  ></path></symbol><symbol id="gld-bf-fitpanel" viewBox="0 0 1024 1024"><path d="M768 256v448h-96v-32h64V288H352v64h-32V256h448z"  ></path><path d="M608 416v320H288V416h320z m-35.552 35.552H323.52v248.896h248.896V451.52z"  ></path></symbol><symbol id="gld-bf-explode" viewBox="0 0 1024 1024"><path d="M832 288l-320 160L192 288l320-160 320 160zM512 163.776L263.552 288 512 412.224 760.448 288 512 163.776zM128 384l320 160v352L128 736V384z m32 51.776v280.448l256 128v-280.448l-256-128zM896 736l-320 160V544l320-160z"  ></path></symbol><symbol id="gld-bf-n-ployline" viewBox="0 0 1024 1024"><path d="M128 591.104l683.136 239.104 10.592-30.208-596.864-208.896 640.128-224.032L453.696 224l-10.528 30.208 324.704 112.96z"  ></path></symbol><symbol id="gld-bf-elevation" viewBox="0 0 1024 1024"><path d="M224 352h640v32h-284L384 608l-224-256h64z m313.472 32H230.528L384 559.392 537.472 384zM640 672v32H160v-32z" fill="#333333" ></path></symbol><symbol id="gld-bf-rotate-horizontal" viewBox="0 0 1024 1024"><path d="M224 512v32h320v-32zM704 512v32h96v-32z"  ></path><path d="M512 728.48v34.4c73.024-23.712 128-127.04 128-250.88 0-141.376-71.648-256-160-256-74.56 0-137.184 81.6-154.944 192h32.416c16.448-93.664 67.648-160 122.528-160 66.72 0 128 98.048 128 224 0 105.376-42.88 191.232-96 216.48z"  ></path><path d="M512 640l-16 122.88 128-10.88z"  ></path></symbol><symbol id="gld-bf-rotate-vertical" viewBox="0 0 1024 1024"><path d="M512 224h32v320h-32zM512 704h32v96h-32z"  ></path><path d="M728.48 512h34.4c-23.712 73.024-127.04 128-250.88 128-141.376 0-256-71.648-256-160 0-74.56 81.6-137.184 192-154.944v32.416c-93.664 16.448-160 67.648-160 122.528 0 66.72 98.048 128 224 128 105.376 0 191.232-42.88 216.48-96z"  ></path><path d="M640 512l122.88-16-10.88 128z"  ></path></symbol><symbol id="gld-bf-hide-slice" viewBox="0 0 1024 1024"><path d="M586.72 518.848l-25.664-25.664A241.408 241.408 0 0 1 640 480c94.272 0 179.584 53.344 256 160-28.8 40.224-58.88 72.832-90.24 97.92l-22.72-22.784c24.96-19.52 49.312-44.512 73.056-75.136-66.912-86.304-138.688-128-216.096-128-18.048 0-35.84 2.24-53.28 6.848z m-89.728 46.016c-24.992 19.52-49.344 44.512-73.088 75.136 66.912 86.304 138.688 128 216.096 128 18.048 0 35.84-2.24 53.28-6.848l25.664 25.664c-25.6 8.8-51.904 13.184-78.944 13.184-94.272 0-179.584-53.344-256-160 28.8-40.224 58.88-72.832 90.24-97.92l22.72 22.784h0.032z" fill="#333333" ></path><path d="M703.872 636a64 64 0 0 0-59.84-59.872l-28.896-28.864a96.128 96.128 0 0 1 117.6 117.6l-28.864-28.864z m-127.744 8a64 64 0 0 0 59.84 59.872l28.896 28.864a96.128 96.128 0 0 1-117.6-117.6l28.864 28.864zM480 457.376L819.424 796.8l-22.656 22.624L457.376 480z" fill="#333333" ></path><path d="M384 736v32H128V192h640v256h-32V224H160v512z" fill="#333333" ></path></symbol><symbol id="gld-bf-distance-min" viewBox="0 0 1024 1024"><path d="M224 704v64h608v-64H224z m-32-32h672v128H192v-128z m64-192h512v32H256v-32z m64-224h128v32h-32v96h-32V288h-32v96h-32V256z m128 128V288h32v96h-32z m96-160v32h-32V224h32z m0 64v96h-32V288h32z m128 96V288h32v96h-32z m-64-96v96h-32V256h96v32h-64z" fill="#333333" ></path><path d="M192 375.584l29.44-12.608L278.464 496l-56.96 133.024-29.44-12.608L243.616 496 192 375.584z m646.432 0l-29.44-12.608-56.96 133.024 56.96 133.024 29.44-12.608-51.616-120.416 51.648-120.416h-0.032z" fill="#333333" ></path></symbol><symbol id="gld-bf-area" viewBox="0 0 1024 1024"><path d="M581.888 288H160.768v480H872L581.888 288z m263.68 480l9.024 15.68-9.76 16.32h-18.432l-18.432-32h37.6zM128 256h473.056L928 800H128V256z" fill="#333333" ></path><path d="M336 345.376l22.624 22.624L240 486.624l-22.624-22.624zM528 345.376l22.624 22.624L240 678.624l-22.624-22.624zM592 473.376l22.624 22.624-214.624 214.624-22.624-22.624zM656 601.376l22.624 22.624-86.624 86.624-22.624-22.624z" fill="#333333" ></path></symbol><symbol id="gld-bf-fittobox" viewBox="0 0 1024 1024"><path d="M496 224L256 352v256l240 128 240-128v-256l-240-128z m198.4 137.6l-198.4 102.4-195.2-102.4 195.2-102.4 198.4 102.4zM288 582.4v-192l192 99.2v201.6l-192-99.2v-9.6z m416 9.6l-192 99.2v-201.6l192-99.2v201.6z" fill="#515151" ></path><path d="M352 128H128v224h32V160h192zM352 864H128v-224h32v192h192zM640 128h224v224h-32V160h-192zM640 864h224v-224h-32v192h-192z" fill="#515151" ></path></symbol><symbol id="gld-bf-delete" viewBox="0 0 1024 1024"><path d="M640 192V128H384v64H128v64h768V192zM192 320v544c0 52.928 43.072 96 96 96h448c52.928 0 96-43.072 96-96V320H192z m64 512V384h128v448H256z m192 0V384h128v448H448z m320 0h-128V384h128v448z"  ></path></symbol><symbol id="gld-bf-bofang" viewBox="0 0 1024 1024"><path d="M272 256h96v512H272zM656 256h96v512h-96z"  ></path></symbol><symbol id="gld-bf-zanting" viewBox="0 0 1024 1024"><path d="M768 512l-384 288V224z"  ></path></symbol><symbol id="gld-bf-shangjiantou" viewBox="0 0 1024 1024"><path d="M831.232 383.616l-319.744 319.488-45.44-45.12L192 383.68l45.12-45.248 274.368 274.112 274.496-274.112z"  ></path></symbol><symbol id="gld-bf-xiajiantou" viewBox="0 0 1024 1024"><path d="M831.232 640.384L511.488 320.896l-45.44 45.12L192 640.32l45.12 45.248 274.368-274.112 274.496 274.112z"  ></path></symbol><symbol id="gld-bf-shijiaoqiehuan" viewBox="0 0 1024 1024"><path d="M776 380L512 248l-264 132v264L512 776l264-132v-264z m-286.016 335.712l-197.984-98.976v-190.08l198.016 98.976v190.08zM321.92 392.32L512 297.28l190.08 95.04L512 487.36l-190.08-95.04z m410.08 224.416l-198.016 98.976v-190.08l198.016-98.976v190.08zM204 204H336V160H160v176h44V204z m0 484H160V864h176v-44H204V688z m616 132H688V864H864v-176h-44v132z m0-660H688v44h132V336H864V160h-44z"  ></path></symbol><symbol id="gld-bf-route" viewBox="0 0 1024 1024"><path d="M825.926105 611.328A98.067692 98.067692 0 0 1 866.452874 592.738462V531.692308h39.384615v61.046154a98.461538 98.461538 0 1 1-105.629538 48.403692l-35.643077-30.72 25.718154-29.814154 35.643077 30.72zM216.60672 196.923077a98.461538 98.461538 0 1 1 0-196.923077 98.461538 98.461538 0 0 1 0 196.923077z m0 787.692308a137.846154 137.846154 0 1 0 0-275.692308 137.846154 137.846154 0 0 0 0 275.692308z m0 39.384615a177.230769 177.230769 0 1 1 0-354.461538 177.230769 177.230769 0 0 1 0 354.461538zM196.914412 216.615385h39.384616v118.153846H196.914412v-118.153846z m0 157.538461h39.384616v118.153846H196.914412v-118.153846z m0 157.538462h39.384616v118.153846H196.914412v-118.153846z m669.538462-315.076923h39.384615v118.153846h-39.384615v-118.153846z m0 157.538461h39.384615v118.153846h-39.384615v-118.153846zM287.302105 198.971077l25.718153-29.814154L402.502105 246.311385l-25.718154 29.814153-89.481846-77.154461z m119.335384 102.872615l25.678769-29.814154 89.521231 77.115077-25.718154 29.853539-89.52123-77.154462z m119.335385 102.872616l25.678769-29.853539 89.481846 77.193846-25.718154 29.814154-89.481846-77.193846z m119.296 102.872615l25.718154-29.853538 89.481846 77.154461-25.718154 29.814154-89.481846-77.115077zM216.60672 945.230769a98.461538 98.461538 0 1 1 0-196.923077 98.461538 98.461538 0 0 1 0 196.923077z m669.538462-748.307692a98.461538 98.461538 0 1 1 0-196.923077 98.461538 98.461538 0 0 1 0 196.923077z"  ></path></symbol><symbol id="gld-bf-n-cloud" viewBox="0 0 1024 1024"><path d="M694.4 192C752 192 800 240 800 297.6c0 48-32 86.4-73.6 99.2 41.6 12.8 73.6 51.2 73.6 99.2s-32 86.4-73.6 99.2c41.6 12.8 73.6 54.4 73.6 99.2 0 57.6-48 105.6-105.6 105.6-48 0-86.4-32-99.2-73.6C582.4 768 544 800 496 800s-86.4-32-99.2-73.6C384 768 342.4 800 297.6 800 240 800 192 752 192 694.4c0-48 32-86.4 73.6-99.2C224 582.4 192 544 192 496s32-86.4 73.6-99.2C224 384 192 342.4 192 297.6 192 240 240 192 297.6 192c48 0 86.4 32 99.2 73.6C409.6 224 448 192 496 192s86.4 32 99.2 73.6C608 224 649.6 192 694.4 192m0-32c-38.4 0-73.6 19.2-99.2 44.8-25.6-25.6-60.8-44.8-99.2-44.8s-73.6 19.2-99.2 44.8C371.2 179.2 336 160 297.6 160 220.8 160 160 220.8 160 297.6c0 38.4 19.2 73.6 44.8 99.2-25.6 25.6-44.8 60.8-44.8 99.2s19.2 73.6 44.8 99.2c-25.6 25.6-44.8 60.8-44.8 99.2C160 771.2 220.8 832 297.6 832c38.4 0 73.6-19.2 99.2-44.8 25.6 25.6 60.8 44.8 99.2 44.8s73.6-19.2 99.2-44.8c25.6 28.8 60.8 44.8 99.2 44.8 76.8 0 137.6-60.8 137.6-137.6 0-38.4-19.2-73.6-44.8-99.2 25.6-25.6 44.8-60.8 44.8-99.2s-19.2-73.6-44.8-99.2c28.8-25.6 44.8-60.8 44.8-99.2C832 220.8 771.2 160 694.4 160z"  ></path></symbol><symbol id="gld-bf-up" viewBox="0 0 1129 1024"><path d="M600.275862 564.965517v459.034483h-105.931034V564.965517H15.677793L564.965517 15.677793 1114.253241 564.965517H600.275862z"  ></path></symbol><symbol id="gld-bf-down" viewBox="0 0 1129 1024"><path d="M600.275862 459.034483V0h-105.931034v459.034483H15.677793L564.965517 1008.322207 1114.253241 459.034483H600.275862z"  ></path></symbol><symbol id="gld-bf-transparent" viewBox="0 0 1024 1024"><path d="M512 0L32 256v512l480 256 480-256V256z m394.24 273.28L512 476.16 120.96 274.56 512 70.4zM96 718.08v-384l384 197.76v402.56l-384-198.4z m832 17.92l-384 198.4V531.84l384-197.76v401.92z"  ></path></symbol><symbol id="gld-bf-untransparent" viewBox="0 0 1024 1024"><path d="M968.56051 244.585987l-456.56051 238.063695-456.56051-238.063695L512 0zM22.828025 306.547771l456.56051 235.454777v481.997452L22.828025 782.675159zM1001.171975 782.675159l-456.56051 241.324841V542.002548l456.56051-235.454777z"  ></path></symbol><symbol id="gld-bf-properties-" viewBox="0 0 1024 1024"><path d="M320 320v64H256V320h64z m448 0v64H384V320h384zM320 512v64H256V512h64z m448 0v64H384V512h384z m-448 192v64H256v-64h64z m448 0v64H384v-64h384zM64 0v960h896V0H64z m64 896V192h768v704H128z" fill="#333333" ></path></symbol><symbol id="gld-bf-dingwei" viewBox="0 0 1024 1024"><path d="M672.672 748.256C777.408 622.08 832 508.256 832 421.152 832 259.424 702.688 128 544 128s-288 131.424-288 293.12c0 141.12 127.232 313.632 288 463.456a1517.984 1517.984 0 0 0 128.672-136.32zM224 421.152C224 241.888 367.488 96 544 96s320 145.92 320 325.12c0 96-57.6 216.16-166.72 347.584A1588.288 1588.288 0 0 1 544 928c-69.312-62.592-320-302.72-320-506.88z"  ></path><path d="M544 544c70.592 0 128-57.408 128-128s-57.408-128-128-128-128 57.408-128 128 57.408 128 128 128z m0 32c-88.256 0-160-71.744-160-160s71.744-160 160-160 160 71.744 160 160-71.744 160-160 160z"  ></path></symbol><symbol id="gld-bf-ncloud" viewBox="0 0 1024 1024"><path d="M795.5 492c0.2-4.7 0.2-9 0.2-12.4 0-56.4-22-109.3-61.8-149.2-39.8-39.8-92.8-61.8-149.2-61.8-43.7 0-86.6 14.8-124.2 43-25.7 19.2-47.2 43.6-62.8 70.8-17-8.9-35.9-13.5-55.5-13.5-31.3 0-61.4 14.5-84.7 40.9-15.6 17.6-26.7 39-32 61.2-26.4 10.5-50 28.4-67 51.2-19.9 26.7-30.5 58.5-30.5 91.9 0 84.8 69 153.9 153.9 153.9l0-0.4L781 767.6l0 0.2c76.1 0 138-61.9 138-138C919.1 559 864.6 499.7 795.5 492L795.5 492zM786.6 736 786.6 736l-514.1-0.1C209.6 731 160 678.4 160 614.4c0-52.8 33.4-99.8 83.3-116.4 0.2-0.1 0.3-0.1 0.4-0.2 5-1.4 8.8-5.5 9.7-10.8 7.1-42.7 44.2-85.9 88.9-85.9 18.3 0 35.9 5.5 50.8 16 1.5 1.4 3.3 2.5 5.3 3.2l0 0c7.8 2.9 16.5-0.7 20-8.3 30.3-65.2 98-111.3 166.3-111.3 98.7 0 179 80.3 179 179 0 6.7-0.4 17.2-1 26.4-0.5 8.2 5.2 15.5 13.3 16.9l0 0c1.4 0.2 2.8 0.3 4.2 0.1l0 0.1c58.5 0 106.9 48.4 106.9 106.9C887.2 686.7 842.5 733.1 786.6 736L786.6 736z"  ></path></symbol><symbol id="gld-bf-axial-" viewBox="0 0 1024 1024"><path d="M608 128h32v736h-32V128z m128 128v32H928v416h-192v32h224V256h-224zM96 256h32v96H96V256z m0 192h32v96H96v-96z m0 192h32v96H96v-96z m320 64v32h96v-32h-96z m-192 0h96v32H224v-32zM224 256v32h96V256H224z m192 0h96v32h-96V256zM256 480h224v32H256z"  ></path></symbol><symbol id="gld-bf-sectionbox1" viewBox="0 0 1024 1024"><path d="M592 128L160 345.056V717.12l304 155.04L896 655.104V283.04L592 128z m269.664 172.544L464 500.064 194.368 362.56l397.664-200.096 269.632 138.08zM192 396.384l256 130.56v302.016l-256-130.56v-302.016z m672 240l-384 192.576v-302.016l384-192.576v302.016z"  ></path></symbol><symbol id="gld-bf-axial" viewBox="0 0 1024 1024"><path d="M416 128h-32v736h32V128zM288 256v32H96v416h192v32H64V256h224z m640 0h-32v96h32V256z m0 192h-32v96h32v-96z m0 192h-32v96h32v-96z m-320 64v32h-96v-32h96z m192 0h-96v32h96v-32z m0-448v32h-96V256h96z m-192 0h-96v32h96V256zM544 480h224v32h-224z"  ></path><path d="M672 384v224h-32v-224z"  ></path></symbol><symbol id="gld-bf-section-axial" viewBox="0 0 1024 1024"><path d="M320 749.76V362.016l256-173.632v387.744l-256 173.632z m-32 60.384l320-217.056V128L288 345.056v465.088z"  ></path><path d="M750.4 640.928l-15.52 26.848-277.12-160 15.488-26.88 277.12 160z m46.368-83.072l81.536 177.28-188.8 15.424 107.264-192.704z"  ></path></symbol><symbol id="gld-bf-min-" viewBox="0 0 1024 1024"><path d="M64 576v64h275.2L12.8 966.4l44.8 44.8L384 684.8V960h64V576H64z m838.4-499.2L576 403.2V128H512v384h384V448H620.8l326.4-326.4-44.8-44.8z"  ></path></symbol><symbol id="gld-bf-max-" viewBox="0 0 1024 1024"><path d="M576 64v64h275.2L524.8 454.4l44.8 44.8L896 172.8V448h64V64H576zM454.4 524.8L128 851.2V576H64v384h384v-64H172.8l326.4-326.4-44.8-44.8z"  ></path></symbol><symbol id="gld-bf-show" viewBox="0 0 1024 1024"><path d="M85.333333 505.941333S230.101333 256 512 256c286.378667 0 426.666667 251.050667 426.666667 251.050667s-139.221333 248.362667-426.666667 251.52c-292.309333 3.2-426.666667-252.586667-426.666667-252.586667zM512 682.666667a170.666667 170.666667 0 1 0 0-341.333334 170.666667 170.666667 0 0 0 0 341.333334z m0-42.666667a128 128 0 1 1 0-256 128 128 0 0 1 0 256z"  ></path></symbol><symbol id="gld-bf-hide" viewBox="0 0 1024 1024"><path d="M235.733333 213.333333l592.213334 592.213334-29.568 29.610666L206.165333 243.029333 235.690667 213.333333z m688.128 283.093334c-5.632-9.386667-141.482667-229.674667-412.757333-229.674667-52.096 0-99.114667 8.234667-141.226667 21.333333l34.261334 34.261334a428.8 428.8 0 0 1 106.965333-13.866667c250.752 0 376.917333 209.408 376.917333 209.408s-48.426667 81.152-145.792 142.378667l30.336 30.378666c98.048-64.426667 148.181333-145.792 151.466667-151.296l12.8-21.589333-12.970667-21.333333z m-306.090666 217.258666a425.984 425.984 0 0 1-106.666667 13.738667c-250.026667 0-376.96-209.408-376.96-209.408s48.682667-80.896 145.792-142.122667l-30.336-30.378666c-97.792 64.256-148.053333 145.28-151.296 150.912L85.333333 518.016l13.098667 21.589333c5.632 9.429333 142.122667 229.717333 412.672 229.717334 52.053333 0 99.072-8.106667 141.056-21.205334l-34.389333-34.432z m-138.88-316.586666c10.325333-2.773333 21.077333-4.693333 32.213333-4.693334a125.866667 125.866667 0 0 1 125.610667 125.610667c0 11.264-1.962667 21.845333-4.693334 32.213333l33.237334 33.237334a167.509333 167.509333 0 0 0-219.733334-219.605334l33.365334 33.237334z m64.128 241.834666c-10.325333 2.773333-20.906667 4.693333-31.914667 4.693334a125.866667 125.866667 0 0 1-125.653333-125.610667c0-11.093333 1.962667-21.76 4.693333-31.914667l-33.237333-33.28a167.509333 167.509333 0 0 0 219.605333 219.605334l-33.493333-33.493334z"  ></path></symbol><symbol id="gld-bf-layers" viewBox="0 0 1024 1024"><path d="M512 512L118.4 352 512 192l393.6 160L512 512z m-310.4-160l310.4 128 310.4-128L512 224l-310.4 128z"  ></path><path d="M707.2 464l115.2 48-310.4 128-310.4-128 115.2-48-41.6-16-156.8 64L512 672l393.6-160-156.8-64z"  ></path><path d="M707.2 624l115.2 48-310.4 128-310.4-128 115.2-48-41.6-16-156.8 64L512 832l393.6-160-156.8-64z"  ></path></symbol><symbol id="gld-bf-distance" viewBox="0 0 1024 1024"><path d="M800 480v256H192v-256h608z m-32 32H224v192h544v-192z" fill="#333333" ></path><path d="M672 608.032h32v-96h-32zM576 608.032h32v-96h-32zM384 608.032h32v-96h-32zM480 640h32v-128h-32zM288 608.032h32v-96H288zM192 352h608v-32H192z" fill="#333333" ></path><path d="M768 384.032h32V288h-32v96.032z m-576 0h32V288H192v96.032z" fill="#333333" ></path></symbol><symbol id="gld-bf-angle" viewBox="0 0 1024 1024"><path d="M192 704v64h640v-64H192z m-32-32h704v128H160v-128z" fill="#333333" ></path><path d="M216.736 672.608l-18.336-25.088L692.064 256.608l18.336 25.088z" fill="#333333" ></path><path d="M288 439.072c136.512 23.456 203.616 111.136 192.416 264.928h-32.8c10.112-138.08-40.128-212.544-159.616-233.024v-31.904z" fill="#333333" ></path></symbol><symbol id="gld-bf-view" viewBox="0 0 1024 1024"><path d="M528 160L224 320v384l304 160 304-160V320l-0.032 0.032M528.032 195.584L797.664 338.08 528 480 258.368 338.08l269.664-142.496zM256 372.992l256 134.752v311.68L256 684.672v-311.68z m544 311.68L544 819.424v-311.68l256-134.752v311.68z"  ></path></symbol><symbol id="gld-bf-orbit" viewBox="0 0 1024 1024"><path d="M774.816 705.536C717.76 784.704 625.472 832 528 832c-167.616 0-304-136.384-304-304h64l-80-128-80 128h64c0 185.28 150.72 336 336 336 107.712 0 209.696-52.256 272.736-139.776l-25.92-18.688zM864 528c0-185.28-150.72-336-336-336-108.928 0-211.584 53.184-274.56 142.24l26.112 18.464C336.576 272.128 429.44 224 528 224c167.616 0 304 136.384 304 304h-64l80 128 80-128h-64z"  ></path><path d="M688 416l-160-64v0.224l-159.712 63.872L368 416v224l160 64 160-64V416zM512 663.136l-112-44.8V463.264l112 44.8v155.072zM411.328 433.344L528 386.496v0.032l116.896 46.688L528 480l-116.672-46.656zM656 618.336l-112 44.8V508.064l112-44.8v155.072z"  ></path></symbol><symbol id="gld-bf-pan" viewBox="0 0 1024 1024"><path d="M528 496H768V416l128 96-128 96v-80h-240V768H608l-96 96-96-96h80v-240H256V608l-128-96 128-96v80h240V256H416l96-128 96 128h-80v240z"  ></path></symbol><symbol id="gld-bf-zoom" viewBox="0 0 1024 1024"><path d="M512 202.816L308.16 384h168.096L512 670.016 547.744 384h168.096L512 202.816zM594.752 704h-165.504L512 786.752 594.752 704z m-147.008-32l0.512 3.968 3.52-3.968H480l-3.52-28.032L480 640h-4L448 416H224l288-256 288 256h-224l-28 224H544l3.52 3.968L544 672h28.256l3.52 3.968 0.48-3.968H672l-160 160-160-160h95.744z"  ></path></symbol><symbol id="gld-bf-on-off" viewBox="0 0 1097 1024"><path d="M962.779429 274.066286a504.173714 504.173714 0 0 0-204.141715-175.177143 46.518857 46.518857 0 0 0-60.416 19.017143 39.716571 39.716571 0 0 0-2.486857 32.402285 43.154286 43.154286 0 0 0 22.601143 24.649143c143.798857 68.169143 233.179429 204.8 233.179429 356.864 0 219.867429-189.366857 398.848-421.961143 398.848s-422.253714-178.980571-422.253715-398.994285c0-152.137143 89.453714-288.841143 233.325715-356.937143a41.472 41.472 0 0 0 20.114285-57.124572 43.227429 43.227429 0 0 0-26.112-21.357714 46.445714 46.445714 0 0 0-34.230857 2.340571A503.954286 503.954286 0 0 0 95.817143 273.773714 464.530286 464.530286 0 0 0 17.408 531.748571c0 65.243429 13.604571 128.731429 40.301714 188.342858a483.474286 483.474286 0 0 0 109.714286 153.819428 512.950857 512.950857 0 0 0 162.742857 103.716572c63.195429 25.234286 130.194286 38.034286 199.241143 38.034285 69.046857 0 136.265143-12.8 199.241143-38.034285a514.706286 514.706286 0 0 0 162.816-103.716572 481.865143 481.865143 0 0 0 109.641143-153.819428 458.24 458.24 0 0 0 40.301714-188.342858c0-91.428571-27.209143-180.516571-78.628571-257.609142z"  ></path><path d="M529.408 438.857143c40.448 0 73.142857-21.065143 73.142857-47.177143V47.177143c0-26.112-32.694857-47.177143-73.142857-47.177143-40.448 0-73.142857 21.065143-73.142857 47.177143v344.502857c0 25.965714 32.914286 47.177143 73.142857 47.177143z"  ></path></symbol><symbol id="gld-bf-arrow-up" viewBox="0 0 1024 1024"><path d="M140.352 768h-41.6l-15.808-29.12L105.6 704h76.352l-41.6 64z m41.6-64h596.096L480 245.44 181.952 704zM480 128L896 768H64L480 128z"  ></path></symbol><symbol id="gld-bf-auto" viewBox="0 0 1024 1024"><path d="M205.568 384H148.448L64 672h51.904l21.376-72h76.16L234.432 672H288l-82.432-288z m-49.984 144l20.736-68.704 18.784 68.704H155.584zM512 384v184.672c0 35.2-3.712 61.504-21.664 78.848-16.992 16.32-41.568 24.48-73.6 24.48-14.272 0-27.232-2.048-38.816-6.112-15.904-5.632-28.8-14.72-38.816-27.136C326.4 622.624 320 600.48 320 572.16V384h64v184.256c0 6.24-0.8 12.576 3.84 17.76 8.16 9.28 15.456 13.984 28.16 13.984 17.056 0 19.904-4.416 27.872-13.344 3.296-3.744 4.128-8.384 4.128-15.776V384h64zM672 456V672h-64v-216h-64V384h192v72zM937.632 433.504a99.136 99.136 0 0 0-47.04-40.768A107.104 107.104 0 0 0 848 384c-14.944 0-29.248 2.88-42.816 8.736a98.688 98.688 0 0 0-47.104 40.768c-14.72 23.936-22.112 55.36-22.112 94.528 0 38.848 7.52 70.336 22.4 94.528a98.912 98.912 0 0 0 47.136 40.736 108.16 108.16 0 0 0 85.312-0.032 98.816 98.816 0 0 0 47.04-40.736c14.752-23.872 22.112-55.424 22.112-94.56 0.032-38.88-7.424-70.336-22.368-94.464z m-48 171.04c-11.264 12.64-25.152 19.04-41.568 19.04-16.64 0-30.56-6.4-41.536-19.04-14.528-16.48-21.76-42.016-21.76-76.576 0-34.496 7.232-60 21.76-76.544 11.2-12.672 25.056-19.04 41.536-19.04 16.672 0 30.528 6.4 41.568 19.04 14.464 16.544 21.696 42.048 21.696 76.544 0 34.56-7.232 60.096-21.696 76.576z"  ></path></symbol><symbol id="gld-bf-arrow-down" viewBox="0 0 1024 1024"><path d="M819.648 128h41.6l15.808 29.12L854.4 192h-76.352l41.6-64z m-41.6 64H181.952L480 650.56 778.048 192zM480 768L64 128h832L480 768z"  ></path></symbol><symbol id="gld-bf-add" viewBox="0 0 1024 1024"><path d="M448 448H128v128h320v320h128V576h320V448H576V128H448v320z"  ></path></symbol><symbol id="gld-bf-minus" viewBox="0 0 1024 1024"><path d="M128 448h768v128H128z"  ></path></symbol><symbol id="gld-bf-firstperson" viewBox="0 0 1024 1024"><path d="M528 224a80 80 0 1 0 0-160 80 80 0 0 0 0 160z m0 32a112 112 0 1 1 0-224 112 112 0 1 1 0 224z"  ></path><path d="M612.096 256h-170.624c-64.48 0-89.088 51.392-95.744 113.632L320 576.832c0 18.016 11.872 31.68 32.512 31.68s29.728-13.024 31.712-31.872l32.576-194.496 0.16 531.104c0 27.072 19.328 46.752 47.04 46.752 27.68 0 48.032-18.592 48.448-48.096L512 640h32l0.448 271.808c0 27.072 15.68 48.192 47.552 48.192 27.712 0 48.288-21.28 48.288-48.352l1.632-529.504 30.688 194.08c2.624 19.264 11.008 32.192 31.648 32.192s30.208-11.776 31.968-32.448l-23.424-211.136C707.392 302.912 676.544 256 612.096 256z m60.192 655.648A79.424 79.424 0 0 1 592 992c-28.096 0-50.336-11.456-64.096-30.08-14.4 18.752-37.184 30.08-63.904 30.08-45.216 0-79.04-33.856-79.04-78.72l-0.096-280.64a65.28 65.28 0 0 1-32.352 7.872c-37.728 0-64.512-27.36-64.512-63.68l0.256-3.936 25.664-206.656C323.2 279.36 363.52 224 441.472 224h170.624c78.656 0 125.344 55.264 132.48 137.28l23.456 211.168 0.064 6.24c-3.168 37.184-26.24 61.728-63.84 61.728-12.032 0-22.4-2.56-31.104-7.168l-0.864 278.4z"  ></path></symbol><symbol id="gld-bf-measure" viewBox="0 0 1024 1024"><path d="M160 672h736v-256H160v256z m-32-288h800v320H128V384z m0-32h800v32H128v-32z"  ></path><path d="M224 416h32v96H224v-96z m96 0h32v96h-32v-96z m96 0h32v96h-32v-96z m192 0h32v96h-32v-96z m-96 0h32v160h-32v-160z m192 0h32v96h-32v-96z m96 0h32v96h-32v-96z"  ></path></symbol><symbol id="gld-bf-notes" viewBox="0 0 1024 1024"><path d="M192 768.672l640 0 0 64-640 0 0-64Z"  ></path><path d="M931.904 775.2"  ></path><path d="M1191.008 516.096"  ></path><path d="M1214.56 492.544"  ></path><path d="M166.4 439.712 165.76 438.592 167.04 438.592Z"  ></path><path d="M359.712 682.784l-134.88 22.464 22.464-134.848L359.712 682.784zM359.712 682.784"  ></path><path d="M725.44 317.056l39.328-39.328-112.384-112.384-39.328 39.328L725.44 317.056zM725.44 317.056"  ></path><path d="M702.656 339.84 590.272 227.488 269.792 547.936 382.176 660.288 495.456 547.04 495.456 547.04Z"  ></path></symbol><symbol id="gld-bf-narrow" viewBox="0 0 1024 1024"><path d="M352 480l192 192-288 96L352 480zM292 754.9l-22-23.3L768 256l23.5 24L292 754.9z"  ></path></symbol><symbol id="gld-bf-noval" viewBox="0 0 1024 1024"><path d="M512 192c158.8 0 288 129.2 288 288S670.8 768 512 768 224 638.8 224 480 353.2 192 512 192M512 160c-176.7 0-320 143.3-320 320s143.3 320 320 320 320-143.3 320-320S688.7 160 512 160L512 160z"  ></path></symbol><symbol id="gld-bf-nrectangle" viewBox="0 0 1024 1024"><path d="M800.2 256.1l0 447.7-576.3 0L223.9 256.1 800.2 256.1M832.2 224.1 191.8 224.1l0 511.7 640.3 0L832.2 224.1 832.2 224.1z"  ></path></symbol><symbol id="gld-bf-ntext" viewBox="0 0 1024 1024"><path d="M784 224l0 150.4-14.6 0c-8.7-34.4-18.3-58.5-28.8-73.6s-25.1-27-43.5-36c-10.3-4.9-28.3-7.3-54-7.3l-41 0 0 425c0 28.2 1.6 45.8 4.7 52.8s9.2 13.2 18.2 18.5c9.1 5.3 21.5 7.9 37.2 7.9l18.3 0 0 15L392.1 776.7l0-15 18.3 0c16 0 28.8-2.8 38.6-8.5 7-3.8 12.6-10.3 16.7-19.5 3-6.5 4.5-23.6 4.5-51.2l0-424.9-39.8 0c-37.1 0-64.1 7.9-80.8 23.6-23.6 22-38.5 52.6-44.7 93.3L288 374.5 288 224 784 224z"  ></path></symbol><symbol id="gld-bf-mark" viewBox="0 0 1024 1024"><path d="M192.2 800.2l608-608.2 22.6 22.6-608 608.2C214.8 822.8 192.2 800.2 192.2 800.2zM809.6 822.8l-608-608.2 22.6-22.6 608 608.2C832.2 800.2 809.6 822.8 809.6 822.8z"  ></path></symbol><symbol id="gld-bf-zoomrect" viewBox="0 0 1024 1024"><path d="M886.4 809.6l-96-96c25.6-28.8 41.6-64 41.6-105.6 0-9.6 0-19.2-3.2-28.8v-6.4c-3.2-9.6-3.2-16-6.4-22.4 0-3.2-3.2-6.4-3.2-9.6-3.2-6.4-6.4-9.6-9.6-16-3.2-6.4-6.4-9.6-9.6-16l-6.4-6.4c-6.4-9.6-16-16-22.4-22.4v-288h-512v512h288c6.4 9.6 12.8 16 22.4 22.4l6.4 6.4c6.4 3.2 9.6 6.4 16 9.6 6.4 3.2 9.6 6.4 16 9.6 3.2 0 6.4 3.2 9.6 3.2 6.4 3.2 16 6.4 22.4 6.4h6.4c9.6 3.2 19.2 3.2 28.8 3.2 35.2 0 67.2-12.8 96-32l96 96 19.2-19.2zM288 672v-448h448v236.8c-19.2-9.6-41.6-12.8-64-12.8-89.6 0-160 70.4-160 160 0 22.4 6.4 44.8 12.8 64h-236.8z m384 64c-9.6 0-19.2 0-28.8-3.2-3.2 0-3.2 0-6.4-3.2-6.4-3.2-12.8-3.2-19.2-6.4-3.2 0-3.2-3.2-6.4-3.2-6.4-3.2-12.8-6.4-19.2-12.8 0 0-3.2 0-3.2-3.2l-19.2-19.2-6.4-6.4c-12.8-19.2-19.2-44.8-19.2-70.4 0-70.4 57.6-128 128-128 25.6 0 48 6.4 70.4 19.2l6.4 6.4c6.4 6.4 16 12.8 19.2 19.2 0 0 0 3.2 3.2 3.2 6.4 6.4 9.6 12.8 12.8 19.2 0 3.2 3.2 3.2 3.2 6.4 3.2 6.4 6.4 12.8 6.4 19.2 0 3.2 0 3.2 3.2 6.4 3.2 9.6 3.2 19.2 3.2 28.8 0 70.4-57.6 128-128 128z"  ></path></symbol><symbol id="gld-bf-selected" viewBox="0 0 1024 1024"><path d="M930.133333 315.733333L827.733333 213.333333 409.6 631.466667 196.266667 418.133333 85.333333 529.066667l213.333334 213.333333 102.4 102.4L512 742.4l418.133333-426.666667z" fill="#333333" ></path></symbol><symbol id="gld-bf-tree" viewBox="0 0 1024 1024"><path d="M800 672v-192h-288V288h96V128h-224v160h96v192H192v192H128v160h160v-160H224v-160h256v160h-64v160h160v-160h-64v-160h256v160h-64v160h160v-160z"  ></path></symbol><symbol id="gld-bf-infor" viewBox="0 0 1024 1024"><path d="M512 85.333333c238.933333 0 426.666667 187.733333 426.666667 426.666667s-187.733333 426.666667-426.666667 426.666667-426.666667-187.733333-426.666667-426.666667 187.733333-426.666667 426.666667-426.666667m0-85.333333C230.4 0 0 230.4 0 512s230.4 512 512 512 512-230.4 512-512-230.4-512-512-512z"  ></path><path d="M469.333333 256h85.333334v85.333333h-85.333334zM469.333333 426.666667h85.333334v341.333333h-85.333334z"  ></path></symbol><symbol id="gld-bf-box-hide" viewBox="0 0 1024 1024"><path d="M528 128L96 352v352l304 160 131.2-67.2c-9.6-9.6-22.4-12.8-32-19.2L416 819.2v-278.4l384-198.4v188.8c9.6 3.2 22.4 6.4 32 9.6V288l-304-160zM128 684.8v-278.4l256 134.4v278.4l-256-134.4z m272-172.8l-268.8-140.8 396.8-208 268.8 144L400 512z" fill="#333333" ></path><path d="M682.72 582.848l-25.664-25.664A241.408 241.408 0 0 1 736 544c94.272 0 179.584 53.344 256 160-28.8 40.224-58.88 72.832-90.24 97.92l-22.72-22.784c24.96-19.52 49.312-44.512 73.056-75.136-66.912-86.304-138.688-128-216.096-128-18.048 0-35.84 2.24-53.28 6.848z m-89.728 46.016c-24.992 19.52-49.344 44.512-73.088 75.136 66.912 86.304 138.688 128 216.096 128 18.048 0 35.84-2.24 53.28-6.848l25.664 25.664c-25.6 8.8-51.904 13.184-78.944 13.184-94.272 0-179.584-53.344-256-160 28.8-40.224 58.88-72.832 90.24-97.92l22.72 22.784h0.032z" fill="#333333" ></path><path d="M799.872 700a64 64 0 0 0-59.84-59.872l-28.896-28.864a96.128 96.128 0 0 1 117.6 117.6l-28.864-28.864z m-127.744 8a64 64 0 0 0 59.84 59.872l28.896 28.864a96.128 96.128 0 0 1-117.6-117.6l28.864 28.864zM576 521.376L915.424 860.8l-22.656 22.624L553.376 544z" fill="#333333" ></path></symbol><symbol id="gld-bf-information" viewBox="0 0 1024 1024"><path d="M512 160c195.2 0 352 156.8 352 352s-156.8 352-352 352S160 707.2 160 512 316.8 160 512 160m0-32C300.8 128 128 300.8 128 512s172.8 384 384 384 384-172.8 384-384S723.2 128 512 128z"  ></path><path d="M480 320h64v64h-64zM480 448h64v256h-64z"  ></path></symbol><symbol id="gld-bf-properties" viewBox="0 0 1024 1024"><path d="M1191.008 516.096"  ></path><path d="M1214.56 492.544"  ></path><path d="M288 416l64 0 0 64-64 0 0-64Z"  ></path><path d="M416 416l352 0 0 64-352 0 0-64Z"  ></path><path d="M288 544l64 0 0 64-64 0 0-64Z"  ></path><path d="M416 544l352 0 0 64-352 0 0-64Z"  ></path><path d="M288 672l64 0 0 64-64 0 0-64Z"  ></path><path d="M416 672l352 0 0 64-352 0 0-64Z"  ></path><path d="M852 160 192 160l0 160 0 544 672 0L864 160 852 160zM384 208l64 0 0 64-64 0L384 208zM288 208l64 0 0 64L288 272 288 208zM832 832 224 832 224 320l608 0L832 832z"  ></path></symbol><symbol id="gld-bf-map" viewBox="0 0 1024 1024"><path d="M656 96C524.8 96 416 201.6 416 336S656 736 656 736 896 467.2 896 336 790.4 96 656 96z m0 339.2c-67.2 0-121.6-54.4-121.6-121.6 0-67.2 54.4-121.6 121.6-121.6s121.6 54.4 121.6 121.6c0 67.2-54.4 121.6-121.6 121.6zM128 704h480v32H128zM128 416h288v32h-288z"  ></path><path d="M320 256h32v672h-32zM640 768h32v160h-32zM704 704h160v32h-160z"  ></path></symbol><symbol id="gld-bf-maximize" viewBox="0 0 1024 1024"><path d="M608 192v32h169.6l-227.2 227.2 22.4 22.4L800 246.4V416h32V192zM451.2 550.4L224 777.6V608H192v224h224v-32H246.4l227.2-227.2z"  ></path><path d="M896 128v768H128V128h768m32-32H96v832h832V96z"  ></path></symbol><symbol id="gld-bf-minimize" viewBox="0 0 1024 1024"><path d="M256 544v32h169.6l-227.2 227.2 22.4 22.4 227.2-227.2V768h32v-224zM803.2 198.4L576 425.6V256h-32v224h224v-32h-169.6l227.2-227.2z"  ></path><path d="M896 128v768H128V128h768m32-32H96v832h832V96z"  ></path></symbol><symbol id="gld-bf-reset-box" viewBox="0 0 1024 1024"><path d="M210.56 672l112-160h-224z" fill="#333333" ></path><path d="M530.016 864v-32a304 304 0 1 0-304-304h-32c0-185.568 150.4-336 336-336 185.568 0 336 150.432 336 336S715.552 864 530.016 864z" fill="#333333" ></path></symbol><symbol id="gld-bf-rotate-box" viewBox="0 0 1024 1024"><path d="M528 832c-166.4 0-304-137.6-304-304h64l-80-128-80 128h64C192 713.6 342.4 864 528 864c108.8 0 211.2-51.2 272-140.8l-25.6-19.2c-57.6 80-150.4 128-246.4 128zM864 528C864 342.4 713.6 192 528 192c-108.8 0-211.2 54.4-275.2 140.8l25.6 19.2c57.6-80 150.4-128 249.6-128C694.4 224 832 361.6 832 528h-64l80 128 80-128h-64z"  ></path><path d="M640 416v224h-224V416h224m32-32h-288v288h288V384z"  ></path></symbol><symbol id="gld-bf-close16" viewBox="0 0 1024 1024"><path d="M929.7 873.9 567.8 511.8l361.4-361.6c11.9-11.9 11.9-31.2 0-43.2l-12.7-12.7c-11.9-11.9-31.2-11.9-43.1 0L512 455.9 150.6 94.3c-11.9-11.9-31.2-11.9-43.1 0L94.8 107c-11.9 11.9-11.9 31.2 0 43.2l361.4 361.6L94.2 873.9c-11.9 11.9-11.9 31.3 0 43.2l12.7 12.7c11.9 11.9 31.2 11.9 43.1 0L512 567.6l361.9 362.1c11.9 11.9 31.2 11.9 43.1 0l12.7-12.7C941.6 905.1 941.6 885.8 929.7 873.9z"  ></path></symbol><symbol id="gld-bf-orbitcamera" viewBox="0 0 1024 1024"><path d="M512 32"  ></path><path d="M528 832C360.384 832 224 695.616 224 528l64 0-80-128-80 128 64 0C192 713.28 342.72 864 528 864c107.712 0 209.696-52.256 272.736-139.776l-25.952-18.688C717.76 784.704 625.472 832 528 832z"  ></path><path d="M864 528C864 342.72 713.28 192 528 192c-108.928 0-211.584 53.184-274.56 142.24l26.112 18.464C336.576 272.128 429.44 224 528 224c167.616 0 304 136.384 304 304l-64 0 80 128 80-128L864 528z"  ></path><path d="M704 416l-96 48L608 416l-256 0 0 224 256 0 0-48 96 48L704 416zM576 608l-192 0 0-160 192 0 0 32 0 96L576 608zM672 588.224l-64-32 0-56.448 64-32L672 588.224z"  ></path></symbol><symbol id="gld-bf-orbitpoint" viewBox="0 0 1024 1024"><path d="M512 32"  ></path><path d="M528 832C360.384 832 224 695.616 224 528l64 0-80-128-80 128 64 0C192 713.28 342.72 864 528 864c107.712 0 209.696-52.256 272.736-139.776l-25.952-18.688C717.76 784.704 625.472 832 528 832z"  ></path><path d="M864 528C864 342.72 713.28 192 528 192c-108.928 0-211.584 53.184-274.56 142.24l26.112 18.464C336.576 272.128 429.44 224 528 224c167.616 0 304 136.384 304 304l-64 0 80 128 80-128L864 528z"  ></path><path d="M528 528m-112 0a3.5 3.5 0 1 0 224 0 3.5 3.5 0 1 0-224 0Z"  ></path></symbol><symbol id="gld-bf-settings" viewBox="0 0 1024 1024"><path d="M796.896 435.552c-6.72-25.12-16.672-48.96-29.408-70.976l55.872-84.32-0.096-0.096-79.456-79.456L743.712 200.64l-84.32 55.872c-22.016-12.736-45.824-22.688-70.976-29.408L568.32 128l-0.128 0-112.384 0L455.68 128l-20.128 99.104c-25.12 6.72-48.96 16.672-70.976 29.408L280.288 200.64 280.192 200.736 200.736 280.192 200.64 280.288l55.872 84.32c-12.736 22.016-22.688 45.824-29.408 70.976L128 455.68l0 0.128 0 112.384 0 0.128 99.104 20.128c6.72 25.12 16.672 48.96 29.408 70.976L200.64 743.712l0.096 0.096 79.456 79.456 0.096 0.096 84.32-55.872c22.016 12.736 45.824 22.688 70.976 29.408L455.68 896l0.128 0 112.384 0 0.128 0 20.096-99.104c25.12-6.72 48.96-16.672 70.976-29.408l84.32 55.872 0.096-0.096 79.456-79.456 0.096-0.096-55.872-84.32c12.736-22.016 22.688-45.824 29.408-70.976L896 568.32l0-0.128 0-112.384L896 455.68 796.896 435.552zM512 672c-88.352 0-160-71.648-160-160s71.648-160 160-160 160 71.648 160 160S600.352 672 512 672z"  ></path></symbol><symbol id="gld-bf-home" viewBox="0 0 1024 1024"><path d="M928 512L512 128 96 512h128v352h192V608h192v256h192V512z"  ></path></symbol><symbol id="gld-bf-sectionbox" viewBox="0 0 1024 1024"><path d="M576 160l32 0 0 704-32 0 0-704Z"  ></path><path d="M672 256 672 288 704 288 830.016 288 864 288 864 672 830.016 672 704 672 672 672 672 704 896 704 896 256Z"  ></path><path d="M128 512l32 0 0 96-32 0 0-96Z"  ></path><path d="M128 704l32 0c16 0 32 0 32 0l0-32L128 672 128 704z"  ></path><path d="M416 288 452 288 480 288 512 288 512 256 416 256Z"  ></path><path d="M128 352l32 0 0 96-32 0 0-96Z"  ></path><path d="M128 256l64 0 0 32-64 0 0-32Z"  ></path><path d="M256 256l96 0 0 32-96 0 0-32Z"  ></path><path d="M416 672 416 704 512 704 512 672 452 672Z"  ></path><path d="M256 672l96 0 0 32-96 0 0-32Z"  ></path></symbol></svg>'
;if((n=document.getElementsByTagName("script"))[n.length-1].getAttribute("data-injectcss")&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}o=function(){var e,t,n,o,i,a=document.createElement("div");a.innerHTML=d,d=null,(e=a.getElementsByTagName("svg")[0])&&(e.setAttribute("aria-hidden","true"),e.style.position="absolute",e.style.width=0,e.style.height=0,e.style.overflow="hidden",t=e,(n=document.body).firstChild?(o=t,(i=n.firstChild).parentNode.insertBefore(o,i)):n.appendChild(t))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(o,0):(i=function(){document.removeEventListener("DOMContentLoaded",i,!1),o()},document.addEventListener("DOMContentLoaded",i,!1)):document.attachEvent&&(a=o,r=e.document,s=!1,(l=function(){try{r.documentElement.doScroll("left")}catch(e){return void setTimeout(l,50)}t()})(),r.onreadystatechange=function(){"complete"==r.readyState&&(r.onreadystatechange=null,t())})}(window),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=function(){return{id:null,tagName:"div",className:"bf-control",title:"",element:""}};e.ControlConfig=t}(),function(){var e=Object.freeze({Click:"Click",MouseEnter:"MouseEnter",MouseLeave:"MouseLeave",MouseMove:"MouseMove",StateChange:"StateChange",Change:"Change"});Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control").ControlEvent=e}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(e){var n=this;n.eventManager=new Glodon.Web.Lang.EventManager,n.element=t.create(e.tagName,e.className),n.id=e.id||Glodon.Web.Lang.Utility.UUID.createUUID(),e.title&&!e.isPanel&&n.setTitle(e.title),e.element&&e.element.appendChild(n.element)};n.prototype={addEventListener:function(e,t){var n=this,o=n.eventManager;n.element.addEventListener(e.toLocaleLowerCase(),t),o.addEvent(e,t)},removeEventListener:function(e,t){var n=this;n.eventManager.removeEvent(e,t),n.element.removeEventListener(e.toLocaleLowerCase(),t)},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"},setTitle:function(e){this.element.setAttribute("title",e)},getTitle:function(){return this.element.getAttribute("title")},setClassNames:function(e){this.element.setAttribute("class",e)},getClassNames:function(){return this.element.getClass()},addClassName:function(e){this.element.addClass(e)},removeClassName:function(e){this.element.removeClass(e)},toggleClassName:function(e,t){this.element.toggleClass(e,t)},setDomId:function(e){this.element.setAttribute("id",e)},getDomId:function(){return this.element.getAttribute("id")},getId:function(){return this.id},setHtml:function(e){this.element.innerHTML=e},setStyle:function(e){this.element.setCss(e)},destroy:function(){this.element.parentNode&&this.element.parentNode.removeChild(this.element)}},e.Control=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Toolbar"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-toolbar"};return Object.assign({},t,e)};e.ToolbarConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Toolbar"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),function(t){this._controls=[],e.Control.call(this,t),this.element.addEventListener("mousedown",this.bringToFront.bind(this))});n.Type.inheritPrototype(o,e.Control),o.prototype.addControl=function(e){this.getControls().push(e),this.element.appendChild(e.element)},o.prototype.bringToFront=function(){if(!this.element.hasClass("bf-pinned")){var e=document.querySelector(".bf-pinned");e&&e.removeClass("bf-pinned"),this.element.addClass("bf-pinned")}},o.prototype.addControls=function(e){for(var t=this,n=0,o=e.length;n<o;n++)t.addControl(e[n]);return this.getControls()},o.prototype.insertControl=function(e,t){var n=this.getControls();n.insert(e,t);var o=n[e+1];o?this.element.insertBefore(t.element,o.element):this.element.appendChild(t.element)},o.prototype.removeControl=function(e){var t=this.getControls(),n=t.getObjectByAttribute("id",e);t.removeObjectByAttribute("id",e),this.element.removeChild(n.element)},o.prototype.getControls=function(){return this._controls},o.prototype.getControl=function(e){return this.getControls().getObjectByAttribute("id",e)},o.prototype.destroy=function(){for(var e=this.getControls(),t=0;t<e.length;t++)e[t].destroy();this._controls=[],this.element.parentNode&&this.element.parentNode.removeChild(this.element)},t.Toolbar=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=(Glodon.Bimface.UI.Button.ButtonOption,new Glodon.Bimface.UI.Control.ControlConfig),n=function(){var e={className:"bf-button",title:"button",checkedState:!1,defaultClass:"",changeClass:"",inheritTitle:!1};return Object.assign({},t,e)};e.ButtonConfig=n}(),function(){var e=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control")),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=function(t){e.Control.call(this,t)};n.Type.inheritPrototype(o,e.Control),o.prototype.addToolbar=function(e){this.toolbar=e,this.element.appendChild(e.element)},o.prototype.getToolbar=function(e){return this.toolbar},t.Button=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),n=Glodon.Bimface.UI.Control.ControlEvent,o=function(t){e.Button.call(this,t);var o=this;o._checked=t.checkedState,o._checked&&this.addClassName("bf-checked"),o.addEventListener(n.Click,function(){o.toggleCheckedState()})};t.Type.inheritPrototype(o,e.Button),o.prototype.toggleCheckedState=function(){this.setCheckedState(!this._checked)},o.prototype.setCheckedState=function(e){this._checked!=e&&(this._checked=e,this.toggleClassName("bf-checked",e),this.eventManager.fireEvent(n.StateChange,e))},o.prototype.isChecked=function(){return this._checked},e.ToggleButton=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Toolbar"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),i=new n.ToolbarConfig,a=new e.ControlConfig,r=function(t){e.Control.call(this,t);var o=this;o._inheritTitle=t.inheritTitle;var r=new e.Control(a);r.setClassNames("bf-current"),i.element=o.element,i.className="bf-sub-toolbar bf-scroll-bar";var s=new n.Toolbar(i);o.currentElement=r,o._subToolbar=s,o.element.appendChild(o.currentElement.element),o.addEventListener("Click",function(){o.toggleDropDownList()})};o.Type.inheritPrototype(r,e.Control),r.prototype.toggleDropDownList=function(){this.checked=!this.checked,this.toggleClassName("bf-expand")},r.prototype.showDropDownList=function(){this._checked=!0,this.addClassName("bf-expand")},r.prototype.hideDropDownList=function(e){this._checked=!1,this.removeClassName("bf-expand")},r.prototype.addControl=function(e){var t=this,n=t.getControls();t._subToolbar.addControl(e),1==n.length&&t.setSelectedControlById(e.id),e.addEventListener("Click",function(){for(var o=0,i=n.length;o<i;o++)n[o].setCheckedState(!1);t.currentElement.setHtml(this.outerHTML.replace("checked","")),e.setCheckedState(!0),t._currentControl=e,t.eventManager.fireEvent("Change",e)})},r.prototype.removeControl=function(e){this._subToolbar.removeControl(e)},r.prototype.getControls=function(){return this._subToolbar.getControls()},r.prototype.getControl=function(e){return this._subToolbar.getControl(e)},r.prototype.getCurrentControl=function(){return this._currentControl},r.prototype.setSelectedControlById=function(e){var t=this.getControl(e);t.setCheckedState(!1);var n=t.element.cloneNode(!0);this._inheritTitle||n.removeAttribute("title"),this.currentElement.setHtml(n.outerHTML),t.setCheckedState(!0),this._currentControl=t},t.ComboBox=r}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),n=function(t){e.ComboBox.call(this,t),this.currentElement=t.home,this.home=t.home,this.element.appendChild(this.currentElement.element)};t.Type.inheritPrototype(n,e.ComboBox),n.prototype.addControl=function(e){var t=this,n=t.getControls();t._subToolbar.addControl(e),e.addEventListener("Click",function(){for(var o=0,i=n.length;o<i;o++)n[o].setCheckedState(!1);t.currentElement.setCheckedState(!1),t._currentControl=e,t.eventManager.fireEvent("Change",e)})},n.prototype.recover=function(){this.home.setCheckedState(!1),this.hideDropDownList()},e.TouchComboBox=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),n=function(t){e.ToggleButton.call(this,t)};t.Type.inheritPrototype(n,e.ToggleButton),e.ComboBoxOptionButton=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),n=function(t){e.Button.call(this,t);var n=this;n.addClassName(t.defaultClass),n._defaultClass=t.defaultClass,n._changeClass=t.changeClass,this.type="default",n._title=t.title,n._changeTitle=t.changeTitle||t.title,n._checked&&this.addClassName("bf-checked"),n.addEventListener("Click",function(){n.toggleState(),n.eventManager.fireEvent("Change",n.type)})};t.Type.inheritPrototype(n,e.Button),n.prototype.toggleState=function(){this.setState("change"==this.type?"default":"change")},n.prototype.setState=function(e){this.type=e,"default"==e?(this.addClassName(this._defaultClass),this.removeClassName(this._changeClass)):(this.addClassName(this._changeClass),this.removeClassName(this._defaultClass))},e.ChangeButton=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),n={},o=function(t){e.Button.call(this,t);var o=this;o._checked=t.checkedState,o.addEventListener("Click",function(){o.setChecked()}),n[t.groupName]?(n[t.groupName].push(o),this._groupList=n[t.groupName]):(n[t.groupName]=[o],this._groupList=n[t.groupName],o.setChecked())};t.Type.inheritPrototype(o,e.Button),o.prototype.setChecked=function(){for(var e=this._groupList,t=0,n=e.length;t<n;t++)e[t].removeClassName("bf-checked");this.addClassName("bf-checked")},e.SingleButton=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Menu"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-menu",isSubMenu:!1,text:null};return Object.assign({},t,e)};e.MenuConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Menu"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-menu-item"};return Object.assign({},t,e)};e.MenuItemConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Button"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Menu"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),function(t){this._controls=[],e.Button.call(this,t),this.isDisabled=!1});n.Type.inheritPrototype(o,e.Button),o.prototype.setText=function(e){this.element.innerText=e},o.prototype.disabled=function(e){this.element.addClass("bf-disabled"),this.isDisabled=!0},o.prototype.enabled=function(e){this.element.removeClass("bf-disabled"),this.isDisabled=!1},o.prototype.hide=function(e){this.element.addClass("bf-hide"),this.isHide=!0},o.prototype.show=function(e){this.element.removeClass("bf-hide"),this.isHide=!1},o.prototype.addEventListener=function(e,t){var n=this,o=n.eventManager;this.isDisabled||(n.element.addEventListener(e.toLocaleLowerCase(),t),o.addEvent(e,t))},t.MenuItem=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Menu"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(){this.element=t.create("div","bf-spacer")};n.prototype.hide=function(e){this.element.addClass("bf-hide"),this.isHide=!0},e.Spacer=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Toolbar"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Menu"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),i=function(t){if(e.Toolbar.call(this,t),this.element.addEventListener("mousedown",function(e){e.stopPropagation()}),this.element.addEventListener("contextmenu",function(e){e.preventDefault()}),this.isDisabled=!1,t.isSubMenu){var n=o.create("div","bf-menu-item");n.innerText=t.text;var i=o.create("div","bf-menu");this.element.appendChild(n),this.element.appendChild(i),this.subElement=i}};n.Type.inheritPrototype(i,e.Toolbar),i.prototype.setPosition=function(e){this.element.style.left=e.x+"px",this.element.style.top=e.y+"px"},i.prototype.addControl=function(e){this.getControls().push(e),this.subElement?this.subElement.appendChild(e.element):this.element.appendChild(e.element)},i.prototype.disabled=function(e){this.element.addClass("bf-disabled"),this.isDisabled=!0},i.prototype.enabled=function(e){this.element.removeClass("bf-disabled"),this.isDisabled=!1},i.prototype.destroy=function(e){this.element&&this.element.remove(),this.element=null},t.Menu=i}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Panel"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility");t.PanelPositions=t.PanelPositions||{};var i=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),a=function(o){o.isPanel=!0,this._opt=o,e.Control.call(this,o),this._controls=[];var a=this,r=a.element;a.isShow=!0;var s=n.create("div","bf-panel-body"),l=n.create("div","bf-panel-header"),d=n.create("div","bf-panel-footer"),c=n.create("div","bf-panel-container bf-scroll-bar"),u=n.create("div","bf-close"),p=o.css;for(var h in p)r.style[h]=""+p[h];if(o.easyMode||r.appendChild(u),o.title){var f=n.create("div","bf-title");f.textContent=o.title,r.appendChild(f),r.addClass("bf-has-title"),a.headerElement=f}s.appendChild(l),s.appendChild(c),r.appendChild(s),s.appendChild(d),f&&o.enableDrag&&i&&(this.drag=new Glodon.Web.Lang.Utility.Dom.drag({element:this.element,handle:f,bBoxDetection:!0,move:function(e,t,n){a.eventManager.fireEvent("Move",e,t,n)},record:function(e,n){t.PanelPositions[o.className]={left:e,top:n}}})),this.body=s,this.container=c,this.header=l,this.footer=d,o.enableSizable&&Glodon.Web.Lang.Utility.Dom.sizable({element:this.element,axis:"all",sizable:function(e,t,n){a.eventManager.fireEvent("Sizable",e,t,n)}}),r.addEventListener("mousedown",this.onMouseDown.bind(this)),r.addEventListener("mousemove",this.onMouseMove.bind(this)),document.addEventListener("mouseup",this.onMouseUp.bind(this)),u.addEventListener("click",function(){a.hide()}),c.addEventListener("click",function(e){var t=e.target.closest(".bf-group-title");if(t&&t.hasClass("bf-group-title")){t.parentNode.toggleClass("bf-collapse")}}),c.addEventListener("DOMNodeRemoved",function(){a.showTips()}),c.addEventListener("DOMNodeInserted",function(){a.hideTips()}),window.addEventListener("resize",this.initPosition.bind(this))};o.Type.inheritPrototype(a,e.Control),a.prototype.setData=function(e,t){if(this.clear(),e&&e.length>0){for(var n='<table class="bf-table">',o=0,i=e.length;o<i;o++){for(var a='<tbody class="bf-group '+(t&&"bf-collapse")+'"><tr class="bf-group-title"><td colspan="2"><i class="bf-icon"></i>'+e[o].group+"</td></tr>",r=e[o].items,s=0,l=r.length;s<l;s++){var d=r[s];a+='<tr class="bf-group-content"><td class="bf-key">'+d.key+'</td><td class="bf-value">'+d.value+"</td></tr>"}a+="</tbody>",n+=a}n+="</table>",this.container.innerHTML=n}},a.prototype.setTitleContent=function(e){this.headerElement.textContent=e},a.prototype.onMouseDown=function(){this.isMouseDown=!0,this.element.removeEventListener("mousemove",this.onMouseMove),this.bringToFront()},a.prototype.onMouseMove=function(e){!0!==this.isMouseDown&&(e.preventDefault(),e.stopPropagation())},a.prototype.onMouseUp=function(){this.isMouseDown=!1,this.element.addEventListener("mousemove",this.onMouseMove)},a.prototype.bringToFront=function(){if(!this.element.hasClass("bf-pinned")){var e=document.querySelector(".bf-pinned");e&&e.removeClass("bf-pinned"),this.element.addClass("bf-pinned")}},a.prototype.showTips=function(){if(this.tipsElement)return void this.body.insertBefore(this.tipsElement,this.body.childNodes[1])},a.prototype.setTips=function(e,t){this.tipsElement&&this.tipsElement.remove();var o={default:"bf-panel-tips",loading:"bf-panel-loading"},i=o[t]||o.default,a=n.create("div",i);a.textContent=e,this.tipsElement=a,this.showTips()},a.prototype.hideTips=function(){this.tipsElement&&this.tipsElement.remove()},a.prototype.setContainerHeader=function(e){if("String"==typeof e);else{e.style.right="100%",e.style.bottom="100%",document.body.appendChild(e);var t=e.offsetHeight;document.body.removeChild(e),e.removeAttribute("style"),e.style.marginTop="-"+t+"px",this.body.style.paddingTop=t+"px",this.header.appendChild(e)}},a.prototype.setContainerFooter=function(e){"String"==typeof e||this.footer.appendChild(e)},a.prototype.close=function(){this.destroy(),this.eventManager.fireEvent("Close"),this.isShow=!1,window.removeEventListener("resize",this.initPosition.bind(this))},a.prototype.hide=function(e){this.isShow=!1,this.element.style.display="none",!0!==e&&this.eventManager.fireEvent("Hide")},a.prototype.show=function(e){this.isShow=!0,this.element.style.display="",!0!==e&&this.eventManager.fireEvent("Show"),this.bringToFront(),this.initPosition()},a.prototype.clear=function(){this.container.innerHTML=""},a.prototype.toggle=function(){this.isShow?this.element.style.display="none":(this.element.style.display="",this.bringToFront()),this.isShow=!this.isShow},a.prototype.addControl=function(e){this.getControls().push(e),this.container.appendChild(e.element)},a.prototype.getControls=function(){return this._controls},a.prototype.getControl=function(e){return this.getControls().getObjectByAttribute("id",e)},a.prototype.setHtml=function(e){this.container.innerHTML=e},a.prototype.addClass=function(e){this.element.addClass(e)},a.prototype.removeClass=function(e){this.element.removeClass(e)},a.prototype.setHeight=function(e){this.element.style.height=e+"px"},a.prototype.setWidth=function(e){this.element.style.width=e+"px"},a.prototype.setHeader=function(e){this._opt.title=e,this.headerElement.textContent=e},a.prototype.getTitle=function(){return this._opt.title},a.prototype.isDisplay=function(){return"none"!=this.element.style.display},a.prototype.initPosition=function(){this.isShow&&this.drag&&(t.PanelPositions[this._opt.className]?(this.element.style.left=t.PanelPositions[this._opt.className].left+"px",this.element.style.top=t.PanelPositions[this._opt.className].top+"px",this.drag.resize(this.element)):this.drag.resize(this.element,null,!0))},t.Panel=a}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Panel"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-panel",title:"panel",css:{width:"200px",height:"200px",minWidth:"200px",minHeight:"200px"},enableDrag:!0,enableSizable:!0};return Object.assign({},t,e)};e.PanelConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tree"),t=function(e){var t=this;t._root=e,t.element=e.element,t.eventManager=e.eventManager,t.addEventListener=e.addEventListener,t.removeEventListener=e.removeEventListener,e.addEventListener("SelectionChanged",function(e,n){t._selectionNode==e?n||(t._selectionNode=null):(t._selectionNode&&t._selectionNode.deselect(),t._selectionNode=e)})};t.prototype={getRoot:function(){return this._root},getChecked:function(){function e(o,i){var a=o.getCheckedState(),r=o.element.getAttribute("data-filter");switch(a){case"unchecked":break;case"checked":if(o==t)n="all";else{var s=Object.assign({},i);s[r]=o.id,n.push(s)}break;case"half":var l=o.getControls(),d=Object.assign({},i);o!=t&&(d[r]=o.id);for(var c=0,u=l.length;c<u;c++)e(l[c],d)}}var t=this._root,n=[];return e(t,{}),n},getSelection:function(){function e(t,n){var o=t.element.getAttribute("data-filter"),i=t.getParent();if(!i)return n;n[o]=t.id,e(i,n)}var t=this._selectionNode,n={};return!!t&&(e(t,n),n)},clear:function(e){var t=this.getRoot();!function t(n){n.setCheckedState(e),n.setIconState("default"),n.deselect();var o=n.getControls();if(o&&o.length>0)for(var i=0;i<o.length;i++)t(o[i])}(t)}},e.Tree=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Toolbar"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tree"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),i=function(t){e.Toolbar.call(this,t),this._opt=Object.assign({},t),t.hasCheckbox&&(this._checkedState=t.isChecked?"checked":"unchecked"),this._iconState=!0;var n=o.create("div","bf-tree-node bf-collapse");this._enabled=t.enabled,this._selection=t.selection,this._selectionState="unSelected",this.treeNode=n};n.Type.inheritPrototype(i,e.Toolbar),i.prototype.setData=function(e,t){var n=this,i=this._opt,a=this.treeNode;if(i.hasCheckbox){var r=i.isChecked?"bf-checked":"",s=o.create("span","bf-label "+r);s.innerHTML='<input type="checkbox" checked="'+i.isChecked+'"><span class="bf-checkbox"></span>',this.checkbox=s,a.appendChild(s),s.addEventListener("click",function(e){var t=s.getElementsByTagName("input")[0].checked,o=t?"unchecked":"checked";n.setCheckedState(!t),n.eventManager.fireEvent("CheckedChanged",o,n)})}var l=o.create("span","bf-tree-name");t=t||"未命名",l.textContent=t,n.setTitle(t),l.addEventListener("click",function(e){if(n._enabled)if(n._selection){var t=this.hasClass("bf-selected");t?n.deselect():n.select(),t=!t,n._selectionState=t?"selected":"unselected",n.eventManager.fireEvent("SelectionChanged",n,t)}else n.toggleExpansion()}),i.icon&&(this.icon=i.icon,a.appendChild(i.icon.element),this.icon.addEventListener("Change",function(e){n._iconState="default"==e,n.setChildrenIconState(e),n.eventManager.fireEvent("IconChanged",n,e)})),a.appendChild(l),this.element.appendChild(a),this.treeName=l,this.id=e,this.name=t},i.prototype.addChildNode=function(e){var t=this;if(this._controls.push(e),e._parent=this,!this.subTree){var n=o.create("span","bf-icon"),i=this.treeNode;n.addEventListener("click",function(){t.toggleExpansion()}),i.insertBefore(n,this.treeNode.children[0]),this.subTree=o.create("div","bf-sub-tree"),this.element.appendChild(this.subTree)}this.subTree.appendChild(e.element),e.addEventListener("CheckedChanged",function(e,n){n._opt.propagation&&t.setParentCheckedState(n),t.eventManager.fireEvent("CheckedChanged",e,n)}),e.addEventListener("SelectionChanged",function(e,n,o){t.eventManager.fireEvent("SelectionChanged",e,n,o)}),e.addEventListener("IconChanged",function(n,o){e._opt.propagation&&t.setParentIconState(e),t.eventManager.fireEvent("IconChanged",n,o)})},i.prototype.removeChildNode=function(e){var t=this._controls.getObjectByAttribute("id",e);this.subTree.removeChild(t.element),this._controls.removeObjectByAttribute("id",e)},i.prototype.getCheckedState=function(){return this._checkedState},i.prototype.getIconState=function(){return this._iconState},i.prototype.getSelectionState=function(){return this._selectionState},i.prototype.getParent=function(){return!!this._parent&&this._parent},i.prototype.setCheckedState=function(e){var t=this._opt;this._checkedState=e?"checked":"unchecked",t.hasCheckbox&&this.checkbox&&(this.checkbox.getElementsByTagName("input")[0].checked=e,this.checkbox.toggleClass("bf-checked",e),this.checkbox.toggleClass("bf-unchecked",!e),this.checkbox.removeClass("bf-half")),this.setChildrenCheckedState(e)},i.prototype.setIconState=function(e){this.icon&&(this.icon.setState(e),this.setChildrenIconState(e),this._iconState="default"==e)},i.prototype.setParentCheckedState=function(e){var t=this.getControls();if(t&&t.length>0){for(var n,o=0,i=t.length;o<i;o++){var a=t[o].getCheckedState();n?a!=n&&(n="half"):n=a}this._checkedState=n}switch(this._checkedState){case"checked":this.checkbox.getElementsByTagName("input")[0].checked=!0,this.checkbox.addClass("bf-checked"),this.checkbox.removeClass("bf-unchecked"),this.checkbox.removeClass("bf-half");break;case"unchecked":this.checkbox.getElementsByTagName("input")[0].checked=!1,this.checkbox.addClass("bf-unchecked"),this.checkbox.removeClass("bf-checked"),this.checkbox.removeClass("bf-half");break;case"half":this.checkbox.getElementsByTagName("input")[0].checked=!0,this.checkbox.addClass("bf-half"),this.checkbox.removeClass("bf-unchecked"),this.checkbox.removeClass("bf-checked")}},i.prototype.setChildrenCheckedState=function(e){var t=this.getControls(),n=t.length;if(t&&n>0)for(var o=0;o<n;o++)t[o].setCheckedState(e)},i.prototype.setParentIconState=function(e){var t=this.getControls();if(t&&t.length>0){for(var n=!1,o=0,i=t.length;o<i;o++){var a=t[o].getIconState();if(a){n=a;break}}this._iconState=n}n?this.icon.setState("default"):this.icon.setState("change")},i.prototype.setChildrenIconState=function(e){var t=this.getControls(),n=t.length;if(t&&n>0)for(var o=0;o<n;o++)t[o].setIconState(e)},i.prototype.expand=function(){var e=this;this.treeNode.removeClass("bf-collapse"),this.eventManager.fireEvent("Expand",e)},i.prototype.collapse=function(){var e=this;this.treeNode.addClass("bf-collapse"),this.eventManager.fireEvent("Collapse",e)},i.prototype.toggleExpansion=function(e){var t=this;this.treeNode.hasClass("bf-collapse")?t.expand():t.collapse()},i.prototype.select=function(){if(this._selection)return this.treeName.addClass("bf-selected")},i.prototype.deselect=function(){this.treeName&&this.treeName.removeClass("bf-selected")},i.prototype.disabled=function(){this._enabled=!1,this.treeName.addClass("bf-disabled")},i.prototype.enabled=function(){this._enabled=!0,this.treeName.removeClass("bf-disabled")},i.prototype.addNode=function(e){this.treeNode.appendChild(e)},i.prototype.removeNode=function(e){this.treeNode.appendChild(e)},i.prototype.setAttribute=function(e,t){this.treeNode.setAttribute(e,t)},t.TreeNode=i}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tree"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-tree",title:"tree",icon:null,hasCheckbox:!0,isChecked:!0,enabled:!0,selection:!0,propagation:!0};return Object.assign(t,e)};e.TreeNodeConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Select"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-select",options:["请选择"],prefix:"",suffix:"",default:null};return Object.assign({},t,e)};e.SelectConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Select"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),i=function(t){this._controls=t.options,e.Control.call(this,t);var n=this;n._opt=t;var i=o.create("span","bf-select-current");i.addEventListener("click",function(){i.toggleClass("bf-open")}),document.addEventListener("mousedown",function(e){e.target.closest(".bf-select")||i.removeClass("bf-open")}),n._currentElement=i,t.default?n.setCurrentOption(t.default):n.setCurrentOption(t.options[0].id);for(var a=o.create("ul","bf-select-list bf-scroll-bar"),r=n._controls,s=0,l=r.length;s<l;s++){var d=n.createElement(r[s]);a.appendChild(d)}n.element.appendChild(n._currentElement),n.element.appendChild(a),t.element&&t.element.appendChild(n.element)};n.Type.inheritPrototype(i,e.Control),i.prototype.setCurrentOption=function(e){if(!this.currentOption||e!=this.currentOption.id){var t=this.eventManager,n=this._controls,o=n.getObjectByAttribute("id",e);0!=o&&(this.currentOption=o,this._currentElement.innerText=""+this._opt.prefix+o.name+this._opt.suffix,t.fireEvent(Glodon.Bimface.UI.Control.ControlEvent.Change,o))}},i.prototype.getCurrentOption=function(){return this.currentOption},i.prototype.createElement=function(e){var t=this,n=o.create("li","bf-select-option");return n.innerText=e.name,n.setAttribute("id",e.id),n.addEventListener("click",function(){t.setCurrentOption(e.id),t._currentElement.removeClass("bf-open")}),n},t.Select=i}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tabs"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-select",options:[{id:"default",name:"请选择",className:"bf-tabs-option",title:"请选择"}],default:null};return Object.assign({},t,e)};e.TabsConfig=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tabs"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),i=function(t){this._controls=t.options,e.Control.call(this,t);var n=this,i=o.create("ul","bf-tabs-list");this.list=i;for(var a=n._controls,r=0,s=a.length;r<s;r++){var l=n.createElement(a[r]);i.appendChild(l)}t.default?n.setCurrentOption(t.default):n.setCurrentOption(t.options[0].id),n.element.appendChild(i),t.element&&t.element.appendChild(n.element)};n.Type.inheritPrototype(i,e.Control),i.prototype.setCurrentOption=function(e){for(var t=this.eventManager,n=this._controls,o=n.getObjectByAttribute("id",e),i=this.list.querySelectorAll("li"),a=0,r=i.length;a<r;a++)i[a].id==e?i[a].addClass("active"):i[a].removeClass("active");-1!=o&&(this.currentOption=o,t.fireEvent(Glodon.Bimface.UI.Control.ControlEvent.Change,o))},i.prototype.getCurrentOption=function(){return this.currentOption},i.prototype.createElement=function(e){var t=this,n=(this.eventManager,o.create("li","bf-tabs-option "+e.className));return n.innerText=e.name,n.setAttribute("id",e.id),n.setAttribute("title",e.name),n.addEventListener("click",function(){t.getCurrentOption().id!=e.id&&t.setCurrentOption(e.id)}),n},i.prototype.addOption=function(e){if(!this._controls.getObjectByAttribute("id",e.id)){this._controls.push(e);var t=this.createElement(e);this.list.appendChild(t)}},t.Tabs=i}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tips"),t=new Glodon.Bimface.UI.Control.ControlConfig,n=function(){var e={className:"bf-tips",element:null,html:"提示",timeOut:0};return Object.assign({},t,e)};e.TipsConfig=n}(),
function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Control"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.UI.Tips"),n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),i=function(t){e.Control.call(this,t);var n=this,i=this.element,a=o.create("div","bf-tips-container"),r=o.create("div","bf-close");a.innerHTML=t.html,i.appendChild(a),i.appendChild(r),r.addEventListener("click",function(){n.hide()}),this.container=a,this.timeOut=t.timeOut,this.show()};n.Type.inheritPrototype(i,e.Control),i.prototype.close=function(){this.element.remove()},i.prototype.hide=function(){this.element.style.display="none"},i.prototype.show=function(){var e=this;e.element.style.display="",e.timeOut&&(clearTimeout(e.counter),e.counter=setTimeout(function(){e.hide()},e.timeOut))},i.prototype.getHtml=function(e){this.container.innerHTML=e},i.prototype.setHtml=function(e){return this.container.innerHTML},t.Tips=i}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(){var e={Toolbars:["MainToolbar","ModelTree"],Buttons:["Home","RectangleSelect","Measure","Section","Walk","Map","Property","Setting","Information","FullScreen"]},t=Glodon.Bimface.Viewer.Viewer3DConfig();return Object.assign({},e,t)};e.WebApplication3DConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=Object.freeze({ViewAdded:"ViewAdded",ViewLoading:"ViewLoading",Rendered:"Rendered",PureRender:"PureRender",ComponentsSelectionChanged:"ComponentsSelectionChanged",ComponentsHoverChanged:"ComponentsHoverChanged",MouseClicked:"MouseClicked",MouseDragged:"MouseDragged",MouseDoubleClicked:"MouseDoubleClicked",ContextMenu:"ContextMenu",RectSelection:"RectSelection",Error:"Error",AddView:"AddView",RemoveView:"RemoveView",FamilyTypeChanged:"FamilyTypeChanged",MissingDrawingElement:"MissingDrawingElement",ToolbarHomeClick:"ToolbarHomeClick",DemandLoaded:"DemandLoaded",ButtonOnToolbarClicked:"ButtonOnToolbarClicked",AxisGridHover:"AxisGridHover",FloorExplosion:"FloorExplosion",Hover:"Hover",ViewChanged:"ViewChanged"});e.WebApplication3DEvent=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom")),n=Glodon.Bimface.Data.StatisticsDataManager.getInstance(),o=function(e){var o,i=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();if(i)o=t.create("div","bf-container");else{e.Toolbars=["MainToolbar","ModelTree"],e.Buttons=["Home","ViewButton","Measure","Section","Walk","MobileProperty"],e.enableViewHouse=!1,o=t.create("div","bf-container  bf-mobile ");var a=e.domElement.offsetWidth,r=e.domElement.offsetHeight;o.style.fontSize=90*Math.min(a,r,414)/750+"px"}var s=this,l=e;e.domElement.appendChild(o),l.domElement=o,this.getViewer=function(){return d},this.getEventManager=function(){return u},this.getToolbars=function(){return s.UI.getToolbars()},this.getToolbar=function(e){return"LeftToolbar"==e&&(e="ModelTree"),s.UI.getToolbar(e)},this.getPanel=function(e){return s.UI.getPanel(e)},this.getPlugin=function(e){return s.UI.getPlugin(e)},this.render=function(){this.getViewer().render()},this.addView=function(e,t,n){d.addView(e,t,n)},this.getAnnotationManager=function(){return s.getPlugin("Annotation")},this.destroy=function(){this.UI.destroy(),this.UI=null,d.destroy(),d=null,o.onclick=null,o.remove()},this.addEventListener=Glodon.Bimface.Viewer.Viewer3D.prototype.addEventListener,this.removeEventListener=Glodon.Bimface.Viewer.Viewer3D.prototype.removeEventListener;var d=new Glodon.Bimface.Viewer.Viewer3D(l),c=Glodon.Bimface.Viewer.Viewer3DEvent,u=d.getEventManager();d.addEventListener(c.ViewAdded,function(){s.UI.init();var e=d.getViewer(),t=e.getNumOfElements(),o=e.getNumOfTriangles(),i=void 0,a=d._data.modelType;i="singleMode"==a?"model":a;var r={eventId:"加载",loadModel:"normal",type:i,elements:t,triangles:o};n.send("Glodon.Bimface.Application.WebApplication3D","ViewAdded",r)}),d.addEventListener(c.ViewChanged,function(){s.UI&&s.UI.updateModelTree()}),d.addEventListener(c.AddView,function(t){if(1===t){var n=new Glodon.Bimface.Application.UI.UIConfig;n=Object.assign(n,e),n.element=o,n.viewer=d,s.UI=new Glodon.Bimface.Application.UI.UI(n)}}),d.addEventListener(c.RemoveView,function(e){0==e&&(s.UI.destroy(),s.UI=null)}),i&&(o.onclick=function(){var e=document.activeElement,t=document.getElementById("cloud-main-canvas");t&&e!=t&&"INPUT"!=e.tagName&&"TEXTAREA"!=e.tagName&&t.focus()})};e.WebApplication3D=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(){var e={Toolbars:["MainToolbar"],Buttons:["Home","Measure","Section","Explode","Setting","FullScreen"],EnableFamilyList:!0},t=Glodon.Bimface.Viewer.Viewer3DConfig();return t.enableExplosion=!0,Object.assign({},e,t)};e.WebApplicationRfaConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=Object.freeze({ViewAdded:"ViewAdded",ViewLoading:"ViewLoading",ComponentsSelectionChanged:"ComponentsSelectionChanged",ComponentsHoverChanged:"ComponentsHoverChanged",Error:"Error"});e.WebApplicationRfaEvent=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent,a=Glodon.Bimface.Viewer.Viewer3DEvent,r=new Glodon.Bimface.UI.Button.ButtonConfig;r.id="Home",r.title=BimfaceLanguage.bf_btn_home,r.className="bf-button gld-bf-home";var s=new Glodon.Bimface.UI.Button.Button(r);return s.addEventListener(i.Click,function(){var e=t.getControl("ViewButton");e&&e.recover();var i=t.getControl("Interactive");if(i&&i.hideDropDownList(),o){if(n.getViewHouseIsLoaded())n.getEventManager().fireEvent(a.ToolbarHomeClick);else{var r=n.getDefaultHomeview();n.setCameraStatus(r)}}else n.home()}),s};e.Home=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var a=Glodon.Bimface.Viewer.NavigationMode3D,r={OrbitPoint:a.PickWithRect,OrbitCamera:a.Fly},s=new Glodon.Bimface.UI.Button.ButtonConfig;s.id="OrbitButton",s.title="导航",s.inheritTitle=!0;var l=new Glodon.Bimface.UI.Button.ComboBox(s),d=new Glodon.Bimface.UI.Button.ButtonConfig;d.id="OrbitPoint",d.title="绕构件旋转",d.className="bf-button gld-bf-orbitpoint";var c=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(d),u=new Glodon.Bimface.UI.Button.ButtonConfig;u.id="OrbitCamera",u.title="绕相机旋转",u.className="bf-button gld-bf-orbitcamera";var p=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(u);return l.addControl(c),l.addControl(p),l.addEventListener(i.Change,function(e){t.getControl("Section").setCheckedState(!1),n.setNavigationMode(r[e.id])}),l};e.OrbitButton=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=(e.getRootElement(),n instanceof Glodon.Bimface.Viewer.Viewer3D),i=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="Home",a.title="Home",a.className="bf-button gld-bf-scene";var r=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(a),s=new Glodon.Bimface.UI.Button.ButtonConfig;s.id="ViewButton",s.title="视角",s.className="bf-combobox viewButton",s.inheritTitle=!0,s.home=r;var l=new Glodon.Bimface.UI.Button.TouchComboBox(s);l.element.addClass(BimfaceLanguage.name);var d={Top:"top",Bottom:"bottom",East:"right",South:"front",West:"left",North:"back"};for(var c in d){var u=d[c],p=new Glodon.Bimface.UI.Button.ButtonConfig;p.id=c,p.title=c,p.className="bf-button";var h=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(p);h.setHtml('<svg class="gld-bf-scene-inner"><use class="" xlink:href="#gld-bf-scene-'+u+'"></use></svg>'),l.addControl(h)}return l.addEventListener(i.Change,function(e){n.setView(e.id)}),document.querySelector(".bf-mobile").addEventListener("touchstart",function(e){if("canvas"==e.target.tagName.toLowerCase()){var t=document.querySelector(".gld-bf-view.bf-checked");t&&t.click()}}),l};e.ViewButton=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent,a=Glodon.Bimface.Viewer.Viewer3DEvent;if(!o)return void console.log("The API is not supported on this viewer.");var r=new Glodon.Bimface.UI.Button.ButtonConfig;r.id="RectangleSelect",r.title=BimfaceLanguage.bf_btn_zoom,r.className="bf-button gld-bf-zoomrect";var s=new Glodon.Bimface.UI.Button.ToggleButton(r),l=function(e){e.end&&s.setCheckedState(!1)};return s.addEventListener(i.StateChange,function(e){e?(n.enableZoomRect(!0),n.addEventListener(a.RectSelection,l)):(n.enableZoomRect(!1),n.removeEventListener(a.RectSelection,l))}),s};e.RectangleSelect=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=function(e,t,n,o){var i,a=this,r=Glodon.Bimface.Viewer.Viewer3DEvent,s=function(e){for(var t=[],n=0;n<e.length;n++){for(var o=e[n].name,i=e[n].parameters,a=[],r=0;r<i.length;r++)a=a.concat(i[r].items);t=t.concat([{group:o,items:a}])}return t},l=function(){p._tab&&"components"!=p._tab.getCurrentOption().id?p.setTips(BimfaceLanguage.bf_panel_props_matSel):p.setTips(BimfaceLanguage.bf_panel_props_propSel)},d=function(t){if(p.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),p.clear(),!t||1!=t.length)return l(),p.setData("");!p._tab||p._tab&&"components"==p._tab.getCurrentOption().id?(i=t[0],e.getComponentProperty(t[0],function(e){p.setTips(BimfaceLanguage.bf_panel_props_propSel),p.setData(e.properties)},function(e){l(),p.setData("")})):(!p._tab||p._tab&&"components"!=p._tab.getCurrentOption().id)&&(t?(i=t[0],e.getMaterialProperty(i,function(e){if(p.setTips(BimfaceLanguage.bf_panel_props_matSel),e&&e.length>0){var t=s(e);p.setData(t,!0)}else p.setData("")},function(){p.setTips(BimfaceLanguage.bf_panel_props_matSel),p.setData("")})):p.setData(""))},c=function(t){var n=e.getSelectedComponents();if(!n||1!=n.length)return"components"==t?p.setTips(BimfaceLanguage.bf_panel_props_propSel):p.setTips(BimfaceLanguage.bf_panel_props_matSel),p.setData("");"components"==t?n&&n.length>0?d([n[0]]):i="":(p.setData(""),e.getMaterialProperty(i,function(e){if(e&&e.length>0){var t=s(e);p.setData(t,!0)}else l(),p.setData("")},function(){l(),p.setData("")}))};if(p)return p.show(),e.addEventListener(r.ComponentsSelectionChanged,d),p;var u=new Glodon.Bimface.UI.Panel.PanelConfig;u.title=BimfaceLanguage.bf_btn_props,u.className="bf-panel property-panel",u.css=o?{left:0,top:0,width:"100%",height:"100%"}:{right:"10px",top:"10px",width:"300px",height:"416px"};var p=new Glodon.Bimface.UI.Panel.Panel(u);p.setTips(BimfaceLanguage.bf_panel_props_propSel),e.propertyPanel=p,p.addClass("property-panel"),p.addClass("bf-property-panel");var h=[{id:"components",name:BimfaceLanguage.bf_panel_props_props},{id:"material",name:BimfaceLanguage.bf_panel_props_mats}];if(!a._tab&&e._manifest.Features.HasMaterialProperty){var f=new Glodon.Bimface.UI.Tabs.TabsConfig;f.className="bf-property-tab",f.default="components",f.options=h;var m=new Glodon.Bimface.UI.Tabs.Tabs(f);m.addEventListener(Glodon.Bimface.UI.Control.ControlEvent.Change,function(e){c(e.id)}),p._tab=m,p.setContainerHeader(m.element)}return c("components"),e.addEventListener(r.SelectionChanged,d),p.addEventListener("Hide",function(){e.removeEventListener(r.SelectionChanged,d)}),p};e.PropertyPanel=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),i=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!i)return void console.log("The API is not supported on this viewer.");var s=new Glodon.Bimface.UI.Button.ButtonConfig;s.id="Property",s.title=BimfaceLanguage.bf_btn_props,s.className="bf-button gld-bf-properties";var l,d=new Glodon.Bimface.UI.Button.ToggleButton(s);return d.addEventListener(a.StateChange,function(i){i?(l=new Glodon.Bimface.Application.UI.Panel.PropertyPanel(n,o,t),l.addEventListener("Hide",function(){d.setCheckedState(!1)}),o.appendChild(l.element),l.bringToFront(),l.initPosition(),e.addPanel(l)):(l.close(),e.removePanel(l.id)),n.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:s.id,isChecked:i})}),d};e.Property=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),i=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent;if(!i)return void console.log("The API is not supported on this viewer.");var r=new Glodon.Bimface.UI.Button.ButtonConfig;r.id="MobileProperty",r.title="属性",r.className="bf-button gld-bf-properties";var s,l=new Glodon.Bimface.UI.Button.ToggleButton(r);return l.addEventListener(a.StateChange,function(){l.isChecked()?(s=new Glodon.Bimface.Application.UI.Panel.PropertyPanel(n,o,t,!0),s.addEventListener("Hide",function(){"none"!=s.element.style.display&&o.removeChild(s.element),l.setCheckedState(!1)}),o.appendChild(s.element),e.addPanel(s)):(o.removeChild(s.element),e.removePanel(s.id))}),l};e.MobileProperty=t}();var MeasureResultFormat=function e(){_classCallCheck(this,e)};MeasureResultFormat.formatDistance=function(e,t){if(void 0==e)return null;var n=t.precision,o=t.scale,i=t.unit,a=1;if("Centimeter"===i?a=10:"Meter"===i?a=1e3:"Kilometer"===i&&(a=1e6),e*=o,e/=a,e=parseInt(Math.round(e*Math.pow(10,n)))/Math.pow(10,n),0!=n){var r=e.toFixed(n).split(".");e=Number(r[0]).toLocaleString()+"."+r[1]}else e=e.toLocaleString();return e},MeasureResultFormat.formatArea=function(e,t){var n=t.precision,o=t.scale,i=t.unit,a=1;if("Centimeter"===i?a=100:"Meter"===i&&(a=1e6),e*=Math.pow(o,2),e/=a,e=parseInt(e*Math.pow(10,n))/Math.pow(10,n),0!=n){var r=e.toFixed(n).split(".");e=Number(r[0]).toLocaleString()+"."+r[1]}else e=e.toLocaleString();return e},MeasureResultFormat.getPostFix=function(e,t){if("None"===e)return"";var n={None:"",Kilometer:"km",Meter:"m",Centimeter:"cm",Millimeter:"mm"},o=n[e];return t?o+="²":o=" "+o,o},function(){var e,t,n=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),i=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),a=function(o,a){t=o._opt.viewer;var r,s=n.create("div","bf-tab-container"),l=n.create("div","bf-tab-body"),d=n.create("div","bf-tab-foot"),c=n.create("ul","bf-measure-tab"),u=n.create("div","bf-measure-tabface");u.innerHTML='<li class="bf-measure-tab-item" data-type="Distance">\n                            <i class="gld-bimface gld-bf-distance" ></i>\n                        </li>',c.innerHTML='<li class="bf-measure-tab-item bf-active" data-type="Distance">\n                  <i class="gld-bimface gld-bf-distance" title="'+BimfaceLanguage.bf_tip_measure_distance+'"></i>\n                </li>\n                <li class="bf-measure-tab-item" data-type="MinimumDistance">\n                  <i class="gld-bimface gld-bf-distance-min" title="'+BimfaceLanguage.bf_tip_measure_mindis+'"></i>\n                </li>\n                <li class="bf-measure-tab-item" data-type="Angle">\n                  <i class="gld-bimface gld-bf-angle" title="'+BimfaceLanguage.bf_tip_measure_angle+'"></i>\n                </li>\n                <li class="bf-measure-tab-item" data-type="Elevation">\n                  <i class="gld-bimface gld-bf-elevation" title="'+BimfaceLanguage.bf_tip_measure_elevation+'"></i>\n                </li>';for(var p=c.querySelectorAll(".bf-measure-tab-item"),h=0;h<p.length;h++)p[h].addEventListener("click",function(){for(var e=0;e<p.length;e++)p[e].removeClass("bf-active");var t=this.getAttribute("data-type");this.addClass("bf-active"),o.setMeasureType(t),w(t,{})});d.innerHTML='<div class="settingBtn">'+BimfaceLanguage.bf_panel_measure_setting+"<div>",d.addEventListener("click",function(){g()}),s.appendChild(c),s.appendChild(l),i&&s.appendChild(d);var f={Millimeter:"mm",Centimeter:"cm",Meter:"m",Kilometer:"km"},m=function(e){if(e){r.setTitleContent(BimfaceLanguage.bf_btn_measure);var t=r.element.querySelector(".bf-close");t.style.display="block",v.style.display="none",s.style.display="block"}else{var t=r.element.querySelector(".bf-close");t.style.display="none",r.setTitleContent(BimfaceLanguage.bf_panel_measure_setting),v.style.display="block",s.style.display="none"}},g=function(e){m(!1);var t,n=o.getPrecision(),i=o.getLengthUnits();t='<ul class="bf-measure-setting">\n                  <li class="bf-measure-lengthUnits">\n                    <span >'+BimfaceLanguage.bf_panel_measure_units+" :</span>\n                    <div class = 'unit'></div>\n                  </li>\n                  <li class=\"bf-measure-prompt\">"+BimfaceLanguage.bf_panel_measure_unitsTip+'</li>\n                  <li class="bf-measure-precision">\n                    <span >'+BimfaceLanguage.bf_panel_measure_precision+" :</span>\n                    <div class = 'unit'></div>\n                  </li>\n\n                </ul>",b.innerHTML=t;var a={type:"ComboBox",id:"units",inheritTitle:!0,className:"bf-combobox",options:{},handles:{Change:function(e){}}},r=new Glodon.Bimface.Application.Button(a);for(var s in f){var l=f[s],d={type:"ComboBoxOptionButton",title:l,id:s,className:"bf-button",html:'<span class="bf-button-name">'+l+"</span>"};r.addControl(new Glodon.Bimface.Application.Button(d))}r.setSelectedControlById(i),b.querySelector(".bf-measure-lengthUnits .unit").appendChild(r.element),r.element.onclick=function(){u.element.removeClass("bf-expand")};var c={type:"ComboBox",id:"units",inheritTitle:!0,className:"bf-combobox",options:{},handles:{Change:function(e){}}},u=new Glodon.Bimface.Application.Button(c),p={0:"0",1:"0.0",2:"0.00",3:"0.000"};for(var s in p){var l=p[s],d={type:"ComboBoxOptionButton",title:l,id:s.toString(),className:"bf-button",html:'<span class="bf-button-name">'+l+"</span>"};u.addControl(new Glodon.Bimface.Application.Button(d))}u.setSelectedControlById(n),b.querySelector(".bf-measure-precision .unit").appendChild(u.element),u.element.onclick=function(){r.element.removeClass("bf-expand")},y.innerHTML="<div class=\"bf-measure-btns\">\n                                    <span class= 'save'>"+BimfaceLanguage.bf_panel_measure_save+" </span> <span class= cancel>"+BimfaceLanguage.bf_general_cancel+"</span>\n                               </div>",y.querySelector(".save").onclick=function(){var e=u.getCurrentControl().id,t=r.getCurrentControl().id;o.setPrecision(e),o.setLengthUnits(t),m(!0),w(o.type,{}),o.getEventManager().fireEvent("SettingPanelSaved")},y.querySelector(".cancel").onclick=function(){m(!0)}},v=n.create("div","bf-setting-container"),b=n.create("div","bf-setting-body"),y=n.create("div","bf-setting-foot");v.appendChild(b),v.appendChild(y);var w=function(e,t){var n,i=o.getLengthUnits();switch(i="None"!=i&&"<span class='units'>"+f[i]+"</span>"||"",e){case Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance:var a=void 0!==t.distance?C(t.distance):"--",r=void 0!==t.distanceX?C(t.distanceX):"--",s=void 0!==t.distanceY?C(t.distanceY):"--",d=void 0!==t.distanceZ?C(t.distanceZ):"--";n='<ul class="bf-measure-info">\n                  <li class="bf-measure-distance">'+BimfaceLanguage.bf_panel_measure_distance+'\n                    <span class="bf-measure-value">'+a+"</span>"+i+'\n                    <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span>\n                  </li>\n                  <li class="bf-measure-x">X： '+r+'</li>\n                  <li class="bf-measure-y">Y： '+s+'</li>\n                  <li class="bf-measure-z">Z： '+d+"</li>\n                </ul>",l.innerHTML=n,l.querySelector(".gld-bf-reset-box").addEventListener("click",function(){o.reset()});break;case Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Angle:n='<ul class="bf-measure-info">\n                    <li class="bf-measure-distance">'+BimfaceLanguage.bf_panel_measure_angle+'\n                      <span class="bf-measure-value">'+(t.angle?t.angle:"--")+"</span> "+BimfaceLanguage.bf_panel_measure_degree+'\n                      <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span></li>\n                  </ul>',l.innerHTML=n,l.querySelector(".gld-bf-reset-box").addEventListener("click",function(){o.reset()});break;case Glodon.Bimface.Plugins.Measure.MeasureTypeOption.MinimumDistance:var a=void 0!==t.distance?C(t.distance):"--";n='<ul class="bf-measure-info">\n                    <li class="bf-measure-distance">'+BimfaceLanguage.bf_panel_measure_mindis+'\n                      <span class="bf-measure-value">'+a+"</span>"+i+"\n                    </li>\n                  </ul>",l.innerHTML=n;break;case Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Elevation:var c=void 0!=t.points?Math.round(t.points[0].z)/1e3:"--";0==c?c="±0.000":"--"!=c&&(c=c.toFixed(3)),n='<ul class="bf-measure-info">\n                    <li class="bf-measure-distance">'+BimfaceLanguage.bf_panel_measure_elevation+'\n                    <span class="bf-measure-value">'+c+'</span> m\n                    <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span>\n                    </li>\n                  </ul>',l.innerHTML=n,l.querySelector(".gld-bf-reset-box").addEventListener("click",function(){o.reset()})}},C=function(e){return MeasureResultFormat.formatDistance(e,o.getMeasureParams())},M=new Glodon.Bimface.UI.Panel.PanelConfig;if(M.title=BimfaceLanguage.bf_btn_measure,M.id="MeaurePanel",M.css=i?{right:"10px",bottom:"270px",width:"200px",height:"240px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"2.4em"},M.enableSizable=!1,M.className="bf-panel bf-measurement-panel",o.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.Measuring,function(e){w(e.type,{})}),o.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.Measured,function(e){w(e.type,e),e.type==Glodon.Bimface.Plugins.Measure.MeasureTypeOption.MinimumDistance&&(o.measureItem.setMinDistanceLine(e),o.measureItem.draw())}),o.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.MeasureSelected,function(e){var t=c.querySelectorAll(".bf-measure-tab-item"),n=!0,i=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){r.value.removeClass("bf-active")}}catch(e){i=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}var l=!0,d=!1,u=void 0;try{for(var p,h=t[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var f=p.value;if(f.getAttribute("data-type")===e.type){f.addClass("bf-active");break}}}catch(e){d=!0,u=e}finally{try{!l&&h.return&&h.return()}finally{if(d)throw u}}o.setMeasureType(e.type),w(e.type,e)}),o.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.MeasureUnselected,function(e){w(o.type,{})}),o.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.Reset,function(){w(o.getMeasureType(),{})}),r=new Glodon.Bimface.UI.Panel.Panel(M),t=o._opt.viewer,r.container.appendChild(s),r.container.appendChild(v),!i){var k=a.offsetWidth,B=a.offsetHeight;r.element.style.fontSize=100*Math.min(k,B,414)/750+"px",r.element.addClass("measure-panel");var T=r.element.querySelector(".bf-measure-tab"),L=r.element.querySelector(".bf-close");L.innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>",T.measure=o,e=T.querySelectorAll(".bf-measure-tab-item");var x;T.id="measureTabs",T.addEventListener("click",function(t){T.hasClass("tab-open")?(T.removeClass("tab-open"),r.element.removeClass("tab-open")):(T.addClass("tab-open"),r.element.addClass("tab-open")),t.target.hasClass("gld-bf-distance")?(x=e[0],r.element.removeClass("miniStyle"),w(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance,{}),T.measure.setMeasureType(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance)):t.target.hasClass("gld-bf-angle")?(x=e[2],r.element.addClass("miniStyle"),w(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Angle,{}),T.measure.setMeasureType(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Angle)):(x=e[3],r.element.addClass("miniStyle"),w(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Elevation,{}),T.measure.setMeasureType(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Elevation)),T.querySelector(".bf-active").removeClass("bf-active"),x.addClass("bf-active"),u.innerHTML="",u.appendChild(x.cloneNode(!0)),t.preventDefault(),t.stopPropagation()},!0),u.addEventListener("click",function(e){T.hasClass("tab-open")?(T.removeClass("tab-open"),r.element.removeClass("tab-open")):(T.addClass("tab-open"),r.element.addClass("tab-open"))}),L.addEventListener("click",function(e){L.click()},!0),r.element.appendChild(T),r.element.appendChild(u)}return"rfaView"==t._data.renderType&&c.addClass("bf-measure-tab-rfa"),w(o.getMeasureType(),{}),r};o.MeasurePanel=a}();var hideSectionPanel=function(e){var t=e.getToolbar("MainToolbar");if(t){var n=t.getControl("Section");if(n){var o=n.getToolbar();if(o){o.getControl("SectionBox").setCheckedState(!1);o.getControl("SectionPlane").setCheckedState(!1)}else n.setCheckedState(!1)}}},clearSection=function(e){hideSectionPanel(e),clearSectionPlane(e),clearSectionBox(e)},clearSectionPlane=function(e){var t=e.getPlugin("SectionPlane");t&&(t.exit(),e.removePlugin("SectionPlane"))},clearSectionBox=function(e){var t=e.getPlugin("SectionBox");t&&(t.exit(),e.removePlugin("SectionBox"))},resetSection=function(e){var t=e.getPlugin("SectionBox"),n=e.getPlugin("SectionPlane");t&&t.restore(),n&&(n.restoreRotation(),n.setProgress(0))},updateSection=function(e,t){var n=e.getViewer(),o=e.getPlugin("SectionBox");if(!o){var i=e.getToolbar("MainToolbar");if(i){var a=i.getControl("Section");if(a){a.getToolbar().getControl("SectionBox").setCheckedState(!0),o=e.getPlugin("SectionBox")}}}o.setBox(t),n.zoomToBoundingBox(t)},getSectionState=function(e){var t=e.getPlugin("SectionBox"),n=e.getPlugin("SectionPlane"),o=e.getToolbar("MainToolbar"),i={enable:!1,button:null};(t||n)&&(i.enable=!0);var a=o.getControl("Section");if(a){var r=a.getToolbar(),s=r.getControl("SectionBox"),l=r.getControl("SectionPlane");s.isChecked()&&(i.button=s),l.isChecked()&&(i.button=l)}return i};!function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop()),n=(Glodon.Web.Lang.Utility.ClientHelper.getIsIphone(),function(e,n){var o=e.getViewer(),i=e.getRootElement(),a=o instanceof Glodon.Bimface.Viewer.Viewer3D,r=Glodon.Bimface.UI.Control.ControlEvent,s=Glodon.Bimface.Viewer.Viewer3DEvent;if(!a)return void console.log("The API is not supported on this viewer.");var l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="Measure",l.title=BimfaceLanguage.bf_btn_measure,l.className="bf-button gld-bf-measure";var d,c=new Glodon.Bimface.UI.Button.ToggleButton(l),u=new Glodon.Bimface.Plugins.Measure.MeasureConfig;u.viewer=o;var p;return c.addEventListener(r.StateChange,function(a){if(a){t||clearSection(e);var r=n.getControl("Explode");r&&r.setCheckedState(!1),p=e.getPlugin("Measure"),p||(p=new Glodon.Bimface.Plugins.Measure.Measure(u),p.id="Measure",e.addPlugin(p)),p.switchOn(),d=new Glodon.Bimface.Application.UI.Panel.MeasurePanel(p,i),d.addEventListener("Hide",function(){c.setCheckedState(!1)}),i.appendChild(d.element),d.bringToFront(),d.initPosition(),e.addPanel(d)}else e.removePanel(d.id),d.close(),d=null,p.switchOff();o.getEventManager().fireEvent(s.ButtonOnToolbarClicked,{id:l.id,isChecked:a})}),c});e.Measure=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=(Glodon.Bimface.Viewer.Viewer3D,Glodon.Bimface.UI.Control.ControlEvent),i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="Annotation",i.title="批注",i.className="bf-button gld-bf-notes";var a=new Glodon.Bimface.UI.Button.Button(i),r=new Glodon.Bimface.Plugins.Annotation.AnnotationToolbarConfig;r.viewer=e.getViewer();var s=self._annotation=new Glodon.Bimface.Plugins.Annotation.AnnotationToolbar(r),l=Glodon.Bimface.Plugins.Annotation.AnnotationToolbarEvent;return a._annotationManager=s.getAnnotationManager(),a._annotationToolbar=s,e._plugins.push(a),a.addEventListener(o.Click,function(){t.hide();var e=t.getControl("Measure");e&&e.setCheckedState(!1),s.show(),s.addEventListener(l.Saved,function(){t.show()}),s.addEventListener(l.Cancelled,function(){t.show()})}),a};e.Annotation=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),n=function(t){var n=t.getViewer(),o=(t.getRootElement(),new Glodon.Bimface.UI.Panel.PanelConfig);o.title=BimfaceLanguage.bf_panel_section_box,o.id="SectionBoxPanel",o.css={right:"10px",bottom:"60px",width:"200px",height:"200px"},o.className="bf-panel bf-section-panel bf-sectionBox-panel",o.enableSizable=!1;var i,a=new Glodon.Bimface.UI.Panel.Panel(o),r=t.getPlugin("SectionBox");return function(){var o=Glodon.Bimface.Application.UI.Toolbar.SectionToolbarConfig(),s=Glodon.Bimface.Application.UI.Toolbar.Toolbar(o,t),l=s.getControl("SectionReset");i=s.getControl("SectionBoxVisiable"),i.setCheckedState(!1),l.addEventListener(Glodon.Bimface.UI.Control.ControlEvent.Click,function(){i.setCheckedState(!1)});var d=e.create("div","bf-range-container"),c='<ul class="bf-range-list">\n        <li>\n          <span class="bf-range-name">'+BimfaceLanguage.bf_panel_section_X+'</span>\n          <div class="bf-section-range" id="sectionX"></div>\n        </li>\n        <li>\n          <span class="bf-range-name">'+BimfaceLanguage.bf_panel_section_Y+'</span>\n          <div class="bf-section-range" id="sectionY"></div>\n        </li>\n        <li>\n          <span class="bf-range-name">'+BimfaceLanguage.bf_panel_section_Z+'</span>\n          <div class="bf-section-range" id="sectionZ"></div>\n        </li>\n      </ul>';if(d.innerHTML=c,a.addControl(s),a.container.appendChild(d),r&&r._sectionBox)r.showBox(),r.update();else{var u=new Glodon.Bimface.Plugins.Section.SectionBoxConfig;u.viewer=n,u.id="SectionBox",r=new Glodon.Bimface.Plugins.Section.SectionBox(u),t.removePlugin("SectionBox"),t.addPlugin(r)}n.render()}(),a.hideBox=function(){i&&i.setCheckedState(!0)},a};t.SectionBoxPanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),n=function(e,n){var o=void 0;if(t){var i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="Section",i.title=BimfaceLanguage.bf_btn_section,i.className="bf-button bf-toolbar-button gld-bf-sectionbox",o=new Glodon.Bimface.UI.Button.Button(i);var a=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;a.id="SectionSub",a.title=BimfaceLanguage.bf_btn_section,a.className="bf-sub-toolbar",
a.buttons=["SectionPlane","SectionBox"];var n=new Glodon.Bimface.Application.UI.Toolbar.Toolbar(a,e);o.addToolbar(n)}else{var r=e.getViewer(),s=e.getRootElement(),l=r instanceof Glodon.Bimface.Viewer.Viewer3D,d=Glodon.Bimface.UI.Control.ControlEvent;if(!l)return void console.log("The API is not supported on this viewer.");var c=function(){var t=e.getPlugin("SectionBox");if(t){var n=t.getProgress("x");rangeX.setProgress({from:n[0],to:n[1]});var o=t.getProgress("y");rangeY.setProgress({from:o[0],to:o[1]});var i=t.getProgress("z");rangeZ.setProgress({from:i[0],to:i[1]})}},u=new Glodon.Bimface.UI.Button.ButtonConfig;u.id="Section",u.title=BimfaceLanguage.bf_btn_section,u.className="bf-button gld-bf-sectionbox",o=new Glodon.Bimface.UI.Button.ToggleButton(u);var p;o.addEventListener(d.StateChange,function(t){if(t){var i=n.getControl("Measure");i&&i.setCheckedState(!1);var a=n.getControl("Explode");a&&a.setCheckedState(!1),p=new Glodon.Bimface.Application.UI.Panel.SectionPlanePanel(e),p.addEventListener("Hide",function(){o.setCheckedState(!1)}),s.appendChild(p.element),p.bringToFront(),r.addEventListener("Rendered",c),e.addPanel(p)}else clearSection(e),p&&(e.removePanel(p.id),p.close(),r.render())})}return o};e.Section=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n,o,i,a=e.getViewer(),r=e.getRootElement(),s=a instanceof Glodon.Bimface.Viewer.Viewer3D,l=Glodon.Bimface.UI.Control.ControlEvent,d=Glodon.Bimface.Viewer.Viewer3DEvent;if(!s)return void console.log("The API is not supported on this viewer.");var c=function(t,n){var o=e.getPlugin("SectionBox");if(o){var i=[n.from,n.to];o.setProgress(t,i),a.render()}},u=function(){var e=a._sectionBox;if(e){var t=e.getProgress("x");n.setProgress({from:t[0],to:t[1]});var r=e.getProgress("y");o.setProgress({from:r[0],to:r[1]});var s=e.getProgress("z");i.setProgress({from:s[0],to:s[1]})}},p=new Glodon.Bimface.UI.Button.ButtonConfig;p.id="SectionBox",p.title=BimfaceLanguage.bf_panel_section_box,p.className="bf-button gld-bf-sectionbox1";var h,f=new Glodon.Bimface.UI.Button.ToggleButton(p);return f.addEventListener(l.StateChange,function(s){if(s){var l=e.getToolbar("MainToolbar"),m=l.getControl("Measure");m&&m.setCheckedState(!1);var g=l.getControl("Explode");g&&g.setCheckedState(!1);var v=t.getControl("SectionPlane");v&&v.setCheckedState(!1);var b=e.getPlugin("SectionPlane");b&&e.removePlugin(b.id),h=new Glodon.Bimface.Application.UI.Panel.SectionBoxPanel(e),h.addEventListener("Hide",function(){f.setCheckedState(!1)}),r.appendChild(h.element),h.initPosition(),n=new Glodon.Web.Lang.Utility.Dom.multipleRange({element:h.element.querySelector("#sectionX"),min:0,max:100,defaultColor:"#555555",currentColor:"#999999",change:function(e){c("x",e)}}),o=new Glodon.Web.Lang.Utility.Dom.multipleRange({element:h.element.querySelector("#sectionY"),min:0,max:100,defaultColor:"#555555",currentColor:"#999999",change:function(e){c("y",e)}}),i=new Glodon.Web.Lang.Utility.Dom.multipleRange({element:h.element.querySelector("#sectionZ"),min:0,max:100,defaultColor:"#555555",currentColor:"#999999",change:function(e){c("z",e)}}),u(),a.addEventListener("Rendered",u),e.addPanel(h),a.render()}else{var y=e.getPlugin("SectionBox");y&&y.hideBox(),h&&(e.removePanel(h.id),h.close(),a.render())}a.getEventManager().fireEvent(d.ButtonOnToolbarClicked,{id:p.id,isChecked:s})}),f};e.SectionBox=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),n=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),o=function(e){return e=parseFloat(e),e<0?360+e:e},i=function(t){var i=t.getViewer(),a=t.getRootElement(),r=new Glodon.Bimface.UI.Panel.PanelConfig;r.title=BimfaceLanguage.bf_panel_section_plane,r.id="SectionPlanePanel",r.css=n?{right:"10px",bottom:"170px",width:"200px",height:"90px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"1.02em"},r.className="bf-panel bf-section-panel bf-sectionPlane-panel",r.enableSizable=!1;var s=new Glodon.Bimface.UI.Panel.Panel(r),l=t.getPlugin("SectionPlane");if(l){var d=l.getProgress();l.setDirection(l.getDirection()),l.setPlane(l.getPlane()),l.setProgress(d)}return function(){var r=e.create("div","bf-section-plane-head"),d=new Glodon.Bimface.UI.Select.SelectConfig;if(l&&(d.default=l._plane),d.className="bf-select bf-select-axial",n){var c=new Glodon.Bimface.UI.Tabs.TabsConfig,u=e.create("div","bf-section-select");c.className="bf-tabs";var p=[{id:"X",name:"X"},{id:"Y",name:"Y"},{id:"Z",name:"Z"}];c.options=p,c.element=u;var h=new Glodon.Bimface.UI.Tabs.Tabs(c),f=new Glodon.Bimface.Application.UI.Button.SectionPlaneVisiable(t);s.toggleButton=f;var m=new Glodon.Bimface.Application.UI.Button.SectionDirection(t);h.addEventListener("Change",function(e){l&&(l.setPlane(e.id),l.coordinateSystem.update(),i.render())}),r.appendChild(u)}else{d.options=[{id:"X",name:"X"},{id:"Y",name:"Y"},{id:"Z",name:"Z"}];var g=new Glodon.Bimface.UI.Select.Select(d);s.select=g;var f=new Glodon.Bimface.Application.UI.Button.SectionPlaneVisiable(t);s.toggleButton=f;var m=new Glodon.Bimface.Application.UI.Button.SectionDirection(t);g.addEventListener("Change",function(e){l&&(l.setPlane(e.id),l.coordinateSystem.update(),i.render())}),r.appendChild(g.element)}var v=e.create("div","bf-section-range"),b=new Glodon.Web.Lang.Utility.Dom.range({element:v,min:0,max:100,cur:50,defaultColor:"#666",currentColor:"#666",isShowProgress:!1,input:function(e){l&&(l.setProgress(e),i.render())},change:function(e){l&&(l.setProgress(e),i.render())}}),y=e.create("div","bf-section-range");y.innerHTML='<i class="bf-range-icon gld-bf-rotate-vertical"></i>';var w=e.create("div","bf-section-range");w.innerHTML='<i class="bf-range-icon gld-bf-rotate-horizontal"></i>';var C=new Glodon.Web.Lang.Utility.Dom.range({element:y,min:-179,max:180,cur:0,defaultColor:"#666",currentColor:"#666",isShowProgress:!1,input:function(e){l&&(l.setRotateAngle(void 0,o(e)),i.render())},change:function(e){l&&(l.setRotateAngle(void 0,o(e)),i.render())}}),M=new Glodon.Web.Lang.Utility.Dom.range({element:w,min:-179,max:180,cur:0,defaultColor:"#666",currentColor:"#666",isShowProgress:!1,input:function(e){l&&(l.setRotateAngle(o(e),void 0),i.render())},change:function(e){l&&(l.setRotateAngle(o(e),void 0),i.render())}});if(i.addEventListener("Rendered",function(){var e=i._sectionPlane;if(e){var t=e.getProgress();0==n&&b.setProgress(t);var o=e.getRotateAngle();C.setProgress(o.angleB>180?o.angleB-360:o.angleB),M.setProgress(o.angleA>180?o.angleA-360:o.angleA)}}),s.container.appendChild(r),0==n&&s.container.appendChild(v),n?r.appendChild(f.element):r.appendChild(m.element),l&&n&&l._sectionTool)l.showPlane();else{var k=new Glodon.Bimface.Plugins.Section.SectionPlaneConfig;k.viewer=i,k.id="SectionPlane",l=new Glodon.Bimface.Plugins.Section.SectionPlane(k),t.removePlugin("SectionPlane"),t.addPlugin(l)}if(!n){var B=a.offsetWidth,T=a.offsetHeight;l.hidePlane(),s.element.style.fontSize=100*Math.min(T,B,414)/750+"px",s.element.addClass("section-panel");var L=s.element.querySelector(".bf-section-plane-head");s.element.querySelector(".bf-close").innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>",s.element.appendChild(L)}i.render()}(),s};t.SectionPlanePanel=i}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=(Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),function(e,t){var n=e.getViewer(),o=e.getRootElement(),i=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!i)return void console.log("The API is not supported on this viewer.");var s=new Glodon.Bimface.UI.Button.ButtonConfig;s.id="SectionPlane",s.title=BimfaceLanguage.bf_panel_section_plane,s.className="bf-button gld-bf-section-axial";var l,d=new Glodon.Bimface.UI.Button.ToggleButton(s);return d.addEventListener(a.StateChange,function(i){if(n.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:s.id,isChecked:d.isChecked()}),i){var a=e.getToolbar("MainToolbar"),c=a.getControl("Measure");c&&c.setCheckedState(!1);var u=a.getControl("Explode");u&&u.setCheckedState(!1);var p=t.getControl("SectionBox");p&&p.setCheckedState(!1);var h=e.getPlugin("SectionBox");h&&e.removePlugin(h.id);var f=n.getDomElement(),m=e.getPlugin("SectionPlaneForAreaTree");m&&(m.exit(),e.removePlugin("SectionPlaneForAreaTree")),l=new Glodon.Bimface.Application.UI.Panel.SectionPlanePanel(e),l.addEventListener("Hide",function(){d.setCheckedState(!1),f.removeAttribute("style")}),f.style.cursor="default",o.appendChild(l.element),l.bringToFront(),e.addPanel(l),l.initPosition(),n.render()}else{var g=e.getPlugin("SectionPlane");g&&g.hidePlane(),l&&(e.removePanel(l.id),l.close(),n.render())}}),d});e.SectionPlane=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="SectionBoxVisiable",a.title=BimfaceLanguage.bf_tip_section_hide,a.className="bf-button gld-bf-box-hide";var r=new Glodon.Bimface.UI.Button.ToggleButton(a);return r.addEventListener(i.StateChange,function(t){var o=e.getPlugin("SectionBox");o&&(t?o.hideBox():o.showBox()),n.render()}),r};e.SectionBoxVisiable=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="SectionPlaneVisiable",a.title=BimfaceLanguage.bf_tip_section_hide,a.className="bf-button gld-bf-hide-slice";var r=new Glodon.Bimface.UI.Button.ToggleButton(a);return r.addEventListener(i.StateChange,function(t){var o=e.getPlugin("SectionPlane");o&&(t?o.hidePlane():o.showPlane()),n.render()}),r};e.SectionPlaneVisiable=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="SectionRotate",a.title="旋转",a.className="bf-button gld-bf-rotate-box";var r=new Glodon.Bimface.UI.Button.ToggleButton(a);return r.addEventListener(i.Click,function(){var e=Glodon.Bimface.Viewer.SectionBoxMode;r.isChecked()?n.setSectionBoxMode(e.Rotate):n.setSectionBoxMode(e.Default)}),r};e.SectionRotate=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="SectionReset",a.title=BimfaceLanguage.bf_tip_section_resetBox,a.className="bf-button gld-bf-reset-box";var r=new Glodon.Bimface.UI.Button.Button(a);return r.addEventListener(i.Click,function(){var t=e.getPlugin("SectionBox");t&&t.reset(),n.render()}),r};e.SectionReset=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=function(e){var t=new Glodon.Bimface.UI.Panel.PanelConfig;t.title=BimfaceLanguage.bf_btn_info,t.css={left:"50%",top:"50%",width:"300px",height:"210px",transform:"translate(-50%,-50%)"},t.enableSizable=!1,t.className="bf-panel bf-basicInfo-panel";var n=e.getInformation(),o=new Glodon.Bimface.UI.Panel.Panel(t),i='<div class="bf-info">\n                  <ul class="bf-info-list">\n                    <li>'+BimfaceLanguage.bf_panel_info_component+'<span class="bf-info-value">'+n.elements+"</span></li>\n                    <li>"+BimfaceLanguage.bf_panel_info_mesh+'<span class="bf-info-value">'+n.triangles+"</span></li>\n                    <li>"+BimfaceLanguage.bf_panel_info_vertex+'<span class="bf-info-value">'+3*n.triangles+'</span></li>\n                  </ul>\n                  <div class="bf-info-power">Powered by <a target="_blank" href="http://bimface.com/">bimface.com</a></div>\n                </div>';return o.setHtml(i),o};e.InformationPanel=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),i=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!i)return void console.log("The API is not supported on this viewer.");var s=new Glodon.Bimface.UI.Button.ButtonConfig;s.id="Information",s.title=BimfaceLanguage.bf_btn_info,s.className="bf-button gld-bf-information";var l,d=new Glodon.Bimface.UI.Button.ToggleButton(s);return d.addEventListener(a.StateChange,function(t){t?l?l.show():(l=new Glodon.Bimface.Application.UI.Panel.InformationPanel(n),l.addEventListener("Hide",function(){d.setCheckedState(!1)}),o.appendChild(l.element),l.bringToFront(),e.addPanel(l)):l.hide(),n.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:s.id,isChecked:t})}),d};e.Information=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=(Glodon.Bimface.Viewer.Viewer3D,Glodon.Bimface.UI.Control.ControlEvent),i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="FullScreen",i.title=BimfaceLanguage.bf_btn_fullScreen,i.className="bf-button gld-bf-maximize";var a=new Glodon.Bimface.UI.Button.ChangeButton(i);return a.addEventListener(o.Click,function(){var e=this.hasClass("gld-bf-maximize");n.enableFullScreen(e)}),Glodon.Web.Lang.Utility.FullScreen.onFullScreenChanged(function(){var e=a.getTitle();a.toggleClassName("gld-bf-maximize"),a.toggleClassName("gld-bf-minimize"),e==BimfaceLanguage.bf_btn_fullScreen_exit?a.setTitle(BimfaceLanguage.bf_btn_fullScreen):a.setTitle(BimfaceLanguage.bf_btn_fullScreen_exit)}),a};e.FullScreen=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=(Glodon.Bimface.Viewer.Viewer3D,Glodon.Bimface.UI.Control.ControlEvent),i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id="FamilyList",i.title="FamilyList",i.className="bf-combobox bf-family";var a=new Glodon.Bimface.UI.Button.ComboBox(i);return n.getFamilyTypes(function(e){for(var t=0,n=e.length;t<n;t++){var o=e[t],i=new Glodon.Bimface.UI.Button.ButtonConfig;i.id=o.id,i.title=o.name;var r=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(i);r.setHtml('<span class="bf-button-name">'+o.name+"</span>"),a.addControl(r)}}),a.addEventListener(o.Change,function(e){n.showFamilyTypeById(e.id),n.render()}),a};e.FamilyList=t}();var FAMILY_INSTANCE,createTreeNode=function e(t,n,o){if(t){var i=new Glodon.Bimface.UI.Tree.TreeNodeConfig,a=new Glodon.Bimface.UI.Button.ButtonConfig;a.className="bf-tree-icon",a.defaultClass="gld-bf-untransparent",a.changeClass="gld-bf-transparent",a.title="半透明",i.selection=!0;var r=new Glodon.Bimface.UI.Button.ChangeButton(a);switch(t.type){case"floor":t.type="levelName",i.isChecked=!0,i.hasCheckbox=!0,i.icon=r;break;case"category":t.type="categoryId",i.isChecked=!0,i.hasCheckbox=!0,i.icon=r;break;case"specialty":i.selection=!1;case"root":i.isChecked=!0,i.hasCheckbox=!0,i.selection=!1,i.icon=r;break;case"family":case"familyType":i.isChecked=!0,i.hasCheckbox=!0,i.icon=r;break;default:i.isChecked=!1,i.hasCheckbox=!1}t.elementIds&&(t.type="fileId",i.isChecked=!0,i.hasCheckbox=!0,i.icon=r),t.type||(i.isChecked=!0,i.hasCheckbox=!0,i.icon=r);var s=new Glodon.Bimface.UI.Tree.TreeNode(i);if(s.filter=t.type,s.modelId=o,"familyType"==t.type&&"old"!=n&&(s.fileId=t.items[0].fileId),"categoryId"==t.type||"root"==t.type||"model"==t.type)s.setData(t.id,t.name);else if(t.elementIds||t.type)t.fileId?s.setData(t.fileId,t.fileId):"specialty"==t.type&&""==t.name?s.setData("","未设专业"):"未设专业"==t.name?s.setData("",t.name):s.setData(t.name,t.name);else{var l=FAMILY_INSTANCE+"["+t+"]";s.setData(t,l)}if(t.items&&t.items.length>0)if("family"==t.type&&(FAMILY_INSTANCE=t.name),"old"!=n&&"familyType"!=t.type)for(var d=0,c=t.items.length;d<c;d++)s.addChildNode(e(t.items[d],n,o));else if("familyType"==t.type&&t.items[0].elementIds&&t.items[0].elementIds.length>0)for(var d=0,c=t.items[0].elementIds.length;d<c;d++){var u=t.items[0].elementIds[d];s.addChildNode(e(u,n,o))}else for(var d=0,c=t.items.length;d<c;d++)s.addChildNode(e(t.items[d],n,o));return s}},createComponentsRvtTree=function(e,t,n){var o=n.data,i=n.modelType,a=n.treeType,r="all"!==e.id?e.id:void 0;if(o&&0!=o.length)if("singleModel"==i){var s;s="old"==a?o:o[0].items;for(var l=0,d=s.length;l<d;l++)if(1==d&&"floor"==s[l].type)for(var c=s[0].items,u=0;u<c.length;u++){var p=createTreeNode(c[u],a,r);p.addEventListener("SelectionChanged",function(e,n){selectComponent(t,e,n)}),e.addChildNode(p)}else{var p=createTreeNode(s[l],a,r);p.addEventListener("SelectionChanged",function(e,n){selectComponent(t,e,n)}),e.addChildNode(p)}}else{var s;s="old"==a?o.items:o;for(var l=0,d=s.length;l<d;l++){var p=createTreeNode(s[l],a,r);p.addEventListener("SelectionChanged",function(e,n){selectComponent(t,e,n)}),e.addChildNode(p)}}},getConditions=function(e){if(e.filter){var t={};t[e.filter]=e.id,function e(n){if(n._parent){var o=n._parent;"root"!=o.filter&&(t[o.filter]=o.id,e(o))}}(e)}else{var n=e._parent.fileId;t=n?n+"."+e.id:e.id}return[t]},selectComponent=function(e,t,n){var o,i=getConditions(t);o=t.filter?e.getViewer().getFilter().getMatchIds(i):i,n?(e.clearSelectedComponents(),e.addSelectedComponentsById(o),e.zoomToSelectedComponents(1)):e.clearSelectedComponents(),e.render()},createTreeNode$1=function e(t,n){if(t){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig,i=new Glodon.Bimface.UI.Button.ButtonConfig;i.className="bf-tree-icon",i.defaultClass="gld-bf-untransparent",i.changeClass="gld-bf-transparent",i.title="半透明",o.selection=!1;var a=new Glodon.Bimface.UI.Button.ChangeButton(i);switch(t.type){case"floor":t.type="levelName",o.isChecked=!0,o.hasCheckbox=!0,o.icon=a;break;case"category":t.type="categoryId",o.isChecked=!0,o.hasCheckbox=!0,o.icon=a;break;case"specialty":case"root":o.isChecked=!0,o.hasCheckbox=!0,o.icon=a;break;case"family":case"familyType":default:o.isChecked=!1,o.hasCheckbox=!1}var r=new Glodon.Bimface.UI.Tree.TreeNode(o);if(r.filter=t.type,r.modelId=n,"categoryId"==t.type||"root"==t.type?r.setData(t.id,t.name):"未设专业"==t.name?r.setData("",t.name):r.setData(t.name,t.name),t.items&&t.items.length>0)for(var s=0,l=t.items.length;s<l;s++)r.addChildNode(e(t.items[s],n));return r}},createComponentsTree=function(e,t,n){var o=n.data,i=n.modelType,a="all"!==e.id?e.id:void 0;if(o&&0!=o.length)if("singleModel"==i)for(var r=0,s=o.length;r<s;r++)if(1==s&&"floor"==o[r].type)for(var l=o[r].items,d=0;d<l.length;d++)e.addChildNode(createTreeNode$1(l[d],a));else if("specialty"==o[0].type&&"floor"==o[0].items[0].type&&1==o[0].items.length)for(var l=o[0].items[0].items,d=0;d<l.length;d++)e.addChildNode(createTreeNode$1(l[d],a));else e.addChildNode(createTreeNode$1(o[r],a));else for(var r=0,s=o.items.length;r<s;r++)e.addChildNode(createTreeNode$1(o.items[r],a))},createTreeNode$2=function(e){if(e){var t=new Glodon.Bimface.UI.Tree.TreeNodeConfig,n=new Glodon.Bimface.UI.Button.ButtonConfig;n.className="bf-tree-icon",n.defaultClass="gld-bf-untransparent",n.changeClass="gld-bf-transparent",n.title="半透明",t.selection=!0;var o=new Glodon.Bimface.UI.Button.ChangeButton(n);switch(e.type){case"root":case"modelId":t.isChecked=!0,t.hasCheckbox=!0,t.selection=!1,t.icon=o;break;default:t.isChecked=!1,t.hasCheckbox=!1}var i=new Glodon.Bimface.UI.Tree.TreeNode(t);return i.filter=e.type,i.setData(e.id,e.name),i}},getTreeCondition=function(e){return"rvt-integrate"==e||"rvt-translate"==e||"igms-integrate"==e||"igms-translate"==e},createCombinedTree=function(e,t){if(t&&0!=t.length){var n=createTreeNode$2({type:"root",id:"all",name:BimfaceLanguage.bf_panel_modelTree_allComponents});n.expand(),n.setAttribute("id","treeRootNode");var o=new Glodon.Bimface.UI.Tree.Tree(n);if(1===t.length){var i=t[0].meta,a=getTreeCondition(i.workerType);a?createComponentsRvtTree(n,e,t[0]):createComponentsTree(n,e,t[0])}else if(t.length>1)for(var r=0;r<t.length;r++){var i=t[r].meta,s=createTreeNode$2({type:"modelId",id:i.modelId,name:i.name});if(n.addChildNode(s),t[r].data){var a=getTreeCondition(i.workerType);a?createComponentsRvtTree(s,e,t[r]):createComponentsTree(s,e,t[r])}}return o.addEventListener("CheckedChanged",getTreeNodeCheckedChangedHandler(e)),o.addEventListener("IconChanged",getTreeNodeIconChangedHandler(e)),o}},getTreeNodeCheckedChangedHandler=function(e){return function(t,n){var o=getConditions$1(n),i=n.modelId,a=n.getCheckedState(),r=n.id;"unchecked"==a?"all"==r?e.hideAllComponents():n.filter?"modelId"===n.filter?e.hideAllComponents(r):e.hideComponentsByObjectData(o):e.hideComponentsById(o,i):"checked"==a&&("all"==r?e.showAllComponents():n.filter?"modelId"===n.filter?e.showAllComponents(void 0,void 0,r):e.showComponentsByObjectData(o):e.showComponentsById(o,i)),e.render()}},getTreeNodeIconChangedHandler=function(e){return function(t,n){var o=getConditions$1(t),i=t.modelId,a=t.id;"change"==n?"all"==a?e.transparentAllComponents():t.filter?"modelId"===t.filter?e.transparentAllComponents(a):e.transparentComponentsByObjectData(o):e.transparentComponentsById(o,i):"all"==a?e.opaqueAllComponents():t.filter?"modelId"===t.filter?e.opaqueAllComponents(a):e.opaqueComponentsByObjectData(o):e.opaqueComponentsById(o,i),e.render()}},getConditions$1=function(e){if(e.filter){var t={};t[e.filter]=e.id,function e(n){if(n._parent){var o=n._parent;"root"!=o.filter&&(t[o.filter]=o.id,e(o))}}(e)}else{var n=e._parent.fileId;t=n?n+"."+e.id:e.id}return[t]},getCombinedComponentsTree=function(e,t){var n=[];for(var o in e._modelData){var i=e._modelData[o].modelId,a=e._modelData[o];if(e._manifestMap[o].Features.HasComponentStructure){e.getModelTree(i,function(o){return function(i,a,r){if(n.push({data:i,modelType:a,treeType:r,meta:o}),n.length===e._modelNum&&"[object Function]"===Object.prototype.toString.call(t)){var s=createCombinedTree(e,n);t(s)}}}(a))}else if(n.push({meta:a}),n.length===e._modelNum&&"[object Function]"===Object.prototype.toString.call(t)){var r=createCombinedTree(e,n);t(r)}}},showAreaProperty=function(e,t,n,o){"area"==n?e.getAreaProperty(o,function(e){e&&e.properties?t.setData(e.properties):t.setData({})}):e.getRoomProperty(o,function(e){e&&e.properties?t.setData(e.properties):t.setData({})})},tips={property:"请选择一个构件，以查看对应属性",material:"暂无对应材质属性",drawing:"暂无对应图纸",area:"暂无对应空间",file:"暂无对应文件",links:"暂无对应文件",component:"暂无对应构件信息",loading:"加载中...",empty:"暂无对应数据",notFined:"找不到对应的三维构件"};!function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),n=function(e){var n=(e.getViewer(),Glodon.Bimface.Viewer.Viewer3DEvent,new Glodon.Bimface.UI.Panel.PanelConfig);n.title=BimfaceLanguage.bf_tip_props_rooms,n.className="bf-panel area-panel",n.id="AreaPropertyPanel",n.css=t?{right:"10px",top:"10px",width:"300px",height:"416px"}:{left:"0",top:"0",width:"100%",height:"100%"};var o=new Glodon.Bimface.UI.Panel.Panel(n);return o.setTips(tips.area),e.areaPanel=o,o};e.AreaPanel=n}();var zoomToArea=function(e,t,n,o){var i=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),a=e.getViewer();e._objectTypes[t.id]=t.type,i||o||e.getPanel("ModelTree").hide();var r=e.getPanel("AreaPropertyPanel");if(n){r&&showAreaProperty(a,r,t.type,t.id);var s=t.elevation,l=t.height,d=t.maxPt,c=t.minPt,u={min:c,max:{x:d.x,y:d.y,z:d.z+l}},p=s+1600+10,h=t.boundary,f=CLOUD.ExtrudeBodyManager.getInstance(a.getViewer()).getNode(t.id);h&&(a.hideAllRooms(),f?a.showRoomsById([t.id]):a.createRoom(h,1600,t.id)),a.setSelectedComponentsById([t.id]);var m=a.getCameraAnimation();a.setCameraAnimation(!1),a.setView(Glodon.Bimface.Viewer.ViewOption.Top),a.zoomToBoundingBox(u),a.setCameraAnimation(m);var g=e.getPlugin("SectionPlane"),v=g||makeSectionPlane(a);!1===g&&e.addPlugin(v);var b=e.getPanel("SectionPlanePanel"),y=b&&b.toggleButton;y&&y.setCheckedState(!0);var w=b&&b.select;w&&w.setCurrentOption("Z");var C=e.getPanel("SectionBoxPanel");C&&C.hide();var M=a.getViewer().getBoundingBoxWorld(),k=a.getViewer().getScene().getExpandScalar(),B=(new THREE.Box3).setFromCenterAndSize(M.getCenter(),M.getSize().multiplyScalar(k)),T=B.min.z,L=B.max.z,x=100-(p-T)/(L-T)*100;v.setPlane("Z"),v.setDirection("Forward"),v.setProgress(x),v.hidePlane(),CLOUD.GlobalData.ClippingCaps=!0,a.render()}else r&&r.clear(),a.hideAllRooms(),a.clearIsolation(),i||clearSection(e),a.render()},makeSectionPlane=function(e){var t=new Glodon.Bimface.Plugins.Section.SectionPlaneConfig;return t.viewer=e,t.id="SectionPlane",t.plane=Glodon.Bimface.Plugins.Section.SectionPlanePlane.Z,t.direction=Glodon.Bimface.Plugins.Section.SectionPlaneDirection.Forward,t.exitSectionBox=!1,new Glodon.Bimface.Plugins.Section.SectionPlane(t)},createTreeNode$3=function e(t,n,o,i,a){var r=t.getViewer(),s=t.getRootElement();if(n){var l=new Glodon.Bimface.UI.Tree.TreeNodeConfig;l.isChecked=!1,l.hasCheckbox=!1,l.selection=!1,l.className="bf-tree bf-tree-area","area"!=o&&"room"!=o||(l.selection=!0);var d=new Glodon.Bimface.UI.Tree.TreeNode(l);if(d.type=o,d.setData(n.id,n.name),"area"==o||"room"==o){d.elevation=i,d.height=a,d.boundary=n.boundary,d.maxPt=n.maxPt,d.minPt=n.minPt;var c=new Glodon.Bimface.UI.Button.ButtonConfig;c.className="bf-property-icon",c.title=BimfaceLanguage.bf_tip_props_rooms;var u=new Glodon.Bimface.UI.Button.Button(c);d.addNode(u.element),u.addEventListener("Click",function(){var e=t.getPanel("AreaPropertyPanel");e||(e=new Glodon.Bimface.Application.UI.Panel.AreaPanel(t),e.addEventListener("Close",function(){t.removePanel(e.id)}),e.addEventListener("Hide",function(){e.close()}),showAreaProperty(r,e,d.type,d.id),s.appendChild(e.element),e.initPosition(),t.addPanel(e))})}var p,h,i,a;if("areas"==o&&n.areas&&n.areas.length>0&&(p=n.areas,h="area",i=n.elevation,a=n.height),"rooms"==o&&n.rooms&&n.rooms.length>0&&(p=n.rooms,h="room",i=n.elevation,a=n.height),p)for(var f=0;f<p.length;f++){var m=e(t,p[f],h,i,a);m.addEventListener("SelectionChanged",function(e,n,o){zoomToArea(t,e,n,o)}),d.addChildNode(m)}return"rooms"!=o&&"areas"!=o||p||d.disabled(),d}},createTree=function(e,t,n,o){e.getViewer();if(t&&0!=t.length){var i=new Glodon.Bimface.UI.Tree.TreeNodeConfig;i.isChecked=!1,i.hasCheckbox=!1,i.selection=!1,i.className="bf-tree bf-tree-empty";var a=new Glodon.Bimface.UI.Tree.TreeNode(i);a.expand();var r=new Glodon.Bimface.UI.Tree.Tree(a);return createSubTree(e,t,a,n,o,!0),r}},createCombinedTree$1=function(e,t){var n=new Glodon.Bimface.UI.Tree.TreeNodeConfig;n.isChecked=!1,n.hasCheckbox=!1,n.selection=!1,n.className="bf-tree bf-tree-empty";var o=new Glodon.Bimface.UI.Tree.TreeNode(n);o.expand();for(var i=new Glodon.Bimface.UI.Tree.Tree(o),a=0;a<t.length;a++){var r=t[a].data,n=new Glodon.Bimface.UI.Tree.TreeNodeConfig;n.isChecked=!1,n.hasCheckbox=!1,n.selection=!1,n.className="bf-tree";var s=new Glodon.Bimface.UI.Tree.TreeNode(n);s.setData(t[a].meta.modelId,t[a].meta.name),s.type="model",o.addChildNode(s),r?(s.expand(),createSubTree(e,r,s,t[a].HasArea,t[a].HasRoom,!1)):s.disabled()}return i},createSubTree=function(e,t,n,o,i,a){var r=new Glodon.Bimface.UI.Tree.TreeNodeConfig;r.isChecked=!1,r.hasCheckbox=!1,r.selection=!1,r.className="bf-tree bf-tree-empty";var s=new Glodon.Bimface.UI.Tree.TreeNode(r);s.setData("room",BimfaceLanguage.bf_panel_modelTree_rooms2),a&&s.expand();var l=new Glodon.Bimface.UI.Tree.TreeNode(r);l.setData("area",BimfaceLanguage.bf_panel_modelTree_areas),a&&l.expand();for(var d=!1,c=!1,u=0,p=t.length;u<p;u++)t[u].rooms&&t[u].rooms.length>0&&(s.addChildNode(createTreeNode$3(e,t[u],"rooms")),d=!0),t[u].areas&&t[u].areas.length>0&&(l.addChildNode(createTreeNode$3(e,t[u],"areas")),c=!0);i&&d&&n.addChildNode(s),o&&c&&n.addChildNode(l)},getAreaTree=function(e,t){var n=e.getViewer();if(1===n._modelNum)n.getAreas(function(o){if(o&&o.length>0){var i=n._manifest.Features.HasArea,a=n._manifest.Features.HasRoom,r=createTree(e,o,i,a);t&&t(r)}else t&&t()});else if(n._modelNum>1){var o=[],i=function(){if(o.length===n._modelNum&&"[object Function]"===Object.prototype.toString.call(t)){var i=createCombinedTree$1(e,o);t(i)}};for(var a in n._modelData){var r=n._modelData[a],s=n._manifestMap[r.viewToken],l=s.Features.HasArea,d=s.Features.HasRoom;if(l||d){n.getAreas(r.modelId,function(e,t,n){return function(a){o.push({data:a,meta:e,HasArea:t,HasRoom:n}),i()}}(r,l,d),function(e){return function(t){o.push({error:t,meta:e}),i()}}(r))}else o.push({meta:r}),i()}}},createTreeNode$4=function(e){if(e){var t=new Glodon.Bimface.UI.Tree.TreeNodeConfig;t.isChecked=!0,t.hasCheckbox=!0,t.selection=!1;var n=new Glodon.Bimface.UI.Button.ButtonConfig;n.className="bf-tree-icon",n.defaultClass="gld-bf-untransparent",n.changeClass="gld-bf-transparent",n.title="半透明";var o=new Glodon.Bimface.UI.Button.ChangeButton(n);t.icon=o;var i=new Glodon.Bimface.UI.Tree.TreeNode(t);return i.filter=e.type,i.setData(""+e.fileId,e.fileName),i.linkedId=e.linkedBy,i.databagId=e.databagId,i}},createTree$1=function(e,t){if(t&&0!=t.length){var n=createTreeNode$4({type:"root",fileId:"all",fileName:BimfaceLanguage.bf_panel_modelTree_allFiles});n.expand();var o=new Glodon.Bimface.UI.Tree.Tree(n);if(1===e._modelNum){t=Glodon.Web.Lang.Utility.ClientHelper.sortByName(t,"fileName");for(var i=0,a=t.length;i<a;i++)t[i].type="fileId",n.addChildNode(createTreeNode$4(t[i]))}else if(e._modelNum>1)for(var i=0,a=t.length;i<a;i++)if("integrateModel"===t[i].modelType){var r=createTreeNode$4({type:t[i].modelType,fileId:t[i].modelId,fileName:t[i].modelName});r.expand(),n.addChildNode(r);for(var s=Glodon.Web.Lang.Utility.ClientHelper.sortByName(t[i].fileList,"fileName"),l=0;l<s.length;l++)s[l].type="fileId",r.addChildNode(createTreeNode$4(s[l]))}else t[i].type=t[i].modelType,n.addChildNode(createTreeNode$4(t[i]));return o.addEventListener("CheckedChanged",function(t,n){var o=n.filter,i=n.id,a=n.getCheckedState();if("root"===o)"unchecked"==a?e.hideAllComponents():e.showAllComponents();else if("integrateModel"===o||"singleModel"===o)"unchecked"==a?e.hideAllComponents(i):e.showAllComponents(void 0,void 0,i);else{var r="all"!==n._parent.id?n._parent.id:void 0,s=n.linkedId,l=[{sceneId:n.databagId+"."+i}];r&&(l[0].modelId=r);for(var d=[],c=0;c<s.length;c++){var u={};u[o]=s[c],r&&(u.modelId=r),d.push(u)}"unchecked"==a?(e.hideComponentsByObjectData(d),e.hideComponentsByObjectData(l)):(e.showComponentsByObjectData(d),e.showComponentsByObjectData(l))}e.render()}),o.addEventListener("IconChanged",function(t,n){var o=t.filter,i=t.id;if("root"===o)"change"==n?e.transparentAllComponents():e.opaqueAllComponents();else if("integrateModel"===o||"singleModel"===o)"change"==n?e.transparentAllComponents(i):e.opaqueAllComponents(i);else{for(var a="all"!==t._parent.id?t._parent.id:void 0,r=t.linkedId,s=[],l=0;l<r.length;l++){var d={};d[o]=r[l],a&&(d.modelId=a),s.push(d)}"change"==n?e.transparentComponentsByObjectData(s):e.opaqueComponentsByObjectData(s)}e.render()}),o}},getFileTree=function(e,t){e.getFiles(function(n){var o=createTree$1(e,n);t&&t(o)})},createTreeNode$5=function e(t,n){if(t){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!0,o.selection=!1,o.propagation=!1,o.hasCheckbox=!0;var i=new Glodon.Bimface.UI.Button.ButtonConfig;i.className="bf-tree-icon",
i.defaultClass="gld-bf-untransparent",i.changeClass="gld-bf-transparent",i.title="半透明";var a=new Glodon.Bimface.UI.Button.ChangeButton(i);o.icon=a;var r=new Glodon.Bimface.UI.Tree.TreeNode(o);if(r.filter="fileId",r.setData(""+t.fileId,t.name),r.linked=[t.linkPathHash],r.databagId=t.databagId,r.modelId=n,t.links&&t.links.length>0)for(var s=0,l=t.links.length;s<l;s++){var d=e(t.links[s],n);r.linked=r.linked.concat(d.linked),r.addChildNode(e(t.links[s],n))}return r}},createModelNode=function(e){var t=new Glodon.Bimface.UI.Tree.TreeNodeConfig;t.isChecked=!0,t.selection=!1,t.propagation=!1,t.hasCheckbox=!0;var n=new Glodon.Bimface.UI.Button.ButtonConfig;n.className="bf-tree-icon",n.defaultClass="gld-bf-untransparent",n.changeClass="gld-bf-transparent",n.title="半透明";var o=new Glodon.Bimface.UI.Button.ChangeButton(n);t.icon=o;var i=new Glodon.Bimface.UI.Tree.TreeNode(t);if(i.setData(e.meta.modelId,e.meta.name),i.filter="integrateModel",i.expand(),e.data&&e.data.length>0)for(var a=0,r=e.data.length;a<r;a++)i.addChildNode(createTreeNode$5(e.data[a],e.meta.modelId));return i},createTree$2=function(e,t,n){if(t&&0!=t.length){var o=createTreeNode$5({type:"root",fileId:"all",name:BimfaceLanguage.bf_panel_modelTree_allFiles});o.expand();var i=new Glodon.Bimface.UI.Tree.Tree(o);if(1===e._modelNum)for(var a=0,r=t.length;a<r;a++)o.addChildNode(createTreeNode$5(t[a]));else if(e._modelNum>1)for(var a=0;a<t.length;a++)o.addChildNode(createModelNode(t[a]));return i.addEventListener("CheckedChanged",function(t,n){var o=n.filter,i=n.id,a=n.getCheckedState();if("all"==i)"unchecked"==a?e.hideAllComponents():e.showAllComponents();else if("integrateModel"===o)"unchecked"==a?e.hideAllComponents(i):e.showAllComponents(void 0,void 0,i);else{for(var r=n.linked,s=[],l=0;l<r.length;l++){var d={};d[o]=r[l]||n.id,n.modelId&&(d.modelId=n.modelId),s.push(d)}"unchecked"==a?e.hideComponentsByObjectData(s):e.showComponentsByObjectData(s)}e.render()}),i.addEventListener("IconChanged",function(t,n){var o=t.filter,i=t.id;if("change"==n)if("all"==i)e.transparentAllComponents();else if("integrateModel"===o)e.transparentAllComponents(i);else{for(var a=t.linked,r=[],s=0;s<a.length;s++){var l={};l[o]=a[s]||t.id,t.modelId&&(l.modelId=t.modelId),r.push(l)}e.transparentComponentsByObjectData(r)}else if("all"==i)e.opaqueAllComponents();else if("integrateModel"===o)e.opaqueAllComponents(i);else{for(var a=t.linked,r=[],s=0;s<a.length;s++){var l={};l[o]=a[s]||t.id,t.modelId&&(l.modelId=t.modelId),r.push(l)}e.opaqueComponentsByObjectData(r)}e.render()}),i}},getLinkedTree=function(e,t){if(1===e._modelNum)e.getLinkGraph(function(n){var o=createTree$2(e,n);t&&t(o)});else if(e._modelNum>1){var n=[],o=function(){if(n.length===e._modelNum&&"[object Function]"===Object.prototype.toString.call(t)){var o=createTree$2(e,n);t(o)}};for(var i in e._modelData){var a=e._modelData[i],r=e._manifestMap[a.viewToken];if(r.Features.HasLinkRelation){var s=function(e){return function(t){n.push({data:t,meta:e}),o()}};e.getLinkGraph(a.modelId,s(a))}else if("integrateModel"===a.modelType){var s=function(e){return function(t){for(var i=0;i<t.length;i++)if(t[i].modelId&&t[i].modelId.toString()===e.modelId.toString()){t[i].fileList.forEach(function(e){return e.name=e.fileName}),n.push({data:t[i].fileList,meta:e}),o();break}}};e.getFiles(s(a))}else n.push({meta:a}),o()}}},createTreeNode$6=function(e,t,n,o){if(e){var i=new Glodon.Bimface.UI.Tree.TreeNodeConfig;i.isChecked=!1,i.hasCheckbox=!1,i.selection=!0;var a=new Glodon.Bimface.UI.Tree.TreeNode(i);return a.viewToken=t,a.isIntegrateModel=n,n&&(a.fileId=o),a.setData(e.id,e.name),a}},createFileNode=function(e,t,n){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!1,o.hasCheckbox=!1,o.selection=!1;var i=new Glodon.Bimface.UI.Tree.TreeNode(o);if(i.setData(e.fileId,e.fileName),e.drawingSheets&&e.drawingSheets.length>0)for(var a=0;a<e.drawingSheets.length;a++)i.addChildNode(createTreeNode$6(e.drawingSheets[a].viewInfo,t,n,e.fileId));else i.disabled();return i},createModelNode$1=function(e){var t=new Glodon.Bimface.UI.Tree.TreeNodeConfig;t.isChecked=!1,t.hasCheckbox=!1,t.selection=!1;var n=new Glodon.Bimface.UI.Tree.TreeNode(t);if(n.setData(e.modelId,e.modelName),e.fileList&&e.fileList.length>0)for(var o=0;o<e.fileList.length;o++)n.addChildNode(createFileNode(e.fileList[o],e.viewToken,!0));return n.expand(),n},createRootNode=function(){var e=new Glodon.Bimface.UI.Tree.TreeNodeConfig;return e.isChecked=!1,e.hasCheckbox=!1,e.selection=!1,e.className="bf-tree bf-tree-empty",new Glodon.Bimface.UI.Tree.TreeNode(e)},createTree$3=function(e,t,n,o){if(t&&0!=t.length){for(var i=createRootNode(),a=new Glodon.Bimface.UI.Tree.Tree(i),r=0,s=t.length;r<s;r++){var l="integrateModel"===e._data.modelType?createFileNode(t[r],t[r].viewToken,!0):createTreeNode$6(t[r].viewInfo,e._data.viewToken);i.addChildNode(l)}return a}},createCombinedTree$2=function(e,t){if(t&&0!=t.length){for(var n=createRootNode(),o=new Glodon.Bimface.UI.Tree.Tree(n),i=0;i<t.length;i++)"integrateModel"===t[i].modelType?n.addChildNode(createModelNode$1(t[i])):n.addChildNode(createFileNode(t[i],t[i].viewToken,!1));return o}},getDrawingTree=function(e,t){1===e._modelNum&&"integrateModel"!==e._data.modelType?e.getAllDrawingsheets(function(n){if((n=n.drawingList||n)&&n.length>0){n=Glodon.Web.Lang.Utility.ClientHelper.sortByName(n,"viewInfo.name");var o=createTree$3(e,n);t&&t(o)}else t&&t()}):1===e._modelNum&&"integrateModel"===e._data.modelType?e.getFiles(function(n){var o=0,i=0;n.forEach(function(a){var r=a.fileId.toString();o++,e.getDrawingsheets(r,function(r){if(i++,r=r.drawingList||r,r&&(r=Glodon.Web.Lang.Utility.ClientHelper.sortByName(r,"viewInfo.name"),a.drawingSheets=r),i==o){var s=createTree$3(e,n);t&&t(s)}})})}):e._modelNum>1&&e.getFiles(function(n){var o=0,i=0;n.forEach(function(a){if("singleModel"===a.modelType){var r=a.fileId.toString();e._manifestMap[a.viewToken].Features.HasDrawing&&(o++,e.getDrawingsheets(r,function(r){if(i++,r=r.drawingList||r,r&&(r=Glodon.Web.Lang.Utility.ClientHelper.sortByName(r,"viewInfo.name"),a.drawingSheets=r),i==o){var s=createCombinedTree$2(e,n);t&&t(s)}},r))}else"integrateModel"===a.modelType&&a.fileList.forEach(function(r){var s=r.fileId.toString();e._manifestMap[a.viewToken].Features.HasDrawing&&(o++,e.getDrawingsheets(s,function(a){if(i++,a=a.drawingList||a,a&&(a=Glodon.Web.Lang.Utility.ClientHelper.sortByName(a,"viewInfo.name"),r.drawingSheets=a),i==o){var s=createCombinedTree$2(e,n);t&&t(s)}},a.modelId))})})})},selectComponent$1=function(e,t,n,o){var i=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),a=e.getViewer();i||o||e.getPanel("ModelTree").hide(),n?(a.clearSelectedComponents(),a.addSelectedComponentsById(t.selectData,t.modelId),a.zoomToSelectedComponents(),a.render()):(a.clearSelectedComponents(),i||clearSection(e),a.render())},createTreeNode$7=function e(t,n,o,i){if(n){var a=new Glodon.Bimface.UI.Tree.TreeNodeConfig;a.isChecked=!1,a.hasCheckbox=!1,a.selection=!1,a.className="bf-tree","assembly"!=o&&"group"!=o&&"instances"!=o||(a.selection=!0);var r=new Glodon.Bimface.UI.Tree.TreeNode(a);if(r.type=o,r.modelId=i,"instances"==o)r.setData(n.id,n.id),r.selectData=n.elements;else if(r.setData(n.id,n.name),n.instances){var s=[];n.instances.forEach(function(e){s.push.apply(s,e.elements)}),r.selectData=s}var l,d,c,u;if(n.types&&n.types.length>0&&(l=n.types),d="assemblys"==o?"assembly":"group",n.instances&&n.instances.length>0&&(c=n.instances,u="instances"),l)for(var p=0;p<l.length;p++){var h=e(t,l[p],d,i);h.addEventListener("SelectionChanged",function(e,n,o){selectComponent$1(t,e,n,o)}),r.addChildNode(h)}if(c)for(var p=0;p<c.length;p++){var f=e(t,c[p],u,i);f.addEventListener("SelectionChanged",function(e,n,o){selectComponent$1(t,e,n,o)}),r.addChildNode(f)}return"groups"!=o&&"assemblys"!=o||l||r.disabled(),"group"!=o&&"assembly"!=o||c||r.disabled(),r}},createTree$4=function(e,t,n){e.getViewer();if(t&&0!=t.length){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!1,o.hasCheckbox=!1,o.selection=!1,o.className="bf-tree bf-tree-empty";var i=new Glodon.Bimface.UI.Tree.TreeNode(o);i.expand();var a=new Glodon.Bimface.UI.Tree.Tree(i);return createSubTree$1(e,t,i,!0),a}},createCombinedTree$3=function(e,t){var n=new Glodon.Bimface.UI.Tree.TreeNodeConfig;n.isChecked=!1,n.hasCheckbox=!1,n.selection=!1,n.className="bf-tree bf-tree-empty";var o=new Glodon.Bimface.UI.Tree.TreeNode(n);o.expand();for(var i=new Glodon.Bimface.UI.Tree.Tree(o),a=0;a<t.length;a++){var r=t[a].data,n=new Glodon.Bimface.UI.Tree.TreeNodeConfig;n.isChecked=!1,n.hasCheckbox=!1,n.selection=!1,n.className="bf-tree";var s=new Glodon.Bimface.UI.Tree.TreeNode(n);s.setData(t[a].meta.modelId,t[a].meta.name),s.type="model",o.addChildNode(s),r&&0!=r.length?(s.expand(),createSubTree$1(e,r,s,!1,t[a].meta.modelId)):s.disabled()}return i},createSubTree$1=function(e,t,n,o,i){var a=new Glodon.Bimface.UI.Tree.TreeNodeConfig;if(a.isChecked=!1,a.hasCheckbox=!1,a.selection=!1,a.className="bf-tree",t.groups&&t.groups.length>0){var r=new Glodon.Bimface.UI.Tree.TreeNode(a);r.setData("group",BimfaceLanguage.bf_panel_modelTree_group),o&&r.expand(),n.addChildNode(r);for(var s=0,l=t.groups.length;s<l;s++)r.addChildNode(createTreeNode$7(e,t.groups[s],"groups",i))}if(t.assemblies&&t.assemblies.length>0){var d=new Glodon.Bimface.UI.Tree.TreeNode(a);d.setData("assembly",BimfaceLanguage.bf_panel_modelTree_assembly),o&&d.expand(),n.addChildNode(d);for(var s=0,l=t.assemblies.length;s<l;s++)d.addChildNode(createTreeNode$7(e,t.assemblies[s],"assemblys",i))}},getModelGroupTree=function(e,t){var n=e.getViewer();if(1===n._modelNum)n.getModelGroup(function(n){if(n){var o=createTree$4(e,n);t&&t(o)}else t&&t()});else if(n._modelNum>1){var o=[],i=function(){if(o.length===n._modelNum&&"[object Function]"===Object.prototype.toString.call(t)){var i=createCombinedTree$3(e,o);t(i)}};for(var a in n._modelData){var r=n._modelData[a],s=n._manifestMap[r.viewToken];if(s.Features.HasGroup){n.getModelGroup(r.modelId,function(e){return function(t){o.push({data:t,meta:e}),i()}}(r),function(e){return function(t){o.push({error:t,meta:e}),i()}}(r))}else o.push({meta:r}),i()}}},isDesktop=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),MEP_SYSTEM_LENGTH=0,LINK_PATH=[],FILE_ID,createTreeNode$8=function e(t,n){if(t){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!1,o.hasCheckbox=!1,o.selection=!1,t.type||(o.selection=!0);var i=new Glodon.Bimface.UI.Tree.TreeNode(o);if(i.setData(t.name,t.name),t.type||(i.network=t.network,i.fileId=FILE_ID),i.modelId=n,t.items&&t.items.length>0)for(var a=0,r=t.items.length;a<r;a++)i.addChildNode(e(t.items[a],n));else"fileId"===t.type&&i.disabled();return i}},createTree$5=function(e,t,n){if(n&&0!=n.length){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!1,o.hasCheckbox=!1,o.selection=!1;var i;i=new Glodon.Bimface.UI.Tree.TreeNode(o),i.expand();var a=new Glodon.Bimface.UI.Tree.Tree(i);if(1===t._modelNum)for(var r=0,s=n.length;r<s;r++){FILE_ID=n[r].id;var l=createTreeNode$8(n[r]);l.addEventListener("SelectionChanged",function(n,o,i){selectComponent$2(e,t,n,n,o,i)}),i.addChildNode(l)}else if(t._modelNum>1)for(var r=0;r<n.length;r++)if("integrateModel"===n[r].modelType){var o=new Glodon.Bimface.UI.Tree.TreeNodeConfig;o.isChecked=!1,o.hasCheckbox=!1,o.selection=!1;var d=new Glodon.Bimface.UI.Tree.TreeNode(o);d.setData(n[r].modelId,n[r].modelName),i.addChildNode(d);for(var c=Glodon.Web.Lang.Utility.ClientHelper.sortByName(n[r].fileList,"fileName"),u=0;u<c.length;u++){var p=c[u].mepData;if(p){FILE_ID=p.id;var l=createTreeNode$8(p,n[r].modelId);l.addEventListener("SelectionChanged",function(n,o,i){selectComponent$2(e,t,n,n,o,i)}),d.addChildNode(l)}else{var l=new Glodon.Bimface.UI.Tree.TreeNode(o);l.setData(c[u].fileName,c[u].fileName),l.disabled(),d.addChildNode(l)}}}else{var p=n[r].mepData;if(p){FILE_ID=void 0;var l=createTreeNode$8(p,n[r].fileId);l.addEventListener("SelectionChanged",function(n,o,i){selectComponent$2(e,t,n,n,o,i)}),i.addChildNode(l)}else{var l=new Glodon.Bimface.UI.Tree.TreeNode(o);l.setData(n[r].fileName,n[r].fileName),l.disabled(),i.addChildNode(l)}}return a}},selectComponent$2=function(e,t,n,o,i){var a=[];if(n.fileId)if(t._data.config&&t._data.config["integrate-with-links"]){var r=void 0;LINK_PATH.map(function(e){if(e.fileId==n.fileId)return void(r=e.linkedBy)}),r.map(function(e){n.network.map(function(t){var n=e+"."+t;a.push(n)})})}else n.network.map(function(e){var t=n.fileId+"."+e;a.push(t)});else a=n.network;isDesktop||i||e.getPanel("ModelTree").hide();var s=n.modelId;o?(t.clearSelectedComponents(),t.addSelectedComponentsById(a,s),t.zoomToSelectedComponents(1)):t.clearSelectedComponents(),t.render()},formatSystemData=function(e,t,n,o){var i=e.reduce(function(e,t,n){return e[t.systemCategory]=e[t.systemCategory]||{},e[t.systemCategory][t.systemType]=e[t.systemCategory][t.systemType]||[],e[t.systemCategory][t.systemType].push({name:t.name,network:Object.keys(t.network)}),e},{}),a=[];for(var r in i){a.push({type:"systemCategory",name:r,items:[]});for(var s in i[r])a[a.length-1].items.push({type:"systemType",name:s,items:i[r][s]})}var l=[];t?l.push({type:"fileId",id:t,name:n,items:a}):l=a,o&&o(l)},sortMepName=function e(t){return t=Glodon.Web.Lang.Utility.ClientHelper.sortByName(t,"name"),t.map(function(n){n.items&&n.items.length>0&&("systemType"==n.type?t=Glodon.Web.Lang.Utility.ClientHelper.sortByRules(n.items,"name"):e(n.items))}),t},getMepData=function(e,t,n,o,i){var a=[];e.getMepSystem(t,function(e){e.systems?formatSystemData(e.systems,t,n,function(e){o&&o(e)}):(MEP_SYSTEM_LENGTH--,o&&o(a))},function(){MEP_SYSTEM_LENGTH--,o&&o(a)},i)},getMepTree=function(e,t,n,o){var i,a;if(1===t._modelNum)if("integrateModel"==n){var r=[];t.getFiles(function(n){MEP_SYSTEM_LENGTH=n.length,n.forEach(function(n){i=n.fileId.toString(),a=n.fileName.toString(),LINK_PATH.push({fileId:i,linkedBy:n.linkedBy}),getMepData(t,i,a,function(n){if(0!=n.length&&r.push(n[0]),r.length==MEP_SYSTEM_LENGTH){var i=sortMepName(r),a=createTree$5(e,t,i);o&&o(a)}})})})}else getMepData(t,"","",function(n){var i=sortMepName(n),a=createTree$5(e,t,i);o&&o(a)});else t._modelNum>1&&t.getFiles(function(n){MEP_SYSTEM_LENGTH=0;var r=0;n.forEach(function(s){if("singleModel"===s.modelType){i=s.fileId.toString(),a=s.fileName.toString();t._manifestMap[s.viewToken].Features.HasMEPSystem&&(MEP_SYSTEM_LENGTH++,getMepData(t,i,a,function(i){if(0!=i.length&&(r++,s.mepData=i[0]),r==MEP_SYSTEM_LENGTH){var a=createTree$5(e,t,n);o&&o(a)}},i))}else"integrateModel"===s.modelType&&s.fileList.forEach(function(l){i=l.fileId.toString(),a=l.fileName.toString(),LINK_PATH.push({fileId:i,linkedBy:l.linkedBy}),t._manifestMap[s.viewToken].Features.HasMEPSystem&&(MEP_SYSTEM_LENGTH++,getMepData(t,i,a,function(i){if(0!=i.length&&(r++,l.mepData=i[0]),r==MEP_SYSTEM_LENGTH){var a=createTree$5(e,t,n);o&&o(a)}},s.modelId))})})})};!function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),n=function(e,n){var o=(e.getViewer(),e.getRootElement(),new Glodon.Bimface.UI.Panel.PanelConfig);o.title="楼层平面图",o.id="DrawingPanel",o.css=t?{right:"10px",top:"10px",width:"400px",height:"420px"}:{left:"0",top:"2.68em",width:"100%",bottom:0,paddingTop:0};var i=new Glodon.Bimface.UI.Panel.Panel(o);return t||i.element.addClass("view-panel"),i.setHeader(n.name),i};e.DrawingPanel=n}();var clearState=function(e){var t=e.getViewer(),n=e.getPanel("AreaPanel"),o=e.getPanel("DrawingPanel");clearSection(e),n&&(n.close(),e.removePanel("AreaPanel")),o&&o.hide(),t.hideAllRooms(),t.clearIsolation(),t.opaqueAllComponents(),t.clearSelectedComponents()},showDrawingPanel=function(e,t,n,o){var i=e.getViewer(),a=n.viewToken||i._data.viewToken,r=e.getRootElement(),s=n.isIntegrateModel;e.fileId=n.fileId,e.subViewer?"Local"==BimfaceLoaderConfig.dataEnvType?e.subViewer.addModel(BimfaceLoaderConfig.MetaData,n.id,s&&n.fileId):(e.getPanel("DrawingPanel").setTitleContent(n.name),e.subViewer.load(a,n.id,n.fileId)):(BimfaceLoaderConfig.viewToken=a,BimfaceLoaderConfig.viewType=BimfaceViewTypeOption.DrawingView,BimfaceSDKLoader.load(BimfaceLoaderConfig,function(o){var l,d,c=function(e,t){var n,o=function(n){if(0!=n.length){for(var o=0;o<n.length;o++){var i=n[o].areas,a=n[o].height,r=n[o].elevation;if(i&&i.length>0)for(var s=0;s<i.length;s++)if(e==i[s].id)return void t(i[s],r,a);var l=n[o].rooms;if(l&&l.length>0)for(var d=0;d<l.length;d++)if(e==l[d].id)return void t(l[d],r,a)}t()}};n?o(n):i.getAreas(function(e){n=e,o(n)})},u=i.getViewer(),p=!0,h=function(){if(l)l.show();else{var e=new Glodon.Bimface.UI.Tips.TipsConfig;e.element=r,e.timeOut=3e3,e.html=BimfaceLanguage.bf_panel_modelTree_componentNotFound,l=new Glodon.Bimface.UI.Tips.Tips(e)}p=!1};u.registerEventListener(CLOUD.EVENTS.ON_SELECTION_FAILED,h);var f=Glodon.Bimface.Viewer.Viewer3DEvent;i.addEventListener(f.MissingDrawingElement,function(){if(d)d.show();else{var e=new Glodon.Bimface.UI.Tips.TipsConfig;e.element=r,e.timeOut=3e3,e.html=BimfaceLanguage.bf_panel_modelTree_entityNotFound,d=new Glodon.Bimface.UI.Tips.Tips(e)}});var m=new Glodon.Bimface.Viewer.ViewerDrawingConfig;m.domElement=t.container;var g=new Glodon.Bimface.Viewer.ViewerDrawing(m);"Local"==BimfaceLoaderConfig.dataEnvType?(o.fileId=n.fileId||"",BimfaceLoaderConfig.MetaData=o,g.addModel(o,n.id,s&&o.fileId)):g.load(a,n.id,n.fileId),g.addEventListener("ComponentsSelectionChanged",function(t){if(t&&t.length>0){var n=t[0],o=g.toModelId(n);if(2==t.length){var a=g.toLinkRevitId(t[0],t[1]),r=a instanceof Object?a.fileId:e.fileId,l=a instanceof Object?a.revitId:o;o=r+"_"+l}else s&&(o=e.fileId+"_"+o);var d=e.getPlugin("SectionBox"),u=e.getPanel("SectionPanel");c(o,function(t,n,a){if(i.showAllComponents(),t){t.boundary&&i.setArea(t.boundary,n);var r=i.getWorldBox(n-20,n+1500);if(d)u&&u.hideBox();else{var l=new Glodon.Bimface.Plugins.Section.SectionBoxConfig;l.viewer=i,l.id="SectionBox",d=new Glodon.Bimface.Plugins.Section.SectionBox(l),e.addPlugin(d)}d.setBox(r),d.hideBox(),i.setView(Glodon.Bimface.Viewer.ViewOption.Top)}else s&&(o=o.replace("_",".")),d&&(d.reset(),d.hideBox()),u&&u.hideBox(),i.clearAllRooms(),i.setSelectedComponentsById([o]),p?(i.isolateComponentsById([o],Glodon.Bimface.Viewer.IsolateOption.MakeOthersTranslucent),i.zoomToSelectedComponents()):(i.clearIsolation(),p=!0);i.render()})}});var v=function(e){if(e.elementId){var t=e.elementId,n=g.fromRevitId(t),o=g.fromLinkRevitId(e.fileId,t);if(!(n||o&&o.ids)){var a=Glodon.Bimface.Viewer.Viewer3DEvent;return void i.getEventManager().fireEvent(a.MissingDrawingElement)}o instanceof Object?g.zoomToObjectWithBlock(o.blockId,o.ids):n&&g.zoomToObject(n)}};t.addEventListener("Sizable",function(){g.resize()}),t.addEventListener("Hide",function(){u.unregisterEventListener(CLOUD.EVENTS.ON_SELECTION_FAILED,h),i.removeEventListener("ComponentsSelectionChanged",v),t.close(),e.removePanel("DrawingPanel"),delete e.subViewer}),i.addEventListener("ComponentsSelectionChanged",v),e.subViewer=g}))},createDrawingPanel=function(e,t,n){var o=e.getRootElement(),i=e.getPanel("DrawingPanel");if(i)i.show();else{var i=new Glodon.Bimface.Application.UI.Panel.DrawingPanel(e,t);o.appendChild(i.element),i.bringToFront(),e.addPanel(i)}showDrawingPanel(e,i,t,n)};!function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),n=function(t,n){var o="component",i=t.getViewer(),a=(t.getRootElement(),i._manifest),r=i._data.modelType,s=e.create("div","bf-tree-header"),l=e.create("div","bf-tree-footer"),d=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),c=[],u=void 0,p=void 0,h=void 0,f=(i._data.workerType,void 0);if(d&&(f={component:{panel:!1,tree:null},modelGroup:{panel:!1,tree:null},mepSystem:{panel:!1,tree:null},file:{panel:!1,tree:null},links:{panel:!1,tree:null},area:{panel:!1,tree:null},drawing:{panel:!1,tree:null}}),a.Features.HasComponentStructure&&c.push({id:"component",name:BimfaceLanguage.bf_panel_modelTree_components}),(a.Features.HasGroup||a.Features.HasAssemble)&&c.push({id:"modelGroup",name:BimfaceLanguage.bf_panel_modelTree_modelGroup}),a.Features.HasMEPSystem&&c.push({id:"mepSystem",name:BimfaceLanguage.bf_panel_modelTree_mep}),a.Features.HasFileList&&c.push({id:"file",name:BimfaceLanguage.bf_panel_modelTree_files}),(a.Features.HasRoom||a.Features.HasArea)&&c.push({id:"area",name:BimfaceLanguage.bf_panel_modelTree_rooms1}),a.Features.HasDrawing&&c.push({id:"drawing",name:BimfaceLanguage.bf_panel_modelTree_drawings}),d){var m,g,v=e.create("div","bf-tree-tab");if(s.appendChild(v),c.length<5)m=c;else{var b=e.create("div","bf-tree-select"),y=e.create("div","bf-tree-slot");s.appendChild(y),s.appendChild(b),m=c.slice(0,3),g=c.slice(3);var w=new Glodon.Bimface.UI.Select.SelectConfig;w.className="bf-select bf-select-tree",w.options=g,w.element=b,p=new Glodon.Bimface.UI.Select.Select(w),y.innerHTML=g[0].name,y.setAttribute("id",g[0].id),y.setAttribute("title",g[0].name),s.querySelectorAll(".bf-select-option")[0].style.display="none";var C=s.querySelector(".bf-select-current"),M=e.create("i","gld-bf-arrow-right");C.appendChild(M)}var k=new Glodon.Bimface.UI.Tabs.TabsConfig,B=["oneTab","twoTabs","threeTabs","fourTabs","fiveTabs","sixTabs","sevenTabs"],T=m.length>7?6:m.length-1;k.className="bf-tabs bf-tabs-tree "+B[T],k.options=m,k.element=v,u=new Glodon.Bimface.UI.Tabs.Tabs(k),h=new Glodon.Bimface.UI.Panel.PanelConfig,h.title=BimfaceLanguage.bf_btn_modelTree,h.id="ModelTree",h.css={left:"10px",top:"10px",width:"300px",height:"430px"},h.className="bf-panel bf-modelTree-panel"}else{var k=new Glodon.Bimface.UI.Tabs.TabsConfig,B=["oneTab","twoTabs","threeTabs","fourTabs","fiveTabs","sixTabs","sevenTabs"],T=c.length>7?6:c.length-1;k.className="bf-tabs bf-tabs-tree-mobile "+B[T],k.options=c,k.element=s,u=new Glodon.Bimface.UI.Tabs.Tabs(k),h=new Glodon.Bimface.UI.Panel.PanelConfig,h.title=BimfaceLanguage.bf_btn_modelTree,h.id="ModelTree",h.css={left:0,top:0,width:"100%",height:"100%"}}var L;a.Features.HasLinkRelation&&(L=e.create("label","bf-tree-label bf-checkbox"),L.innerHTML='\n        <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_modelTree_fileLink+'</span>\n        <input type="checkbox" class="bf-checkbox-input" name="hover" id="linksModeInput">\n        <span class="bf-checkbox-display"></span>',l.appendChild(L),L.addEventListener("change",function(){x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading");t.getToolbar("MainToolbar");clearSection(t),clearState(t),i.showAllComponents(),i.render();var e=document.querySelector("#linksModeInput");P(e&&e.checked?"links":"file")}));var x=new Glodon.Bimface.UI.Panel.Panel(h);x.setContainerHeader(s),x.setContainerFooter(l);var S=x.container;x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),d||x.addClass("tree-panel"),x.addEventListener("Hide",function(){n.show(),d||"area"!=o&&"component"!=o&&clearState(t);var e=t.getPanel("AreaPropertyPanel");e&&e.hide(),i.render()}),d?f.component.panel||getCombinedComponentsTree(i,function(e){"component"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noComponent),f.component.tree=e,t.tree=f.component.tree,f.component.panel=!0,e.element.setAttribute("id","componentPanel"),e.element.addClass("tree-panel"),S.appendChild(e.element))}):getCombinedComponentsTree(i,function(e){"component"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noComponent),S.innerHTML="",t.tree=e,S.appendChild(e.element))});var P=function(e){o=e;var n=document.querySelectorAll(".tree-panel");switch(d&&(n.forEach(function(e){e.style.display="none"}),x.hideTips(),i.showAllComponents()),e){case"component":d?f.component.panel?(document.querySelector("#componentPanel").style.display="block",t.tree=f.component.tree,G("componentPanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getCombinedComponentsTree(i,function(e){"component"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noComponent),e&&(f.component.panel=!0,e.element.setAttribute("id","componentPanel"),e.element.addClass("tree-panel"),f.component.tree=e,t.tree=f.component.tree,S.appendChild(e.element)))})):getCombinedComponentsTree(i,function(e){"component"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noComponent),t.tree=e,e&&(S.innerHTML="",S.appendChild(e.element)))});break;case"modelGroup":d?f.modelGroup.panel?(document.querySelector("#modelGroupPanel").style.display="block",t.tree=f.modelGroup.tree,G("modelGroupPanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getModelGroupTree(t,function(e){"modelGroup"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noData),e&&(f.modelGroup.panel=!0,e.element.setAttribute("id","modelGroupPanel"),e.element.addClass("tree-panel"),f.modelGroup.tree=e,t.tree=f.modelGroup.tree,S.appendChild(e.element)))})):getModelGroupTree(t,function(e){"modelGroup"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noData),t.tree=e,e&&S.appendChild(e.element))});break;case"mepSystem":d?f.mepSystem.panel?(document.querySelector("#mepSystemPanel").style.display="block",t.tree=f.mepSystem.tree,G("mepSystemPanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getMepTree(t,i,r,function(e){"mepSystem"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noSystem),e&&(f.mepSystem.panel=!0,e.element.setAttribute("id","mepSystemPanel"),e.element.addClass("tree-panel"),f.mepSystem.tree=e,t.tree=f.mepSystem.tree,S.appendChild(e.element)))})):getMepTree(t,i,r,function(e){"mepSystem"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noSystem),t.tree=e,e&&S.appendChild(e.element))});break;case"area":d?f.area.panel?(document.querySelector("#areaPanel").style.display="block",t.tree=f.area.tree,G("areaPanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getAreaTree(t,function(e){"area"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noRoom),e&&(f.area.panel=!0,e.element.setAttribute("id","areaPanel"),e.element.addClass("tree-panel"),f.area.tree=e,t.tree=f.area.tree,S.appendChild(e.element)))})):getAreaTree(t,function(e){"area"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noRoom),e&&(t.tree=e,S.appendChild(e.element)))});break;case"file":var a=document.querySelector("#linksModeInput");d?f.file.panel?a&&a.checked&&f.links.panel?(document.querySelector("#linksPanel").style.display="block",t.tree=f.links.tree,G("linksPanel")):(document.querySelector("#filePanel").style.display="block",t.tree=f.file.tree,G("filePanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getFileTree(i,function(e){"file"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noFile),e&&(f.file.panel=!0,e.element.setAttribute("id","filePanel"),e.element.addClass("tree-panel"),f.file.tree=e,t.tree=f.file.tree,S.appendChild(e.element)))})):getFileTree(i,function(e){"file"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noFile),t.tree=e,e&&S.appendChild(e.element))});break;case"links":d?f.links.panel?(document.querySelector("#linksPanel").style.display="block",t.tree=f.links.tree,G("linksPanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getLinkedTree(i,function(e){"links"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noFile),e&&(f.links.panel=!0,e.element.setAttribute("id","linksPanel"),e.element.addClass("tree-panel"),f.links.tree=e,t.tree=f.links.tree,S.appendChild(e.element)))})):getLinkedTree(i,function(e){"links"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noFile),t.tree=e,e&&S.appendChild(e.element))});break;case"drawing":d?f.drawing.panel?(document.querySelector("#drawingPanel").style.display="block",t.tree=f.drawing.tree,G("drawingPanel")):(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),getDrawingTree(i,function(e){"drawing"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noDrawing),e&&(f.drawing.panel=!0,e.element.setAttribute("id","drawingPanel"),e.element.addClass("tree-panel"),f.drawing.tree=e,t.tree=f.drawing.tree,S.appendChild(e.element),e.addEventListener("SelectionChanged",function(e,n){if(n)createDrawingPanel(t,e,"singleModel");else{var o=t.getPanel("DrawingPanel");o&&t.subViewer&&t.subViewer.isInitialized&&o.hide()}})))})):getDrawingTree(i,function(e){"drawing"==o&&(x.setTips(BimfaceLanguage.bf_panel_modelTree_noDrawing),t.tree=e,e&&(S.appendChild(e.element),e.addEventListener("SelectionChanged",function(e,n){if(n)createDrawingPanel(t,e,"singleModel");else{var o=t.getPanel("DrawingPanel");o&&t.subViewer&&t.subViewer.isInitialized&&o.hide()}})))})}i.render()};u.addEventListener("Change",function(e){y&&y.removeClass("active"),I(e)}),p&&p.addEventListener("Change",function(e){_(e)}),y&&y.addEventListener("click",function(e){u.setCurrentOption(""),I(e.target),y.addClass("active")});var _=function(t){u.setCurrentOption(""),y.innerHTML=t.name,y.setAttribute("id",t.id),y.setAttribute("title",t.name),y.addClass("active");var n=s.querySelectorAll(".bf-select-option");n[0].style.display="block",n.forEach(function(e){e.id==t.id?e.style.display="none":e.style.display="block"});var o=s.querySelector(".bf-select-current"),i=e.create("i","gld-bf-arrow-right");o.appendChild(i),I(t)},I=function(e){d||(x.setTips(BimfaceLanguage.bf_panel_modelTree_loading,"loading"),x.clear()),clearSection(t),clearState(t),L&&("file"==e.id?(L.style.display="block",x.container.style.height="calc(100% - 30px)"):(L.style.display="none",x.container.style.height="100%")),P(e.id)},G=function(e){var t=[],n=document.querySelectorAll("#"+e+" .bf-unchecked"),o=document.querySelectorAll("#"+e+" .gld-bf-transparent"),a=document.querySelectorAll("#"+e+" .bf-selected"),r=document.querySelector("#treeRootNode .bf-unchecked"),s=document.querySelector("#treeRootNode .gld-bf-transparent");if("componentPanel"==e)r?i.hideAllComponents():n.forEach(function(e){e.closest(".bf-sub-tree").previousSibling.querySelector(".bf-unchecked")||t.push(e)}),s?i.transparentAllComponents():o.forEach(function(e){e.closest(".bf-sub-tree").previousSibling.querySelector(".gld-bf-transparent")||t.push(e)}),a.forEach(function(e){e.closest(".bf-sub-tree").previousSibling.querySelector(".bf-selected")||t.push(e)});else var t=[].concat(_toConsumableArray(a),_toConsumableArray(n),_toConsumableArray(o));t.forEach(function(e){e.click(),e.click()})};return x.addEventListener("Show",function(){if(t.tree&&t.tree._selectionNode&&"area"==o){var e=t.tree._selectionNode;e.eventManager.fireEvent("SelectionChanged",e,!0,!0)}G(o+"Panel")}),x};t.ModelTreePanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),i=(Glodon.Bimface.Viewer.Viewer3D,Glodon.Bimface.UI.Control.ControlEvent),a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="ModelTree",a.title=BimfaceLanguage.bf_btn_modelTree,a.className="bf-button gld-bf-tree";var r=new Glodon.Bimface.UI.Button.Button(a);return r.addEventListener(i.Click,function(){t.hide();var n=e.getPanel("ModelTree");if(n){n.show();var i=e.tree;i._selectionNode}else{var a=new Glodon.Bimface.Application.UI.Panel.ModelTreePanel(e,t);o.appendChild(a.element),e.addPanel(a)}}),r};e.ModelTree=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),i=(Glodon.Bimface.Viewer.Viewer3D,Glodon.Bimface.UI.Control.ControlEvent),a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="MobileModelTree",a.title="构件树",a.className="bf-button gld-bf-tree";var r=new Glodon.Bimface.UI.Button.Button(a);return r.addEventListener(i.Click,function(){t.hide();var e=new Glodon.Bimface.Application.UI.Panel.ModelTreePanel(n,o,t,!0);o.appendChild(e.element)}),r};e.MobileModelTree=t}();var Environmental={dev:"dev",build:"build"},CurrentEnv=Environmental.build;CurrentEnv||(CurrentEnv=Environmental.dev);var Env=CurrentEnv;!function(){
var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n="dev"==Env,o=function(e){var o=e.getViewer(),i=new Glodon.Bimface.UI.Panel.PanelConfig,a=this,r=e.state;n=n?o.isSupportSSAO():n,this.viewer=o;var s;s=o._data.dataEnvType==BimfaceEnvOption.Local?o._data.sdkPath:hostConfig.staticHost,i.title=BimfaceLanguage.bf_btn_settings,i.id="Setting",i.css={left:"50%",top:"50%",transform:"translate(-50%,-200px)",width:"330px",height:"auto"},i.enableSizable=!1,i.className="bf-panel bf-settings-panel";var l={1:{type:"multiple",direction:"0deg",colors:[{color:new Glodon.Web.Graphics.Color(246,250,255,1),stop:"10%"},{color:new Glodon.Web.Graphics.Color(214,224,235,1),stop:"70%"}]},2:{type:"skybox",skyBoxType:"CloudySky"},3:{type:"single",color:new Glodon.Web.Graphics.Color(214,214,213,1)},4:{type:"single",color:new Glodon.Web.Graphics.Color(92,92,92,1)},5:{type:"single",color:new Glodon.Web.Graphics.Color(0,0,0,1)},6:{type:"single",color:new Glodon.Web.Graphics.Color(50,71,91,1)}},d=new Glodon.Bimface.UI.Panel.Panel(i),c=t.create("form","bf-setting"),u=t.create("div","bf-setting-foot"),p=[{id:"default",name:BimfaceLanguage.bf_panel_settings_interaction,title:BimfaceLanguage.bf_panel_settings_interaction},{id:"effect",name:BimfaceLanguage.bf_panel_settings_effect,title:BimfaceLanguage.bf_panel_settings_effect}],h=new Glodon.Bimface.UI.Tabs.TabsConfig;h.className="bf-setting-tabs",h.default="default",h.options=p;var f=new Glodon.Bimface.UI.Tabs.Tabs(h),m='<ul class="bf-setting-tab-default bf-show">\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_contextMenu+'</span>\n          <div class="bf-setting-value contextMenu">\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name="menu" '+(r.menu?"checked":"")+' data-value=\'true\'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_general_on+'</span>\n            </label>\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name="menu" '+(r.menu?"":"checked")+' data-value=\'false\'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_general_off+'</span>\n            </label>\n          </div>\n        </li>\n\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_orbitBtn+'</span>\n          <div class="bf-setting-value setMouseBehavior">\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name="orbit" '+(r.hobby?"checked":"")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_leftOrbit+'</span>\n            </label>\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name="orbit" '+(r.hobby?"":"checked")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_rightOrbit+'</span>\n            </label>\n          </div>\n        </li>\n\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_hover+'</span>\n          <div class="bf-setting-value mouseHover">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="hover" '+(r.hover?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_hoverEffect+'</span>\n            </label>\n          </div>\n        </li>\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_zoomDir+'</span>\n          <div class="bf-setting-value mouseScroll">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="scroll" '+(r.scroll?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_reverseDir+'</span>\n            </label>\n          </div>\n        </li>\n        </ul>\n\n        <ul class="bf-setting-tab-effect bf-scroll-bar">\n        <li class="bf-setting-select">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_effectPreset+'</span>\n          <div id="modeSelect"></div>\n        </li>\n        <li class="bf-setting-li checkbox">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_border+'</span>\n          <div class="bf-setting-value setBorderLine">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="borderline" '+(r.borderLine?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_displayBorder+'</span>\n            </label>\n          </div>\n        </li>\n        <li class="bf-setting-li checkbox">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_shadow+'：</span>\n          <div class="bf-setting-value enableShadow">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="shadow" '+(r.shadow?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_enableShadow+'</span>\n            </label>\n          </div>\n        </li>\n        <li class="bf-setting-li '+(n?"":"bf-setting-none")+'" style="display:none">\n          <span class="bf-setting-name">SSAO：</span>\n          <div class="bf-setting-value enableSSAO">\n            <label class="bf-checkbox">\n              <input type="checkbox" class="bf-checkbox-input" name="SSAO" '+(r.SSAO?"checked":"")+'>\n              <span class="bf-checkbox-display"></span>\n              <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_setting_ssao+'</span>\n            </label>\n          </div>\n        </li>\n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_exposure+'</span>\n          <div class="bf-setting-value bf-setting-range" id="exposure"></div>\n        </li>\n\n        <li class="bf-li-more">\n          <div class="bf-panel-more">\n            <span>'+BimfaceLanguage.bf_panel_settings_moreOpt+'</span>\n            <i class="bf-arrow"></i>\n          </div>\n        </li>\n        <div class="bf-more-list">\n          <li class="bf-setting-li">\n            <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_bgColor+'</span>\n            <div class="bf-color">\n              <div class="bf-color-item '+(1==r.backgroundColor?"bf-color-select":"")+'" data-value="1">\n                <span class="bf-color-node" style="background: linear-gradient(180deg, rgb(214, 224, 235) 10%, rgb(246, 250, 255) 70%)"></span>\n              </div>\n              <div class="bf-color-item '+(2==r.backgroundColor?"bf-color-select":"")+'" data-value="2">\n              <span class="bf-color-node" style="background: linear-gradient(180deg, rgb(214, 224, 235) 10%, rgb(246, 250, 255) 70%)">\n                <img src="'+s+'/resources/SkyBox/thumbnails/CloudySky.png"/>\n              </span>\n            </div>\n              <div class="bf-color-item '+(3==r.backgroundColor?"bf-color-select":"")+'" data-value="3">\n                <span class="bf-color-node" style="background:#d6d6d5;"></span>\n              </div>\n              <div class="bf-color-item '+(4==r.backgroundColor?"bf-color-select":"")+'" data-value="4">\n                <span class="bf-color-node" style="background:#5c5c5c;"></span>\n              </div>\n              <div class="bf-color-item '+(5==r.backgroundColor?"bf-color-select":"")+'" data-value="5">\n                <span class="bf-color-node" style="background:#000000;"></span>\n              </div>\n              <div class="bf-color-item '+(6==r.backgroundColor?"bf-color-select":"")+'" data-value="6">\n                <span class="bf-color-node" style="background:#32475b;"></span>\n              </div>\n            </div>\n          </li>\n          <li style="display:block" class="bf-setting-li checkbox">\n            <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_ambientLight+'</span>\n            <div class="bf-setting-value ambientLight">\n              <label class="bf-checkbox">\n                <input type="checkbox" class="bf-checkbox-input" name="ambientLight" '+(r.ambientLight?"checked":"")+'>\n                <span class="bf-checkbox-display"></span>\n                <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_enableAbientLight+'</span>\n              </label>\n            </div>\n          </li>\n          <li style="display:block" class="bf-thumbnail bf-setting-margin bf-enable-list '+(r.ambientLight?"":"bf-setting-disabled")+'">\n            <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_iblSel+'</span>\n            <div class="bf-thumbnail-value IBL-thumbnail">\n              <label class="'+("Gray"==r.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="Gray">\n                <img  src="'+s+'/resources/IBL/thumbnails/Gray.png" />\n              </label>\n              <label class="'+("HarborSunRise"==r.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="HarborSunRise">\n                <img src="'+s+'/resources/IBL/thumbnails/HarborSunRise.png" />\n              </label>\n              <label class="'+("ParkingLot"==r.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="ParkingLot">\n                <img src="'+s+'/resources/IBL/thumbnails/ParkingLot.png" />\n              </label>\n              <label class="'+("RiverSide"==r.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="RiverSide">\n                <img src="'+s+'/resources/IBL/thumbnails/RiverSide.png" />\n              </label>\n              <label class="'+("Sunrise"==r.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="Sunrise">\n                <img src="'+s+'/resources/IBL/thumbnails/Sunrise.png" />\n              </label>\n              <label class="'+("SunsetGrass"==r.IBLName?"bf-thumbnail-item selected":"bf-thumbnail-item")+'" id="SunsetGrass">\n                <img src="'+s+'/resources/IBL/thumbnails/SunsetGrass.png" />\n              </label>\n            </div>\n          </li>\n          <li style="display:block" class="bf-setting-li bf-setting-margin bf-enable-list '+(r.ambientLight?"":"bf-setting-disabled")+'">\n            <span class="bf-setting-name"></span>\n            <div class="bf-setting-value IBLBackground">\n              <label class="bf-checkbox">\n                <input type="checkbox" class="bf-checkbox-input" name="enableIBLBackground" '+(r.enableIBLBackground?"checked":"")+'>\n                <span class="bf-checkbox-display"></span>\n                <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_settings_iblBgDisplay+"</span>\n              </label>\n            </div>\n          </li>\n        </div>\n        </ul>",g='<div class="bf-reset">\n          <span class="reset">'+BimfaceLanguage.bf_panel_settings_restore+"</span>\n        </div>";c.innerHTML=m,u.innerHTML=g,f.addEventListener("Change",function(e){"default"==e.id?(d.body.querySelector(".bf-setting-tab-default").addClass("bf-show"),d.body.querySelector(".bf-setting-tab-effect").removeClass("bf-show")):(d.body.querySelector(".bf-setting-tab-default").removeClass("bf-show"),d.body.querySelector(".bf-setting-tab-effect").addClass("bf-show"))});for(var v=c.querySelectorAll(".contextMenu .bf-radio-input"),b=0,y=v.length;b<y;b++)v[b].addEventListener("change",function(){a.viewer.toggleContextMenuDisplay()});for(var w=c.querySelectorAll(".setMouseBehavior .bf-radio-input"),C=0,M=w.length;C<M;C++)!function(e,t){w[e].addEventListener("change",function(){var t=e;o.setUseLeftHandedInput(!t)})}(C);var k=c.querySelector(".mouseHover .bf-checkbox-input");k.addEventListener("change",function(){var e=o.isEnableHover();o.enableHover(!e)});var B=c.querySelector(".mouseScroll .bf-checkbox-input");B.addEventListener("change",function(){o.setReverseWheelDirection(this.checked)});var T=c.querySelector(".setBorderLine .bf-checkbox-input");T.addEventListener("change",function(){o.setBorderLineEnabled(this.checked),o.render()});var L=function(e){switch(e){case"low":T.checked=!0,o.setBorderLineEnabled(!0),o.setMinimumFPS(8);break;case"high":T.checked=!1,o.setBorderLineEnabled(!1),o.setMinimumFPS(30)}o.render()},x=[{id:"low",name:BimfaceLanguage.bf_panel_settings_bestAppear},{id:"high",name:BimfaceLanguage.bf_panel_settings_bestPerform}],S=new Glodon.Bimface.UI.Select.SelectConfig;S.className="bf-select bf-select-mode",S.options=x;var P=new Glodon.Bimface.UI.Select.Select(S);P.setCurrentOption(r.effect),c.querySelector("#modeSelect").appendChild(P.element),P.addEventListener("Change",function(e){L(e.id)});var _=c.querySelector(".enableShadow .bf-checkbox-input");_.addEventListener("change",function(){o.enableShadow(this.checked),o.render()});var I=c.querySelector(".enableSSAO .bf-checkbox-input");I.addEventListener("change",function(){o.enableSSAO(this.checked),o.render()});var G=new Glodon.Web.Lang.Utility.Dom.range({element:c.querySelector("#exposure"),min:-1,max:1,step:.1,cur:r.exposure,change:function(e){o.setExposureShift(e),o.render()}}),E=c.querySelector(".bf-panel-more"),N=c.querySelector(".bf-more-list");E.addEventListener("click",function(){E.toggleClass("bf-show-more"),N.toggleClass("bf-show")});for(var A=c.querySelectorAll(".bf-color .bf-color-item"),U=0,D=A.length;U<D;U++)!function(e,t){A[e].addEventListener("click",function(){for(var n=this.getAttribute("data-value"),i=l[n],a=i.type,r=0;r<t;r++)A[r].removeClass("bf-color-select");if(A[e].addClass("bf-color-select"),"single"==a){o.enableSkyBox(!1);var s=i.color;o.setBackgroundColor(s)}else if("multiple"==a){o.enableSkyBox(!1);var d=i.direction,c=i.colors;o.setBackgroundColors(c,d)}else o._opt.skyBoxType=i.skyBoxType,o.enableSkyBox(!0)})}(U,D);var z=c.querySelector(".IBL-thumbnail"),V=z.querySelectorAll(".bf-thumbnail-item"),W=c.querySelector(".ambientLight .bf-checkbox-input"),H=c.querySelectorAll(".bf-enable-list");W.addEventListener("change",function(){for(var e=this.checked,t=0;t<H.length;t++)H[t].toggleClass("bf-setting-disabled",!e);if(e){var n=c.querySelector(".IBL-thumbnail .selected");o.setLightingMode(Glodon.Bimface.Viewer.LightingMode.IBL);var i;n?i=n.getAttribute("id"):(V[0].addClass("selected"),i=V[0].id),o.loadIBLScene(i,F.checked)}else{o.enableIBLBackground(!1),o.setLightingMode(Glodon.Bimface.Viewer.LightingMode.Phong);var n=c.querySelector(".IBL-thumbnail .selected");n&&n.removeClass("selected"),F.checked=!1,o._opt.enableSky&&o.enableSkyBox(!0),o.render()}}),z.addEventListener("click",function(e){if(o.isEnableIBLBackground()&&"IMG"==e.target.nodeName)for(var t=e.target.parentNode,n=t.id,i=0,a=V.length;i<a;i++)V[i].removeClass("selected"),V[i]==t&&(t.addClass("selected"),o.setLightingMode(Glodon.Bimface.Viewer.LightingMode.IBL),o.loadIBLScene(n,F.checked))});var F=c.querySelector(".IBLBackground .bf-checkbox-input");return F.addEventListener("change",function(){if(!o.isEnableIBLBackground())return void(this.checked=!1);var e=this.checked;o.enableIBLBackground(e),!e&&o._opt.enableSkyBox&&o.enableSkyBox(!0),o.render()}),u.querySelector(".reset").addEventListener("click",function(){f.setCurrentOption("default"),v[r.menu?0:1].checked=!0,o.toggleContextMenuDisplay(r.menu),w[0].click(),k.checked=r.hover,o.enableHover(r.hover),B.checked=r.scroll,o.setReverseWheelDirection(r.scroll),P.setCurrentOption(r.effect),L(r.effect),T.checked=r.borderLine,o.setBorderLineEnabled(r.borderLine),o.enableShadow(!1),_.checked=!1,o.enableSSAO(!1),I.checked=!1,G.setProgress(r.exposure),o.setExposureShift(r.exposure),E.removeClass("bf-show-more"),N.removeClass("bf-show"),A[0].click(),W.checked!=r.ambientLight&&W.click();for(var e=0,t=V.length;e<t;e++)V[e].removeClass("selected"),V[e].id==r.IBLName&&V[e].addClass("selected");F.checked=r.enableIBLBackground,o.loadIBLScene(r.IBLName,r.enableIBLBackground),o.render()}),d.setContainerHeader(f.element),d.container.appendChild(c),d.container.appendChild(u),d};e.SettingPanel=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),i=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!i)return void console.log("The API is not supported on this viewer.");var s=new Glodon.Bimface.UI.Button.ButtonConfig;s.id="Setting",s.title=BimfaceLanguage.bf_btn_settings,s.className="bf-button gld-bf-settings";var l=new Glodon.Bimface.UI.Button.ToggleButton(s);return l.addEventListener(a.StateChange,function(t){var i=e.getPanel("Setting");t?i?i.show():(i=new Glodon.Bimface.Application.UI.Panel.SettingPanel(e),i.addEventListener("Hide",function(){l.setCheckedState(!1)}),o.appendChild(i.element),i.bringToFront(),e.addPanel(i)):i.hide(),n.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:s.id,isChecked:t})}),l};e.Setting=t}();var createRoutePanel=function(e,t){e.num||(e.num=0);var n=!1,o=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),i=o.create("div","bf-route-form"),a=o.create("div","bf-route-info"),r=o.create("div","bf-route-info-row"),s=o.create("span","bf-route-info-label");s.innerText=BimfaceLanguage.bf_panel_nav_name;var l=o.create("input","bf-route-info-input");l.value=e._walkthrough.getName(),r.appendChild(s),r.appendChild(l);var d=o.create("div","bf-route-info-input"),c=o.create("div","bf-route-info-row"),u=o.create("span","bf-route-info-label");u.innerText=BimfaceLanguage.bf_panel_nav_time;var p=o.create("input","bf-route-info-time");p.setAttribute("type","number"),p.value=e._walkthrough.walkthroughTime,p.setAttribute("min","1"),p.setAttribute("max","120");var h=o.create("span","bf-route-info-timespan");h.innerHTML=BimfaceLanguage.bf_panel_nav_second,d.appendChild(p),d.appendChild(h),c.appendChild(u),c.appendChild(d),a.appendChild(r),a.appendChild(c);var f=o.create("div","bf-route-title"),m=o.create("span","bf-route-add");m.innerHTML='<i class="bf-icon-add"></i><span>'+BimfaceLanguage.bf_panel_nav_addKeyframe+"</span>";var g=o.create("span","bf-route-clear");g.innerText=BimfaceLanguage.bf_panel_nav_clearKeyframe,f.appendChild(m),f.appendChild(g);var v=o.create("div","bf-route-panel-tips");v.innerText=BimfaceLanguage.bf_panel_nav_addHere;var b=o.create("ul","bf-route-list bf-scroll-bar"),y=o.create("div","bf-route-foot"),w=o.create("div","bf-route-control bf-route-disabled");w.innerHTML='<i class="bf-icon-play"></i><span>'+BimfaceLanguage.bf_panel_nav_playnav+"</span>",y.appendChild(w),i.appendChild(a),i.appendChild(f),i.appendChild(v),i.appendChild(b),i.appendChild(y),i.saveWalkthrough=function(){if(0===b.childElementCount)return!1;for(var t=[],n=0;n<b.childElementCount;n++)t.push(b.children[n].keyFrame);return e.setKeyFrames(t),""!==p.value&&parseFloat(p.value)>0?e.setWalkthroughTime(parseFloat(p.value)):(p.value=e._walkthrough.walkthroughTime,d.removeClass("bf-route-info-input-invalid")),""!==l.value?e._walkthrough.setName(l.value):(l.value=e._walkthrough.getName(),l.removeClass("bf-route-info-input-invalid")),!0};var C=function(e,i,a){v.style.display="none";var r=o.create("div","bf-route-li"),s=o.create("div","bf-route-box"),l=o.create("span","bf-route-button");l.innerText=BimfaceLanguage.bf_general_delete;var d=o.create("span","bf-route-button bf-route-play");d.innerText=BimfaceLanguage.bf_panel_nav_play;var c=o.create("span","bf-route-name");c.innerText=e,a&&(r.camera=a),r.keyFrame=i,s.appendChild(d),s.appendChild(l),r.appendChild(c),r.appendChild(s),r.addEventListener("click",function(e){var o=e,i=o.target;n||i!=l&&i!=d&&(M?M!==r&&(M.removeClass("bf-selected"),r.addClass("bf-selected"),M=r):(r.addClass("bf-selected"),M=r),t.setCameraStatus(r.camera))}),d.addEventListener("click",function(e){k(r.keyFrame.id)}),l.addEventListener("click",function(e){M==r&&(M=null),b.removeChild(r),b.childElementCount<2&&w.addClass("bf-route-disabled"),0==b.childElementCount&&(v.style.display="block")}),M?(M.after(r),M.removeClass("bf-selected"),M=null):b.appendChild(r),b.childElementCount>=2&&w.removeClass("bf-route-disabled")};!function(){var n=e.getKeyFrames();if(n&&n.length>0)for(var o=0;o<n.length;o++){var i=n[o],a=i.name||""+BimfaceLanguage.bf_panel_nav_keyframe+e.num++,r=t.getCameraStatus();r.position=t.getViewer().drawingToWorld(i.position),r.target=t.getViewer().drawingToWorld(i.target),r.up={x:0,y:0,z:1},C(a,i,r)}}();var M=!1;l.addEventListener("blur",function(){""===l.value?l.addClass("bf-route-info-input-invalid"):l.removeClass("bf-route-info-input-invalid")}),p.addEventListener("blur",function(){""===p.value||Number(p.value)<=0?d.addClass("bf-route-info-input-invalid"):d.removeClass("bf-route-info-input-invalid")}),m.addEventListener("click",function(){if(!n){var o=t.getCameraStatus(),i=""+BimfaceLanguage.bf_panel_nav_keyframe+e.num++,a=e.addKeyFrame(i);C(i,a,o)}}),g.addEventListener("click",function(){n||(e.clearKeyFrames(),b.innerHTML="",M=null,w.addClass("bf-route-disabled"),v.style.display="block")});var k=function(t){i.saveWalkthrough(),e.play(t),b.addClass("bf-route-disabled"),g.addClass("bf-route-disabled"),m.addClass("bf-route-disabled"),p.setAttribute("disabled",!0),l.setAttribute("disabled",!0),w.innerHTML='<i class="bf-icon-stop"></i><span>'+BimfaceLanguage.bf_panel_nav_stop+"</span>",document.querySelector(".bf-routes-return").addClass("bf-routes-disabled"),n=!0};return w.addEventListener("click",function(){this.hasClass("bf-route-disabled")||(n?(b.removeClass("bf-route-disabled"),g.removeClass("bf-route-disabled"),m.removeClass("bf-route-disabled"),p.removeAttribute("disabled"),l.removeAttribute("disabled"),this.innerHTML='<i class="bf-icon-play"></i><span>'+BimfaceLanguage.bf_panel_nav_playnav+"</span>",e.stop(),M=!1):k())}),e.stopCallback(function(){b.removeClass("bf-route-disabled"),g.removeClass("bf-route-disabled"),m.removeClass("bf-route-disabled"),p.removeAttribute("disabled"),l.removeAttribute("disabled"),w.innerHTML='<i class="bf-icon-play"></i><span>'+BimfaceLanguage.bf_panel_nav_playnav+"</span>",M&&M.removeClass("bf-selected"),document.querySelector(".bf-routes-return").removeClass("bf-routes-disabled"),n=!1}),e.setKeyFrameCallback(function(e){var t=e;M&&M.removeClass("bf-selected"),b.children[t].addClass("bf-selected"),M=b.children[t]}),i.stopWalkthrough=function(){n&&w.click()},i},createRouteManagerPanel=function e(t,n){function o(e){e.style.display="block"}function i(e){e.style.display="none"}var a=0,r=!1,s=null,l=null,d=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),c=d.create("div","bf-routes-panel"),u=d.create("div","bf-routes-form"),p=d.create("div","bf-routes-title"),h=d.create("span","bf-routes-create");h.innerHTML='<i class="bf-icon-create"></i><span>'+BimfaceLanguage.bf_panel_nav_addWalkthrough+"</span>";var f=d.create("span","bf-routes-return");f.innerText=BimfaceLanguage.bf_panel_nav_walkthroughList;var m=d.create("div","bf-routes-split");p.appendChild(h),p.appendChild(f),c.appendChild(p),c.appendChild(m);var g=d.create("div","bf-routes-panel-tips");g.innerText=BimfaceLanguage.bf_panel_nav_addWalkthroughHere;var v=d.create("ul","bf-routes-list bf-scroll-bar");u.appendChild(g),u.appendChild(v),c.appendChild(u);var b=!1,y=!1,w=null,C=function(){y=!1,w&&"[object Function]"===Object.prototype.toString.call(w)&&w(),w=null},M=null,k=function(e){if(!r){s&&(c.removeChild(s),s=null);var p,m;if(!e||e instanceof MouseEvent){var k=new Glodon.Bimface.Plugins.Walkthrough.WalkthroughConfig;k.viewer=n,p=new Glodon.Bimface.Plugins.Walkthrough.Walkthrough(k),m=BimfaceLanguage.bf_panel_nav_walkthrough1+ ++a,p.setWalkthroughTime(20),l=t.addWalkthrough(m,p),s=createRoutePanel(p,n),c.appendChild(s),i(u),i(h),o(f),M=!0}else p=e.walkthrough,m=e.walkthrough._walkthrough.getName(),l=e.id;i(g);var B=d.create("div","bf-routes-li"),T=d.create("div","bf-routes-box"),L=d.create("span","bf-routes-button");L.innerText=BimfaceLanguage.bf_general_edit;var x=d.create("span","bf-routes-button");x.innerText=BimfaceLanguage.bf_general_delete;var S=d.create("span","bf-routes-name");S.innerText=m,T.appendChild(L),T.appendChild(x);var P=d.create("div","bf-routes-play"),_=d.create("div","bf-routes-stop");B.appendChild(P),B.appendChild(_),B.appendChild(S),B.appendChild(T),B.setAttribute("walkthroughId",l);var I=function(e){var n=t._walkthroughMap[e],a=n.walkthrough._stopCallback;(!a||a.toString().indexOf("originCb")<0)&&n.walkthrough.stopCallback(function(){a(),i(_),o(P),b?b=!1:(v.removeClass("bf-routes-disabled"),h.removeClass("bf-routes-disabled"),r=!1)})},G=function(){v.querySelector(".bf-selected")&&v.querySelector(".bf-selected").removeClass("bf-selected"),v.querySelector('.bf-routes-li[walkthroughId="'+l+'"]').addClass("bf-selected")},E=function(e,a){var d=function(){if(r){var e=v.querySelector('.bf-routes-li[walkthroughId="'+l+'"]').querySelector(".bf-routes-stop");e&&e.click(),r=!1}},p=function(){if(a!==l&&s&&(c.removeChild(s),s=null),!s){l=a;var e=t._walkthroughMap[l];s=createRoutePanel(e.walkthrough,n),I(a),i(s),c.appendChild(s)}};switch(e){case"play":return function(e){var n=this;if(y)return void(w=function(){n.click()});b=!1,d(),p(),G();var l=s.querySelector(".bf-route-control");if(!l.hasClass("bf-route-disabled")&&l.querySelector(".bf-icon-play"))l.click();else{if(!t._walkthroughMap[a].walkthrough.bPause)return;t._walkthroughMap[a].walkthrough.play()}r=!0,v.addClass("bf-routes-disabled"),h.addClass("bf-routes-disabled"),i(P),o(_)};case"select":return function(e){b=!1,d(),p(),G();var t=s.querySelector(".bf-route-list");t.childElementCount>0&&(y=!0,n.setCameraStatus(t.firstElementChild.camera,C))};case"stop":return function(e){b=!1,r&&(i(_),o(P),t._walkthroughMap[a].walkthrough.pause(),r=!1,v.removeClass("bf-routes-disabled"),h.removeClass("bf-routes-disabled"))};case"edit":return function(e){if(b=!1,!r){p();var l=s.querySelector(".bf-route-control");!l.hasClass("bf-route-disabled")&&l.querySelector(".bf-icon-stop")?l.click():t._walkthroughMap[a].walkthrough.bPause&&t._walkthroughMap[a].walkthrough.stop(),G(),i(u),i(h),o(f),o(s),M=!1;var d=s.querySelector(".bf-route-list");d.childElementCount>0&&(y=!0,n.setCameraStatus(d.firstElementChild.camera,C))}};case"delete":return function(e){b=!1,r||(v.removeChild(v.querySelector('.bf-routes-li[walkthroughId="'+a+'"]')),t.removeWalkthrough(a),8===v.childElementCount&&v.removeClass("bf-routes-list-scroll"),0===v.childElementCount&&o(g))}}};P.addEventListener("click",E("play",l)),_.addEventListener("click",E("stop",l)),L.addEventListener("click",E("edit",l)),x.addEventListener("click",E("delete",l)),S.addEventListener("click",E("select",l)),I(l),v.appendChild(B),v.childElementCount>8&&v.addClass("bf-routes-list-scroll"),f.removeClass("bf-routes-disabled"),G()}};return h.addEventListener("click",k),f.addEventListener("click",function(){if(!this.hasClass("bf-routes-disabled")){if(s.saveWalkthrough()){var e=t._walkthroughMap[l];v.querySelector('.bf-routes-li[walkthroughId="'+l+'"]').querySelector(".bf-routes-name").innerHTML=e.walkthrough._walkthrough.getName()}else v.querySelector('.bf-routes-li[walkthroughId="'+l+'"]').querySelector(".bf-routes-box").lastElementChild.click(),M&&a--;i(s),i(f),o(u),o(h)}}),e.loadWalkthrough=function(e){t.setWalkthroughList(e);for(var n in t._walkthroughMap)k(t._walkthroughMap[n])},e.stopWalkthrough=function(){if("none"!==u.style.display&&r){var e=v.querySelector('.bf-routes-li[walkthroughId="'+l+'"]').querySelector(".bf-routes-stop");e&&e.click(),r=!1,v.removeClass("bf-routes-disabled"),h.removeClass("bf-routes-disabled")}else s&&s.stopWalkthrough()},c};!function(){var e=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel")),t=function(e){var t=e.getViewer(),n=new Glodon.Bimface.UI.Panel.PanelConfig;n.title=BimfaceLanguage.bf_panel_nav_walkthrough,n.id="WalkRoutePanel",n.css={right:"10px",top:"10px",width:"300px",height:"410px"},n.enableSizable=!1;var o=new Glodon.Bimface.UI.Panel.Panel(n),n=new Glodon.Bimface.Plugins.Walkthrough.WalkthroughManagerConfig;n.viewer=t;var i=new Glodon.Bimface.Plugins.Walkthrough.WalkthroughManager(n),a=createRouteManagerPanel(i,t);return o.container.appendChild(a),o.addEventListener("Hide",function(){createRouteManagerPanel.stopWalkthrough()}),o.loadWalkthrough=createRouteManagerPanel.loadWalkthrough,i.id="WalkthroughManager",e.addPlugin(i),o};e.WalkRoutePanel=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(e){function n(){var e=u[c];B.innerText=e+"X",l.setFlySpeedRate(parseFloat(e))}function o(){c<u.length-1&&(c++,n())}function i(){c&&(c--,n())}function a(e){var t,n=w.querySelector(".gld-bf-map"),o=document.querySelector(".gld-bf-min-");o&&o.click(),!0===e?(t=!0,d.addClass("walker")):t=!b._checked,t?n.addClass("active"):n.removeClass("active"),b.setCheckedState(t)}function r(){var t=e.getPanel("WalkRoutePanel");t&&h.getWalkthrough(function(e){t.loadWalkthrough(e)})}function s(){var t=this,n=w.querySelectorAll(".bf-walk-label"),o=e.getPanel("WalkRoutePanel");if(t.hasClass("active")){t.removeClass("active"),o&&o.hide();for(var i=0;i<n.length;i++)n[i].removeClass("bf-walk-disabled"),T.disabled=!1,L.disabled=!1}else{if(t.addClass("active"),o)o.show();else{var a=new Glodon.Bimface.Application.UI.Panel.WalkRoutePanel(e);a.addEventListener("Hide",function(){t.removeClass("active");for(var e=0;e<n.length;e++)n[e].removeClass("bf-walk-disabled"),T.disabled=!1,L.disabled=!1;T.disabled=!1,L.disabled=!1}),d.appendChild(a.element),e.addPanel(a),l._manifest&&l._manifest.Features_ext&&l._manifest.Features_ext.HasWalkthrough&&r()}for(var i=0;i<n.length;i++)n[i].addClass("bf-walk-disabled");T.checked=!1,T.disabled=!0,l.enableGravity(!1),L.checked=!1,L.disabled=!0,l.enableHitDetection(!1)}}var l=e.getViewer(),d=e.getRootElement(),c=0,u=["1","2","4","8","16"],p=(l.getViewer(),Glodon.Bimface.UI.Control.ControlEvent),h=l._getMetaDataManager(),f="sv_SE"===BimfaceLanguage.name?"565px":"530px",m={element:d,className:"bf-panel bf-walk-panel bf-walkthrough-panel",id:"WalkPanel",css:{left:"50%",bottom:"10px",width:f,minWidth:0,minHeight:0,height:"50px"},title:"",enableSizable:!1},g=e.getToolbar("MainToolbar"),v="",b=g.getControl("Map");b?(v='<div class="bf-button gld-bf-map active"></div>',b.addEventListener(p.StateChange,function(e){if(!e){w.querySelector(".gld-bf-map").removeClass("active")}})):m.css.width="461px"
;var y=new Glodon.Bimface.Application.Panel(m),w=t.create("div","bf-person"),C='<div class="bf-walk-button">'+v+'</div>\n                <div class="bf-walk-button"><div class="bf-button gld-bf-route" title="'+BimfaceLanguage.bf_panel_nav_walkthrough+'"></div></div>\n                      <div class="bf-walk-speed">\n                        <span class="bf-walk-name">'+BimfaceLanguage.bf_panel_nav_speed+'</span>\n                        <span class="gld-bf-minus speedBtn"></span><span class="speedNum">'+u[c]+' X</span>\n                        <span class="gld-bf-add speedBtn"></span>\n                      </div>\n                      <label class="bf-checkbox bf-walk-label">\n                        <input type="checkbox" class="bf-checkbox-input bf-walk-gravity" name="gravity"}>\n                        <span class="bf-checkbox-display"></span>\n                        <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_nav_gravity+'</span>\n                      </label>\n                      <label class="bf-checkbox bf-walk-label">\n                        <input type="checkbox" class="bf-checkbox-input bf-walk-collision" name="collision"}>\n                        <span class="bf-checkbox-display"></span>\n                        <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_nav_collision+'</span>\n                      </label>\n                      <span class="bf-walk-exit">'+BimfaceLanguage.bf_general_exit+"</span>";w.innerHTML=C,w.querySelector(".gld-bf-add").addEventListener("click",o),w.querySelector(".gld-bf-minus").addEventListener("click",i),b&&w.querySelector(".gld-bf-map").addEventListener("click",a),w.querySelector(".gld-bf-route").addEventListener("click",s),y.container.appendChild(w);var M=new Glodon.Bimface.UI.Tips.TipsConfig;M.element=d,M.html="<div>\n                            "+BimfaceLanguage.bf_panel_nav_walkTips1+'\n                            <span class="bf-tips-key">W</span>\n                            <span class="bf-tips-key">A</span>\n                            <span class="bf-tips-key">S</span>\n                            <span class="bf-tips-key">D</span>\n                            '+BimfaceLanguage.bf_panel_nav_walkTips2+'\n                            <span class="bf-tips-key">Q</span>\n                            <span class="bf-tips-key">E</span>\n                            '+BimfaceLanguage.bf_panel_nav_walkTips3+"\n                            </div>";var k=new Glodon.Bimface.UI.Tips.Tips(M);CLOUD.EditorConfig.NoKey&&k.hide(),w.querySelector(".bf-walk-exit").addEventListener("click",function(){y.hide();for(var t=e.getToolbars(),n=0;n<t.length;n++)t[n].show()}),y.addEventListener("Close",function(){k.close()}),y.addEventListener("Hide",function(){k.hide(),d.removeClass("walker");var t=e.getPanel("WalkRoutePanel");t&&t.hide()}),y.addEventListener("Show",function(){CLOUD.EditorConfig.NoKey||k.show(),d.addClass("walker"),b&&a(!0)});var B=w.querySelector(".speedNum"),T=w.querySelector(".bf-walk-gravity");T.addEventListener("change",function(){l.enableGravity(this.checked)});var L=w.querySelector(".bf-walk-collision");return L.addEventListener("change",function(){l.enableHitDetection(this.checked)}),b&&a(!0),y};e.WalkPanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(e){function n(){var e=b[v];L.innerText=e+"X",m.setFlySpeedRate(parseFloat(e))}function o(e){e.preventDefault(),e.stopPropagation(),v<b.length-1&&(v++,n())}function i(e){e.preventDefault(),e.stopPropagation(),v&&(v--,n())}function a(e){e.preventDefault(),e.stopPropagation(),y.moveTo(CLOUD.MoveDirection.UP,1)}function r(e){e.preventDefault(),e.stopPropagation(),y.moveTo(CLOUD.MoveDirection.DOWN,1)}function s(){x=T.getBoundingClientRect(),S=[x.left+.5*x.width,x.top+.5*x.height],P=T.querySelector(".ball"),I=y.getCurrentEditor(),G={panelRadius:x.width/2,radiusPow:Math.pow(x.width/2,2),smallRadiusPow:Math.pow((x.width-P.offsetWidth)/2,2),up:[(x.width-P.offsetWidth)/2,0],down:[(x.width-P.offsetWidth)/2,x.height-P.offsetHeight],left:[0,(x.height-P.offsetHeight)/2],right:[x.width-P.offsetWidth,(x.height-P.offsetHeight)/2],refresh:[(x.width-P.offsetWidth)/2,(x.height-P.offsetHeight)/2]}}function l(e){e.preventDefault(),E=e.touches[0],p()}function d(e){e.preventDefault(),E=e.touches[0],p()}function c(e){h("refresh"),u()}function u(){y.moveTo(CLOUD.MoveDirection.FORWARD,1,!1),y.moveTo(CLOUD.MoveDirection.BACK,1,!1),y.moveTo(CLOUD.MoveDirection.UP,1,!1),y.moveTo(CLOUD.MoveDirection.DOWN,1,!1)}function p(){var e=E.pageY-S[1],t=E.pageX-S[0];_=e/t,h(_>0?_>2.2?e>0?"down":"up":e>0?"right":"left":_<-2.2?e>0?"down":"up":e>0?"left":"right")}function h(e){switch(u(),e){case"up":y.moveTo(CLOUD.MoveDirection.FORWARD,1),y.render();break;case"down":y.moveTo(CLOUD.MoveDirection.BACK,1),y.render();break;case"left":I._doRotate({x:-1,y:0});break;case"right":I._doRotate({x:1,y:0})}"refresh"==e?f():f(E)}function f(e){if(e){var t=e.pageX-S[0],n=e.pageY-S[1],o=Math.pow(t,2),i=Math.pow(n,2),a=i+o;if(Math.sqrt(a)+P.offsetWidth/2<G.panelRadius)var r=e.pageY-P.offsetHeight/2-x.top,s=e.pageX-P.offsetWidth/2-x.left;else{var l=Math.sqrt(G.smallRadiusPow*o/a),d=Math.sqrt(G.smallRadiusPow*i/a);s=e.pageX-S[0]>0?G.panelRadius+l-P.offsetWidth/2:G.panelRadius-l-P.offsetWidth/2,r=e.pageY-S[1]>0?G.panelRadius+d-P.offsetWidth/2:G.panelRadius-d-P.offsetWidth/2}P.style.left=s+"px",P.style.top=r+"px"}else P.style.left=G.refresh[0]+"px",P.style.top=G.refresh[1]+"px"}var m=e.getViewer(),g=e.getRootElement(),v=0,b=["1","2","4","8","16"],y=m.getViewer(),w={element:g,className:"bf-panel bf-walk-panel",id:"WalkPanel",css:{minWidth:"auto",minHeight:"auto",bottom:"0.12em",width:"100%",height:"3.5em"},title:"",enableSizable:!1},C=new Glodon.Bimface.Application.Panel(w),M=t.create("div","bf-quit");M.innerHTML='<span class="bf-walk-exit">'+BimfaceLanguage.bf_general_exit+"</span><span class='close'></span>",g.appendChild(M),C.addEventListener("Show",function(){M.style.display="block"});var k=t.create("div","bf-person"),B='<div class="person-btns">\n\n                      <span class="gld-bf-minus speedBtn"></span>\n                      <span class="speedNum">'+b[v]+' X</span>\n                      <span class="gld-bf-add speedBtn"></span>\n                      <label class="bf-checkbox bf-walk-gravity">\n                        <input type="checkbox" class="bf-checkbox-input bf-walk-input" name="gravity"}>\n                        <span class="bf-checkbox-display"></span>\n                        <span class="bf-checkbox-value">'+BimfaceLanguage.bf_panel_nav_gravity+'</span>\n                      </label>\n                      <div class=\'jump\'>\n\n                        <span class="bf-button gld-bf-up  arrow-up"></span>\n                        <span class="bf-button gld-bf-down  arrow-down"></span>\n                      </div>\n                    </div>',T=t.create("div","controllerPanel");k.innerHTML=B,T.innerHTML='<div class="ball">\n\n                    </div>',T.addEventListener("touchstart",l),T.addEventListener("touchmove",d),T.addEventListener("touchend",c),k.querySelector(".gld-bf-add").addEventListener("click",o),k.querySelector(".gld-bf-minus").addEventListener("click",i),k.querySelector(".arrow-up").addEventListener("touchstart",a),k.querySelector(".arrow-down").addEventListener("touchstart",r),k.querySelector(".arrow-up").addEventListener("touchend",u),k.querySelector(".arrow-down").addEventListener("touchend",u),C.container.appendChild(k),C.element.appendChild(T),M.addEventListener("click",function(){C.hide(),M.style.display="none";for(var t=e.getToolbars(),n=0;n<t.length;n++)t[n].show()});var L=k.querySelector(".speedNum");k.querySelector(".bf-walk-input").addEventListener("change",function(){m.enableGravity(this.checked)});var x,S,P,_,I,G,E;return s(),window.onresize=function(){s()},C};e.WalkMobilePanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),n=function(e,n){var o=e.getViewer(),i=e.getRootElement(),a=o instanceof Glodon.Bimface.Viewer.Viewer3D,r=Glodon.Bimface.UI.Control.ControlEvent,s=Glodon.Bimface.Viewer.Viewer3DEvent;if(!a)return void console.log("The API is not supported on this viewer.");var l=new Glodon.Bimface.UI.Button.ButtonConfig;l.id="Walk",l.title=BimfaceLanguage.bf_btn_nav,l.className="bf-button gld-bf-firstperson";var d,c,u=new Glodon.Bimface.UI.Button.ToggleButton(l);o.getViewer();return u.addEventListener(r.StateChange,function(){if(o.getEventManager().fireEvent(s.ButtonOnToolbarClicked,{id:l.id,isChecked:u.isChecked()}),u.isChecked()){var a=n.getControl("RectangleSelect");a&&a.setCheckedState(!1),o.setNavigationMode(Glodon.Bimface.Viewer.NavigationMode3D.Select);var r=n.getControl("Measure");r&&r.setCheckedState(!1),hideSectionPanel(e);var p=n.getControl("RectangleSelect");p&&p.setCheckedState(!1);var h=n.getControl("Property");h&&h.setCheckedState(!1);var f=n.getControl("Information");f&&f.setCheckedState(!1);var m=n.getControl("Setting");m&&m.setCheckedState(!1),e.modelTreePanel&&e.modelTreePanel.hide();for(var g=e.getToolbars(),v=e.getPanels(),b=0;b<v.length;b++)"WalkPanel"!=v[b].id&&"MapPanel"!=v[b].id&&v[b].isDisplay()&&v[b].hide();for(var y=0;y<g.length;y++)g[y].hide();if(c=!!document.querySelector(".bf-house canvas"),o.setNavigationMode(Glodon.Bimface.Viewer.NavigationMode3D.Walk),o.hideViewHouse(),o.setSelectedComponentsById(),o.render(),d)return void d.show();d=t?new Glodon.Bimface.Application.UI.Panel.WalkPanel(e):new Glodon.Bimface.Application.UI.Panel.WalkMobilePanel(e),d.addEventListener("Hide",function(){u.setCheckedState(!1)}),i.appendChild(d.element),d.bringToFront(),e.addPanel(d)}else{for(var g=e.getToolbars(),y=0;y<g.length;y++)g[y].show();o.setNavigationMode(Glodon.Bimface.Viewer.NavigationMode3D.PickWithRect),c&&o.showViewHouse(),d.hide()}}),u};e.Walk=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="Interactive",a.title="交互",a.inheritTitle=!0;var r=new Glodon.Bimface.UI.Button.ComboBox(a),s=new Glodon.Bimface.UI.Button.ButtonConfig;s.id="OrbitPoint",s.title="绕构件旋转",s.className="bf-button gld-bf-orbit";var l=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(s),d=new Glodon.Bimface.UI.Button.ButtonConfig;d.id="OrbitCamera",d.title="绕相机旋转",d.className="bf-button gld-bf-pan";var c=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(d),u=new Glodon.Bimface.UI.Button.ButtonConfig;u.id="OrbitCamera",u.title="绕相机旋转",u.className="bf-button gld-bf-zoom";var p=new Glodon.Bimface.UI.Button.ComboBoxOptionButton(u);return r.addControl(l),r.addControl(c),r.addControl(p),r.addEventListener(i.Change,function(e){}),r.addEventListener(i.Click,function(e){var n=t.getControl("ViewButton");n&&n.recover()}),r};e.Interactive=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),n=function(t){var n=t.getViewer(),o=new Glodon.Bimface.UI.Panel.PanelConfig;o.title="",o.id="MapPanel",o.css={left:"12px",bottom:"10px",width:"300px",height:"240px"},o.className="bf-panel bf-map bf-map-panel",o.enableSizable=!1;var i=new Glodon.Bimface.UI.Panel.Panel(o),a=Glodon.Bimface.Plugins.Map.MapEvents,r=e.create("div","bf-map-header"),s=e.create("div","bf-map-move"),l=e.create("div","bf-map-foot"),d=e.create("div","bf-map-container"),c=e.create("i","bf-map-fit-panel-min gld-bimface gld-bf-fitpanel"),u=e.create("i","bf-map-screen gld-bimface gld-bf-max-"),p=e.create("div","bf-map-right");l.innerHTML='<div class="bf-map-left"><i class="gld-bimface gld-bf-information"></i><span>'+BimfaceLanguage.bf_panel_map_cut+"</span></div>",l.appendChild(p);var h=new Glodon.Bimface.Plugins.Map.MapConfig;h.viewer=n,h.domElement=d,h.width=298,h.height=198,h.id="Map";var f=new Glodon.Bimface.Plugins.Map.Map(h);t.addPlugin(f);var m=f.getFloorList(),g=new Glodon.Bimface.UI.Select.SelectConfig;g.className="bf-select bf-select-map";var v=f.getDefaultFloorPlane(),b=m.getObjectByAttribute("name",v);0!=b&&(g.default=b.id),g.options=m,g.element=r,g.prefix=BimfaceLanguage.bf_panel_map_level;var y=new Glodon.Bimface.UI.Select.Select(g);y.addEventListener("Change",function(e){f.showFloorById(e.id)}),u.addEventListener("click",function(){i.showAsFull(u.hasClass("gld-bf-max-")),x&&x.hide()}),c.addEventListener("click",function(){f.clearZoomAndPan(),c.getCss().display="none"});var w=function(e){e.getToolbar("MainToolbar");clearSection(e),e.tree&&e.tree.clear(!0),n.restoreDefault()},C=new Glodon.Bimface.UI.Button.ButtonConfig;C.id="mapIsolate",C.title=BimfaceLanguage.bf_panel_map_isolation,C.className="bf-map-button bf-map-isolate";var M=new Glodon.Bimface.UI.Button.Button(C);M.setHtml(BimfaceLanguage.bf_panel_map_isolation),M.addEventListener("Click",function(){w(t);var e=f.getBoundingBox();n.isolateByBox(e,Glodon.Bimface.Viewer.IsolateOption.HideOthers),n.zoomToBoundingBox(e),f.clear(),x.hide(),n.render()});var k=new Glodon.Bimface.UI.Button.ButtonConfig;k.id="mapSection",k.title=BimfaceLanguage.bf_panel_map_section,k.className="bf-map-button bf-map-section";var B=new Glodon.Bimface.UI.Button.Button(k);B.setHtml(BimfaceLanguage.bf_panel_map_section),B.addEventListener("Click",function(){var e=f.getBoundingBox();clearSectionPlane(t),updateSection(t,e),f.clear(),x.hide(),n.render()});var T=new Glodon.Bimface.UI.Button.ButtonConfig;T.id="mapCancel",T.title=BimfaceLanguage.bf_general_cancel,T.className="bf-map-button bf-map-cancel";var L=new Glodon.Bimface.UI.Button.Button(T);L.setHtml(BimfaceLanguage.bf_general_cancel),L.addEventListener("Click",function(){f.clear(),x.hide()});var x;f.addEventListener(a.Zoom,function(e){1==e.zoomFactor?c.getCss().display="none":c.getCss().display="block"}),f.addEventListener(a.MouseHoveredGrid,function(e){p.innerHTML=""}),f.addEventListener(a.FloorPlaneChanged,function(e){y._currentElement.innerText=BimfaceLanguage.bf_panel_map_level+e}),f.addEventListener("MinimapRectChanged",function(e){S(e)}),f.addEventListener("MinimapRectDestroyed",function(e){x&&x.hide()}),r.appendChild(u),r.appendChild(c),r.appendChild(s),i.container.appendChild(r),i.container.appendChild(d),i.container.appendChild(l),i.drag=new Glodon.Web.Lang.Utility.Dom.drag({element:i.element,bBoxDetection:!0,handle:s,record:function(e,t){Glodon.Bimface.UI.Panel.PanelPositions[o.className]={left:e,top:t}}}),i.showAsFull=function(e){e?(u.removeClass("gld-bf-max-"),u.addClass("gld-bf-min-"),i.addClass("bf-map-big"),i.addClass("bf-map-big-panel"),i.element.style.left="50%",i.element.style.top="50%",i.element.style.bottom="initial",c.removeClass("bf-map-fit-panel-min"),c.addClass("bf-map-fit-panel-max"),f.resize(528,420,!0)):(u.removeClass("gld-bf-min-"),u.addClass("gld-bf-max-"),i.removeClass("bf-map-big"),i.removeClass("bf-map-big-panel"),i.element.style.left="12px",i.element.style.top="initial",i.element.style.bottom="10px",c.removeClass("bf-map-fit-panel-max"),c.addClass("bf-map-fit-panel-min"),f.resize(298,198,!1)),c.getCss().display="none"};var S=function(e){if(x)x.show();else{var t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;t.className="bf-map-toolbar",x=new Glodon.Bimface.UI.Toolbar.Toolbar(t),x.addControls([M,B,L]),x.element.style.zIndex=11,d.appendChild(x.element)}var n={width:d.offsetWidth,height:d.offsetHeight},o={width:x.element.offsetWidth,height:x.element.offsetHeight};e.x+e.width<o.width?x.element.style.left=e.x+"px":x.element.style.left=e.x+e.width-o.width+"px",n.height<e.y+e.height+o.height?x.element.style.top=e.y+e.height-o.height-6+"px":x.element.style.top=e.y+e.height+6+"px"};return i};t.MapPanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=e.getRootElement(),i=n instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!i)return void console.log("The API is not supported on this viewer.");var s=new Glodon.Bimface.UI.Button.ButtonConfig;s.id="Map",s.title=BimfaceLanguage.bf_btn_map,s.className="bf-button gld-bf-map";var l,d=new Glodon.Bimface.UI.Button.ToggleButton(s);return d.addEventListener(a.StateChange,function(t){if(l=e.getPanel("MapPanel"))if(t)l.show();else{l.hide();var i=e.getPlugin("Map");i.clearZoomAndPan()}else l=new Glodon.Bimface.Application.UI.Panel.MapPanel(e),l.addEventListener("Hide",function(){d.setCheckedState(!1)}),o.appendChild(l.element),l.bringToFront(),e.addPanel(l),n.render();n.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:s.id,isChecked:t})}),d};e.Map=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=(e.getRootElement(),n instanceof Glodon.Bimface.Viewer.Viewer3D),i=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="SectionDirection",a.title="剖切方向",a.className="bf-button gld-bf-axial";var r=new Glodon.Bimface.UI.Button.Button(a);return r.addEventListener(i.Click,function(){var t=this.hasClass("gld-bf-axial");r.toggleClassName("gld-bf-axial"),r.toggleClassName("gld-bf-axial-");var o=e.getPlugin("SectionPlane");o&&(o.setDirection(t?"Reverse":"Forward"),o.setProgress(50)),n.render()}),r};e.SectionDirection=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(e,t){var n=e.getViewer(),o=n instanceof Glodon.Bimface.Viewer.Viewer3D,i=Glodon.Bimface.UI.Control.ControlEvent;if(!o)return void console.log("The API is not supported on this viewer.");var a=new Glodon.Bimface.UI.Button.ButtonConfig;a.id="SectionRecalculation",a.title=BimfaceLanguage.bf_tip_section_fitBox,a.className="bf-button gld-bf-fittobox";var r=new Glodon.Bimface.UI.Button.Button(a);return r.addEventListener(i.Click,function(){var t=e.getPlugin("SectionBox");t&&t.fitToModel(),n.render()}),r};e.SectionRecalculation=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),n=function(e){var n=new Glodon.Bimface.UI.Panel.PanelConfig;n.title=BimfaceLanguage.bf_panel_explode,n.css=t?{right:"10px",bottom:"60px",width:"200px",height:"90px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"1.02em"},n.enableSizable=!1,n.className="bf-panel bf-explode-panel";var o=new Glodon.Bimface.UI.Panel.Panel(n);if(o.setHtml('<div class="bf-explode-range" id="dispersionRange"></div>'),!t){var i=e.getRootElement(),a=i.offsetWidth,r=i.offsetHeight;o.element.style.fontSize=100*Math.min(r,a,414)/750+"px",o.element.addClass("explode-panel");o.element.querySelector(".bf-close").innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>"}return o};e.ExplodePanel=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),Glodon.Web.Lang.Utility.ClientHelper.getIsIphone(),function(e,t){window.viewer=e.getViewer();var n,o=e.getRootElement(),i=viewer instanceof Glodon.Bimface.Viewer.Viewer3D,a=Glodon.Bimface.UI.Control.ControlEvent,r=Glodon.Bimface.Viewer.Viewer3DEvent;if(!i)return void console.log("The API is not supported on this viewer.");var s=new Glodon.Bimface.UI.Button.ButtonConfig;s.id="Explode",s.title=BimfaceLanguage.bf_btn_explode,s.className="bf-button gld-bf-explode";var l,d=new Glodon.Bimface.UI.Button.ToggleButton(s);return d.addEventListener(a.StateChange,function(i){if(i){var a=t.getControl("Measure");a&&a.setCheckedState(!1),clearSection(e);var c=t.getControl("SectionBox");c&&c.setCheckedState(!1);var u=t.getControl("SectionPlane");u&&u.setCheckedState(!1),viewer.setExplosionExtent(0),viewer.render(),l=new Glodon.Bimface.Application.UI.Panel.ExplodePanel(e),l.addEventListener("Hide",function(){d.setCheckedState(!1)}),o.appendChild(l.element),n=new Glodon.Web.Lang.Utility.Dom.range({element:l.element.querySelector("#dispersionRange"),min:0,cur:0,max:3,step:.1,isShowProgress:!1,defaultColor:"#555555",currentColor:"#999999",input:function(e){viewer.setExplosionExtent(e),viewer.render()}}),e.addPanel(l)}else e.removePanel(l.id),l.close(),viewer.setExplosionExtent(0),viewer.render();viewer.getEventManager().fireEvent(r.ButtonOnToolbarClicked,{id:s.id,isChecked:i})}),d});e.Explode=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(){var e=new Glodon.Bimface.UI.Button.ButtonConfig;return e.id="Drag",e.title=BimfaceLanguage.bf_tip_roomEdit_dragNode,e.className="bf-button gld-bf-room-dragnode",new Glodon.Bimface.UI.Button.ToggleButton(e)};e.RoomEditingDrag=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(){var e=new Glodon.Bimface.UI.Button.ButtonConfig;return e.id="Add",e.title=BimfaceLanguage.bf_tip_roomEdit_addNode,e.className="bf-button gld-bf-room-addnode",new Glodon.Bimface.UI.Button.ToggleButton(e)};e.RoomEditingAdd=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),t=function(){var e=new Glodon.Bimface.UI.Button.ButtonConfig;return e.id="Delete",e.title=BimfaceLanguage.bf_tip_roomEdit_deleteNode,e.className="bf-button gld-bf-room-deletenode",new Glodon.Bimface.UI.Button.ToggleButton(e)};e.RoomEditingDelete=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Toolbar"),t=function(){var e={id:"MainToolbar",title:"主菜单",className:"bf-toolbar bf-toolbar-bottom",buttons:["Home","Person","OrbitButton","RectangleSelect","Measure","Section","Annotation","Property","Information","Setting","FullScreen"]},t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},t,e)};e.MainToolbarConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Toolbar"),t=function(){var e={id:"SectionToolbar",title:"剖切",className:"bf-section-box",buttons:["SectionBoxVisiable","SectionRecalculation","SectionReset"]},t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},t,e)};e.SectionToolbarConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Toolbar"),t=function(){var e={id:"FamilyTypes",title:"FamilyTypes",className:"bf-toolbar bf-toolbar bf-toolbar-select",buttons:["FamilyList"]},t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},t,e)};e.FamilyListConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Toolbar"),t=function(){var e={id:"ModelTree",title:"ModelTree",className:"bf-toolbar bf-toolbar bf-tree-toolbar",buttons:["ModelTree"]},t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig;return Object.assign({},t,e)};e.ModelTree=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Toolbar"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Button"),n=function(e,n){for(var o=new Glodon.Bimface.UI.Toolbar.Toolbar(e),i=0,a=e.buttons.length;i<a;i++)if(t[e.buttons[i]]){var r=t[e.buttons[i]](n,o);o.addControl(r)}return o};e.Toolbar=n}();var isDesktop$1=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();!function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Menu"),t=function(e,t,n){var o=!!Glodon.Bimface.Viewer.ViewerDrawingSet&&e.getViewer()instanceof Glodon.Bimface.Viewer.ViewerDrawingSet,i=o?e.getActiveViewer():e.getViewer(),a=!!Glodon.Bimface.Viewer.Viewer3D&&i instanceof Glodon.Bimface.Viewer.Viewer3D,r=a?e.getRootElement():i.getDomElement(),s=Glodon.Bimface.UI.Control.ControlEvent,l=null,d=new Glodon.Bimface.UI.Menu.MenuConfig;d.element=r;var c=new Glodon.Bimface.UI.Menu.Menu(d),u=function(){c&&(c.destroy(),c=null),r.removeEventListener("mousedown",H),F.removeEventListener("mousedown",H)};if(a){t&&1==t.length&&(l=n[t[0]]);var p,h=e.getToolbar("MainToolbar");h&&(p=h.getControl("Property")||h.getControl("MobileProperty"));var f=new Glodon.Bimface.UI.Menu.MenuItemConfig;f.id="showProperty";var m=new Glodon.Bimface.UI.Menu.MenuItem(f);m.setText(BimfaceLanguage.bf_btn_props),m.addEventListener(s.Click,function(){!p||p.isChecked()||m.isDisabled||p.setCheckedState(!0),u()});var g=new Glodon.Bimface.UI.Menu.MenuItemConfig;g.id="areaProperty";var v=new Glodon.Bimface.UI.Menu.MenuItem(g);v.setText(BimfaceLanguage.bf_tip_props_rooms),v.addEventListener(s.Click,function(){var n=e.getPanel("AreaPropertyPanel");n||(n=new Glodon.Bimface.Application.UI.Panel.AreaPanel(e),n.addEventListener("Close",function(){e.removePanel(n.id)}),n.addEventListener("Hide",function(){n.close()}),showAreaProperty(i,n,l,t[0]),r.appendChild(n.element),n.initPosition(),e.addPanel(n)),u()});var b=new Glodon.Bimface.UI.Menu.MenuItemConfig;b.id="areaEdit";var y=new Glodon.Bimface.UI.Menu.MenuItem(b);y.setText(BimfaceLanguage.bf_contextmenu_roomEdit),y.addEventListener(s.Click,function(){if(u(),isDesktop$1){var n=e.getPlugin("RoomEditorToolbar");if(n){n.roomId=t[0];var o=n.switchToolbar.getControls();n.uncheckOthers("Drag",o),n.roomEditor.activateByRoomId(t[0]),n.roomEditor.onEnter()}else{var a=new Glodon.Bimface.Plugins.SpatialRelation.RoomEditorToolbarConfig;a.viewer=i,a.roomId=t[0],n=new Glodon.Bimface.Plugins.SpatialRelation.RoomEditorToolbar(a),e.addPlugin(n)}n.show()}});var w=new Glodon.Bimface.UI.Menu.MenuItemConfig;w.id="HideComponents";var C=new Glodon.Bimface.UI.Menu.MenuItem(w);C.setText(BimfaceLanguage.bf_contextmenu_hide),C.addEventListener(s.Click,function(){i.hideComponents(t),i.setSelectedComponentsById(),i.render(),u()});var M=new Glodon.Bimface.UI.Menu.MenuItemConfig;M.id="SetComponentsOpacityssddd";var k=new Glodon.Bimface.UI.Menu.MenuItem(M);k.setText(BimfaceLanguage.bf_contextmenu_transparent),k.addEventListener(s.Click,function(){i.setComponentsOpacity(t,Glodon.Bimface.Viewer.OpacityOption.Translucent),i.setSelectedComponentsById(),i.render(),u()});var B=new Glodon.Bimface.UI.Menu.MenuConfig;B.id="IsolateMenu",B.isSubMenu=isDesktop$1&&!0||!1,B.text=BimfaceLanguage.bf_contextmenu_isolate,B.className="bf-sub-menu";var T=new Glodon.Bimface.UI.Menu.Menu(B),L=new Glodon.Bimface.UI.Menu.MenuItemConfig;L.id="HideOthers";var x=new Glodon.Bimface.UI.Menu.MenuItem(L);x.setText(BimfaceLanguage.bf_contextmenu_isolate_hidden),x.addEventListener(s.Click,function(){t&&t.length>0&&(i.isolateComponentsById(t,Glodon.Bimface.Viewer.IsolateOption.HideOthers),i.setSelectedComponentsById(),i.render()),u()});var S=new Glodon.Bimface.UI.Menu.MenuItemConfig;S.id="MakeOthersTranslucent";var P=new Glodon.Bimface.UI.Menu.MenuItem(S);P.setText(BimfaceLanguage.bf_contextmenu_isolate_translucent),P.addEventListener(s.Click,function(){t&&t.length>0&&(i.isolateComponentsById(t,Glodon.Bimface.Viewer.IsolateOption.MakeOthersTranslucent),i.setSelectedComponentsById(),i.render()),u()}),T.addControl(x),T.addControl(P);var _=new Glodon.Bimface.UI.Menu.Spacer,I=new Glodon.Bimface.UI.Menu.Spacer,G=new Glodon.Bimface.UI.Menu.MenuItemConfig;G.id="ShowAll";var E=new Glodon.Bimface.UI.Menu.MenuItem(G);E.setText(BimfaceLanguage.bf_contextmenu_showAll),E.addEventListener(s.Click,function(){resetSection(e),e.tree&&"areaPanel"!=e.tree.element.id&&"drawingPanel"!=e.tree.element.id&&e.tree.clear(!0),i.restoreDefault(),i.render(),u();var t=e.getPlugin("SectionPlane");t&&t.coordinateSystem.update(!0)}),!l||"room"!=l.toLocaleLowerCase()&&"area"!=l.toLocaleLowerCase()?t&&0==t.length?(c.addControl(E),c.oneOption=!0):(p&&(c.addControl(m),c.addControl(_)),c.addControl(C),c.addControl(k),c.addControl(T),c.addControl(I),c.addControl(E),"ExternalComponent"==l&&m.disabled()):(c.addControl(v),c.addControl(y),c.addControl(_),c.addControl(E),!isDesktop$1&&y.disabled(),c.oneOption=!0)}else{var N=t;if(N.length>0){var A=new Glodon.Bimface.UI.Menu.MenuItemConfig;A.id="hideElement";var U=new Glodon.Bimface.UI.Menu.MenuItem(A);U.setText(BimfaceLanguage.bf_contextmenu_hideElement),U.addEventListener(s.Click,function(){i.hideElementsById(N),i.clearSelection(),u()}),c.addControl(U),c.addControl(new Glodon.Bimface.UI.Menu.Spacer);var D=new Glodon.Bimface.UI.Menu.MenuItemConfig;D.id="hideLayer";var z=new Glodon.Bimface.UI.Menu.MenuItem(D);z.setText(BimfaceLanguage.bf_contextmenu_hideLayer),z.addEventListener(s.Click,function(){var e=i.getLayerIdFromElementId(N[0]);i.hideLayer(e),W(e),i.clearSelection(),u()}),c.addControl(z),c.addControl(new Glodon.Bimface.UI.Menu.Spacer)}var G=new Glodon.Bimface.UI.Menu.MenuItemConfig;G.id="showAll";var E=new Glodon.Bimface.UI.Menu.MenuItem(G);E.setText(BimfaceLanguage.bf_contextmenu_showAll),E.addEventListener(s.Click,function(){V(!0),i.showAllLayers(),i.showAllElements(),u()}),c.addControl(E);var V=function(e){var t=document.querySelector(".bf-allLayers");if(t){t.removeClass("disable");var n=t.querySelector(".eyes");n.addClass(e?"gld-bf-show":"gld-bf-hide"),n.removeClass(e?"gld-bf-hide":"gld-bf-show"),n.setAttribute("title",e?"显示":"隐藏");for(var o=t.nextSibling,i=o.querySelectorAll(".bf-layer"),a=0,r=i.length;a<r;++a){var s=i[a],n=s.querySelector(".eyes");e?s.removeClass("disable"):s.addClass("disable"),s.setAttribute("visible",e),n.addClass(e?"gld-bf-show":"gld-bf-hide"),n.removeClass(e?"gld-bf-hide":"gld-bf-show"),n.setAttribute("title",e?"显示":"隐藏")}}},W=function(e){var t=document.querySelector(".bf-layers");if(t)for(var n=t.querySelectorAll(".bf-layer"),o=0,i=n.length;o<i;++o){var a=n[o];if(a.getAttribute("layer-id")==e){a.setAttribute("visible",!1),a.toggleClass("disable");var r=a.querySelector(".eyes");if(r.toggleClass("gld-bf-show"),r.toggleClass("gld-bf-hide"),r.setAttribute("title","隐藏"),0==t.querySelectorAll(".gld-bf-show").length){var s=document.querySelector(".eyes");document.querySelector(".bf-allLayers").addClass("disable"),s.removeClass("gld-bf-show"),s.addClass("gld-bf-hide"),s.setAttribute("title","隐藏")}break}}}}var H=function(){u()};r.addEventListener("mousedown",H);var F=a?i.getDomElement():i.getRootElement();return F.addEventListener("mousedown",H),c};e.ContextMenu=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom")),n=Glodon.Bimface.Data.StatisticsDataManager.getInstance(),o=function(e){var o,i=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();if(i)o=t.create("div","bf-container"),e.EnableFamilyList&&!e.Toolbars.includes("FamilyList")&&e.Toolbars.push("FamilyList"),!e.EnableFamilyList&&e.Toolbars.includes("FamilyList")&&e.Toolbars.removeByValue("FamilyList");else{e.Toolbars=["FamilyList","MainToolbar"],e.Buttons=["Home","ViewButton","Measure","Section","Explode"],e.enableViewHouse=!1,o=t.create("div","bf-container  bf-mobile bf-mobile-rfa");var a=e.domElement.offsetWidth,r=e.domElement.offsetHeight;o.style.fontSize=90*Math.min(a,r,414)/750+"px"}var s=this,l=e;s.toolbars=[],s._rootElement=o,e.domElement.appendChild(o),l.domElement=o,this.getViewer=function(){return d},this.getEventManager=function(){return u},
this.getToolbars=function(){return s.UI.getToolbars()},this.getToolbar=function(e){return"LeftToolbar"==e&&(e="ModelTree"),s.UI.getToolbar(e)},this.render=function(){this.getViewer().render()},this.addView=function(e){d.addView(e)},this.getAnnotationManager=function(){return s.getPlugin("Annotation")},this._mainToolbarAdaptive=function(){var e=s.getToolbars();if(e&&e.length>=2&&!!s.getToolbar("MainToolbar")){var t=s.getToolbar("MainToolbar");s._rootElement.offsetWidth<1e3?t.addClassName("bf-toolbar-bottom-float-right"):t.removeClassName("bf-toolbar-bottom-float-right")}},this.addEventListener=Glodon.Bimface.Viewer.Viewer3D.prototype.addEventListener,this.removeEventListener=Glodon.Bimface.Viewer.Viewer3D.prototype.removeEventListener;var d=new Glodon.Bimface.Viewer.Viewer3D(l),c=Glodon.Bimface.Viewer.Viewer3DEvent,u=d.getEventManager();d.addEventListener(c.ViewAdded,function(e){var t=d.getViewer(),o=t.getNumOfElements(),i=t.getNumOfTriangles(),a={eventId:"加载",loadModel:"normal",type:"rfa",elements:o,triangles:i};n.send("Glodon.Bimface.Application.WebApplicationRfa","ViewAdded",a),d.getFamilyTypes(function(e){d.showFamilyTypeById(e[0].id),d.render()}),s.UI.init(),s._mainToolbarAdaptive(),window.addEventListener("resize",function(e){s._mainToolbarAdaptive()})}),d.addEventListener(c.AddView,function(t){if(1===t){var n=new Glodon.Bimface.Application.UI.UIConfig;n=Object.assign(n,e),n.element=o,n.viewer=d,s.UI=new Glodon.Bimface.Application.UI.UI(n)}}),d.addEventListener(c.RemoveView,function(e){0==e&&(s.UI.destroy(),s.UI=null)})};e.WebApplicationRfa=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(){var e={Toolbars:["MainToolbar","LeftSubToolbar"],Buttons:["Home","RectZoom","FullScreen"]},t=Glodon.Bimface.Viewer.Viewer2DConfig();return Object.assign({},e,t)};e.WebApplication2DConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=Object.freeze({Loaded:"Loaded",Error:"Error"});e.WebApplication2DEvent=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(e){var t=new Glodon.Bimface.UI.Toolbar.ToolbarConfig,n=Object.assign({},t,e);return new Glodon.Bimface.UI.Toolbar.Toolbar(n)},n=function(e){for(var n=[],o=0,i=e.length;o<i;o++)n.push(t(e[o]));this._Toolbars=n};n.prototype.getToolbar=function(e){return this._Toolbars.getObjectByAttribute("id",e)},e.Toolbar=t,e.Toolbars=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(e){var t=new Glodon.Bimface.UI.Button.ButtonConfig,n=Object.assign({type:"Button"},t,e),o=(Glodon.Bimface.UI.Control.ControlEvent,new Glodon.Bimface.UI.Button[n.type](n));for(var i in n.handles)o.addEventListener(i,n.handles[i]);return n.html&&o.setHtml(n.html),o},n=function(e){for(var n=[],o=0,i=e.length;o<i;o++){var a=t(e[o]);if("ComboBox"==e[o].type){var r=e[o].options;for(var s in r)a.addControl(t(r[s]))}n.push(a)}this._Buttons=n};n.prototype.getButtons=function(e){return this._Buttons},n.prototype.getButton=function(e){return this._Buttons.getObjectByAttribute("id",e)},e.Button=t,e.Buttons=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(e){var t=new Glodon.Bimface.UI.Panel.PanelConfig,n=Object.assign({},t.css,e.css),o=Object.assign({},t,e);return o.css=n,new Glodon.Bimface.UI.Panel.Panel(o)};e.Panel=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(e,t,n,o,i){var a=new Glodon.Bimface.UI.Tree.TreeNodeConfig;a.hasCheckbox=o,a.isChecked=!0,a.selection=i;var r=new Glodon.Bimface.UI.Tree.TreeNode(a);return r.element.setAttribute("data-filter",n),r.setTitle(""),r.setData(e,t),r};e.Tree=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom")),n=Glodon.Bimface.Data.StatisticsDataManager.getInstance(),o=function(e){var o,i=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();if(i)o=t.create("div","bf-container");else{e.Toolbars=["LeftSubToolbar"],e.Buttons=[],e.enableViewHouse=!1,o=t.create("div","bf-container  bf-mobile bf-mobile-dwg");var a=e.domElement.offsetHeight;o.style.fontSize=75*a/1340+"px"}var r=this,s=e,l=(Glodon.Bimface.Viewer.NavigationMode2D,Glodon.Bimface.Viewer.Viewer2DEvent);e.domElement.appendChild(o),s.domElement=o;var d=new Glodon.Bimface.Viewer.Viewer2D(s);this.load=function(e){d.load(e)},this.getViewer=function(){return d},this.getToolbars=function(){return g},this.getToolbar=function(e){return g.getToolbar(e)},this._panels={};var c={MainToolbar:{id:"MainToolbar",title:"MainToolbar",element:o,className:"bf-toolbar bf-toolbar-bottom"},LeftSubToolbar:{id:"LeftSubToolbar",title:"LeftSubToolbar",element:o,className:"bf-toolbar bf-toolbar-select"}},u={Home:{id:"Home",title:"适应屏幕",className:"bf-button gld-bf-home",handles:{Click:function(){d.home()}}},RectZoom:{id:"RectZoom",title:"框选",type:"ToggleButton",className:"bf-button gld-bf-zoomrect",handles:{Click:function(){var e=v.getControl("RectZoom");d.rectZoom(),d.addEventListener(Glodon.Bimface.Viewer.Viewer2DEvent.ViewZooming,function(){d.setNavigationMode(Glodon.Bimface.Viewer.NavigationMode2D.Pan),e.setCheckedState(!1),d._opt.enableZoomRect=!1})}}},Information:{id:"Information",title:"关于BIMFACE",className:"bf-button gld-bf-information",type:"ToggleButton",handles:{Click:function(){if(this.hasClass("bf-checked"))if(r._panels.InformationPanel)r._panels.InformationPanel.show();else{var e=new Glodon.Bimface.Application.Panel(p.Information);e.setHtml('<div class="bf-info"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANEAAAAfCAYAAAB52CgrAAAABGdBTUEAALGPC/xhBQAAFJlJREFUeAHlXAt8VcWZn5lzbyAQIIRAoSISEnyBVq1u17oqspqg5WeLq65WixV8oNQVpGopdqtWVizUoi1QFJDCyq9VKau7KyGAPBStRayPtVLzIKBSH0A0JCHJvWdm/9+5Z86dc+85ed5AKPPLZGa++WbmO+fMf75vvjPn8q/s3jDCbrJPZUaQ3KpiPD5MSB7RZNtSasSI/LLdHx4YyBrVWZrupIL9jSnZhymR46P3772lV4OKNDQ1nGfSbcFraoqKt5m0oHywbGrXgZHj3tP8A6pK/4HH+SBdTk1VlFXsLyjZmUrv6rJSiudVrb/UspUIG6tntnr1o+PHHQir13T01Qf50xDzNK2DaRztXuWc17a3PWSguZCNWI/2sr3t28KPMU4AXwGifx61pXGS5zPI96dkMT2Hceg6oog8vbZdlCaM1RhpaoqN54z/C2PqAt2cMzWfSTXZZs7Dc8jgmV5dsS9PgoaGYyEI2iQCV+w55E5VTCbBaIk5/Iu6wXWcC8XV6UypqQb/H/PKS5eeXtRj+WZ+ET3YwODIxtkVTLELNQNX4nHk76RyfnnpWZLxYYrLXynFBmsenXLODnEmLur/QelDB0aW/ARyK13XlWl+1dqT8ipLL2eKD8M9/EHgWJwtbGgSX0XdE4H1IOIe90IyB/EWxB6ImQi0AI1uT0eQoxD8OxD7Ib6O8nm4l3Z7+gjjRV80ka9HvBdxVBhfe+jo83bItyi1DehTQLsP8bjUug6WbfQ5TGCw+Yqp1QDl1rCOuMWnK8m+jRk4Blc8E9e9E+3QJiQQgKQagWlwFTTUjWiTzThf4OdWV71T0fT0GLXJ03b+ekjE2aMA739hvdiSWueUOeunbLWEWeIO8H6SygM571cxiYejZg0oL1vkPrBUtoyW88o3nCptthnAnyO5XIOL2JM2AACEe9KDFqq0OpcAWYci+zbiHYiZAhD1PgJ90yrcnjALzAQgCt9AvNLJdfIf5CCNQPNoBWJGAOSKdJKbOgk9d0Qag4CVKQBR3xZibgTLHfAAICk1DRMWtKRGIi4NIPCNwYSoIhpjcpZSYjYm7mq08zSSU+UCCPSrUV9GNOQnYYxlGGkBCp5GIh4AiQFI14VoJLr4X6LtdNwGdJTUSM5Yic4BJLaEW+ImbhsaibM/o8FeaKgJDhuTtw6oKI3cr9Qt93eROdK/cv1pTMY3YEzHvLQYXwSL+E6uYms8eV0AgWcy7nZLZscStCny2jH2LvIViJ3RpjG0fxr3k9I2Bdx/AvP1Kcw/Qvn3KbSOFJejkfN83MYNSN9C/NQtByWtXf9naDQ7peGdKH/PoH2E/JuIcYPWkez7aPTXhBZIAxKqYNNxkdBADoDShkgCyXuuBoBS2X1AYurrur4NQCIQmkDSTZOpUilA4vlCRO6RdhwPOnnPaeI+VrEuCiDdmGkgDdxVdkY8Fl+P0fK1YBjvRMHi52PxWIWL+C7uqaOBSA7NE5Tiemlilbh1jUgnYOKXBvEeBtoMjJGquc6AjOM6IxPaX45+rzbk/zXy96JPAlLGAsYR6Ow+o0PaDszAOJ0FkNclDZAIGkhk2in2CuORH5IJFwwg3YiAxHcirmGCzyMTDkKbN0YzOinqJmH1zcYFkFr1ArVpzbQDzy9d0+5lr6GZcYDkmnaCz5QyDjNIpW/ElZoIIK28SilSxRkJ+RXrvh6PyY3ozAOQ7him8jSmrFXQ4v9BJlxrAHLbjdftkc7rzGQ1+ml3Fvd8ABrdbDTcbORnGvmOZKcbjZbhGmGSZxZAbv/9kdJ1UChHnI5xMgYg6jTCo9Y0yuggbJsNLyx5ofqjlwbxJlmJh/8zXQcLcK+0xTLBlc9Gz+7R9zVpNfVuamjeDQEXa35LqP0S9gy2jtqedqr6WFlv1kbtch6TL2peSt/dE7sQCU1GJ0AT3sVEEufcthVke167s6K9+lTJpnq//DGZlcsLf7VfVDVwIV7SfaWmGz57eRSA9N6zndwgF5WX96hhVaN5VDyYOoYuSyUOwhpdzISaACB58oq42qd5UtJhRnmLkT/cWdqP9XYHfR3ptYi7EHsiXgCQnYvn/Rry7Qpol40G5xuNOgtIo6u0LI2lwzbIK3UhU2lExez5vs7gRKiuXD9+f1Ex2fEf++paLhxCdeikNZvuRwEeswKYNyOh6bw9Esp/QZW3wVRSPcpsO4kiy5pBsoHH2WPEGg6OAI8nP/ZgtTISnVyjdsMbyHapuL0GqQ/wWg5Re2jmxtp1swCk73YUSAMqN5xToyqvxKSYqGLp3kFnLM439eqd92RT/YErlC3PgGb6vpYBnkXaEz2ty0aaZeTrjfxhy+KaCDwEIh0exgT8BPSnQLjNJdLkJ7OsvYG8ktoSqEa/tI/pqoB1ywtt3gt6LdqQSU5QMGsnglLygja07RQLvM034OoCvHbB3XIAiEn7WwDNmCAOAhCzopNZPP4Yl/bgmqKStYyLCQBmUxA/0TAhrt5YsW5VR0w7AhBMxjLIkxvWP7T4puze+eP3fvXsBrj/bwOADsIkXR7K370qyK2uzWHaQL/gijcPqe3mx+MeeoueS2tL0stg0oaFQTq6sh6INIBa3gNl9uLwAJw9EiZbivvbP44HIMXG+msSJRNAmKi0yjmhq4CkAYR71SYAaXmQ3nE0AAnPhTThXYbcj0BbwGeChTbhoX3GraNVnjx1x3RwQHQkAKTveitAUh0FkO4/00BqI4A2aw2k5TDSowFI10Peoa7Me5CuMuSnLL0A1uEaPMMTdOFYTMWRBJC+4RpIOF3g00hwLPzQMeFCNBDWRc+EMzWQ7lenmQJSOwD0LTLh9PgBqQMkuL6XB9QdURKeBS2s9xhC/ALax7eXQPkd1GunEL0mudvgP+ayES6yXmPCMXGf11dv25JuUmDAcZ1RVkT43hv0ZtGdYO5Zz2LDzUY8bh2UQllcSNMGZiqnV2Xsy/pH0M9ak59Jvt0sk2wKssFm+G9Nt6V6V+f3FZXsyKvaUMCi1lxz99hs9yYb3hcISP0r1uH9C04RhDgbMIFoj8SCnA2dBRCcjAukiDxrCgWvnZ6IJvlI53GP2EmuEOQ9XBIi0MOgX+bWTcK9ewDg+jyE9++aHGF280mYVJNxE0brK7VwggH5EE+bKo3HbK3qyUj+dR1rXC+taBazJfUzTvcD73EZk6wvThT8Y5LGV/PaQ6uwfGFfbp+JfcVEp47zL4QQl2g+J1XxE5VtT4J8p2m6xZyzcxupTIB29rhx+QDev/TVPFn8YCXyFbqsUx+QNDElDQJSZwFEQ0jJpio7/k09HBwMfxCW/SHKuzWtm6TmHudxACNQo4L+Cu7VNsh8HiK5kachzkI85kIED3cJVsmbgIa7TSC16U4AQNAAvSQdqbBjpyohVpIX3gSS2Q9uPI4J8Z04GkPqvxbl9xXjK5C/3AKA9hUWv2HyS9t+UkTErTIuZ5hA0jyCs0Gom88iYjKO/Cw1gaR5UlMNJLy7OtnzMaUwmUB6qWrjWeSFa9GJoOCFy8m/qRUTzhuFAIR3Rn9hNiezabVXEZy5F/J8FlzVbiqZajtw3xcFtcQ4F4N+tltXh5ROEbQUSBv9j8twO9rPQd8HW2pwhOvOh4xPZFAGsnjmQyGoKF6Ith9ILoAgFM7FOae4oRTkw8oSM4OA5AEI5+4w8B/pQuAevhP7nsfwwuCczwuL0zQHWKIypp4UUXFzGJDgMjqOdwBIo9R7Gz+u3IOXUI4nisRJCYqtr15/muDyDLyfm002ZVAQFts+enjPbZv52fGg+lSaBhBOg9yHLv+UWh9Q/nYArTOka/HMluB5+PY5bofmS8/F4KlpZSAyR8m8JkuBPJX0/ujniN01nAzBKGYyvAgQUfADKUFr4b8BoDQuA0jol1Y+cosmNFACQL4mBCR8X0Q0MgcCAmSLMRNIaTypQEpjCCC8x0c1968srYSp+QdUmy83E9wwL62I3Koa2VBoz38P6AIkvtXK4YtCDs+mNTEBlFZ5+AhknqUBHsA6B/SxrhjNSB9186EJniuaqTlg0C+Mp6H8GOih7+ZCOzt6Kw65IKIrSAIJk8ag+69OwYOGs6kjcbMm+WuMUhJIjUBQBKsuVilHAxlMySwBKa+ilB0oGtcqkFScBcpmAglmUm2y9/BcTeG4/wWQrmC2SgcSVz9SjXwpi/L5vJnB7FSn+HviW7P68ss+HVxS76eHlDjAylUuaaAQjjDyQ6igPV4mAjmE6KM83K60YGqhFeDZm8qhVuScwifWpTptfg8+krEAcQji9xEXI3bHsAVCLc+gYO/jPu2JWBG4kY2gJM8tKCpedMCgmVmYbk9Db1yExiSQE/Ch3G7Ycv2U4KTSEwEbFJ6bs6ZnY130UBMbj1X7Bl2F4y6f41O9PjDjyjSN0n6fbCn4cvCFuzTNEtbdjEsMlwgSpwMKikoWatniIloVETGf/LZkkX0jiz3ZdNuwNBBIOGkAk3QQgDOaNcM8sayJ2Me9gH2Zo1lJA7ULQBic94j+jsdi16AHT944E23Z67yIe/1amPyZoGNBJBPnO25f2NWmm2RqRf9hsVjsd6j7msvnJJCNPkybh8ICl057azIXHZevydsN8h9AruWZliNix50bkOzX4nN2V677JxA2JYnJ3IGiEvIorUhS2pRL488rX7vOVqw42ZpvFQfrP0DZA5Et7bnJiYuJKMTc6sqy88HzErWLyNgIuLzpAerQLLiYTN/11BRe4rnCdWVYagIJi4TNIuoRaLznMTaCysMxoolYEhYi/4OOAIh6kQ3217hg/4wJdimVKQgmaU+00ikc2X/3Yni9WK3GRCtPFac53jwFtNNjy3IujE6qS12klqHup4iDEAsRr0IkwB0TwV1Z3Wt1vweSqkOHCjtxw/hWrPqr8bKVvD2BgQAEP/HxzucZgRwMALLgYpezLCmHB7OEUwlIzOJXYC79GDuGnwBAPTQ3Jj4+MOT4PIT9Z3s1kO4D78pmQZG9gn7Walp3SHFtx0OO6wxZ5hh5J6ueGZWF/dxNVICamppaj2tqBG2+QSdQHjMhCaIWPqjr2rvhAsh5N+V8b582nAcgxq5Jq0wQPAABjCeH8LRKJiDxCD5+4/wN8hqaEY2Prxl56ffavAcKGk3Zs7shkGZAVNorUSgDIN5MZJP/mxuq8f5ZDSQKXAkT1Mp82vukBmhqHAJOBPpoz9O4qYx/b+WIc0HdAUDwZngGhXGXDxeA9JDuLwOFODg0VydSAhK3ZjmftSjvY7FOdNjxppjoA9Da0TBuL2laiOjc5lOxODks+B+JxxtvQeEBh+D+A/i+RH+LUNRaiF7adiuta8qbybzAj3w4PyqCG3B1JjturS/8CFDChCMNRAAKDOLnjgkXooHgoGjSJlxnNFDg0F1JdDUSNN6LXTlMG/r+N/D0dvleBxA2pbZp/m3umbi355p0OHhuUZvGJBZgsyJh0pFpR4E+2vtmIpv2n1zoOujxdfmoSyPY/zwXEexiqAFPjcOLvCPsSoZ+WJonrR5JMxCMJw5hX1RXs0hzD//vhTXWZzf3jRwSoPtueP8hg2p3fVjzVHZz3fXQPjP1nhZOjk/McWVUPRux+SVA2FuaDrh5csLJ8eqAirKvYMO+3FRjPAunIrpZwMmQ38AT+kJSLCwBVq+nkuXDm8MEz8GIcJR4IVgLsXguvK4/87h0Ztc7ZNKRk8kLACF9tLcchCkukbTR5W7eTP5mFOh1SQ7a1hm0rsr65m2mBolYgo/Az05NxYXQBtMJFo/TJnGDW/QlDY3qbaUah2oiLn71W7v448IW2fgg7iF4ts9O1jWW1cZxdi6WPDsHwGytr/r4wZ7SvgcA9rxzAMr23KyexV/oxkgtyUdg1bsdmmqYJgMsjyO/nsoDK0qLpJI54HkQxSyiUeCNOFKT+J7eKXeHfzhaNUXavpX5FckaaLEyJ9ThFJVMsjx3wPeRegeQTSGiN9SRdkrTUCZPSn4uyjcjWoj00d5ozJH/M3lQrgX9z6CdiUgTm/ZlPvMQ5UyFJqOj0418xrL4MRq5DCYd/fqJb1VpywgEIFhiO4UtcbQ/Plco8SRcxG+Et004EeA9861sBKC+0Z7F1QUXmRiiY0RLIxaO2Qf9dhsGUdjsA7QzBXc8R6aJEC5Ct6jhL+Msx7OWVL77cLhEwwSmBecuYzzvozuD1qEs5kQVGj7jNsaj9fZIqf0tNgj4wRtFoO6KcACdahPznK4YJwJ7Nwdnz5bhEOckHOL8BQbxNFJLV6QB5J5EeA53y7K5XGQpcRt+tBDKI6mREv34vHCv675DAQQGgCTHjrOlkQibHLc53hklNZJuD/lPwY97OUCSeMkHuqeRNE/3SglA6jmuaC/Ith8h2f4V4x7njr0H6aoMy0Gm4bVun/TR3lTMl9qUMZaifCPiNxDJO7gYfGRevorYGe1ML7Dp14McDYQ0jn7pRTBpOwo0zpVI6R1djAidCHRi4Rlnr5IKpNY6RcPgs3Dw3zpA4nwKYGR0YwDI8MK1BCDdmGSz49wAkq5JpgFASlZ2q5wJIHKm4O/IBDK3dEj76E5XdDTF/HgHE5WcJpch0hyjA6rbEL3gTu7vgLAOUZtZxEexs2EwOvip0cl9yJOT41yXdglSip0OuM4d3kaLJqs27fBwaXUKDmEA0twEJKV+AxPrCeBlO25WoBeO6gJNON2PkSaABI1Epp1QgbIRkLRpJ5nsdqYd4GJooDBvpHHRXZvV94dWfNLeXRFmo1O9ktpBA2BukCPpPMR5iIeCeDpIwzvhZMA4ZM5djLgIMZ6syUhO8QHlpT/2dYXvQcYWFi8M+xmpIVUbT2i2Y9f52wg6oDkQL+LyNR1XYVu5OQuds3ON6lYAM7nscv7x/qKS32resHRA+dqZ/naqbmzhuAVatjBZ3J/7Cuv2iNDJq3ko7T6ovfuLLl2eKhBWN/r8YYhLX4NJ8GkqT2fK6D8H7U9BrETftGfokoBxCtBxP8S3MY4GVOBY4CVX91hEakPydTTQvVqJ8fRC4evHvfbhIPZB9JSIj6nthX0Y56//Dy5GPw14sZShAAAAAElFTkSuQmCC" /><p>Powered by BIMFACE</p><a target="_blank" href="https://bimface.com">https://bimface.com</a></div>'),r._panels.InformationPanel=e,e.addEventListener("Hide",function(){y.getButton("Information").setCheckedState(!1)})}else r._panels.InformationPanel.hide()}}},FullScreen:{id:"FullScreen",title:"全屏",className:"bf-button gld-bf-maximize",handles:{Click:function(){var e=this.hasClass("gld-bf-maximize");d.enableFullScreen(e),Glodon.Web.Lang.Utility.FullScreen.onFullScreenChanged(function(){var t=v.getControl("FullScreen");t.getTitle();t.toggleClassName("gld-bf-maximize"),t.toggleClassName("gld-bf-minimize"),e?t.setTitle("全屏"):t.setTitle("取消全屏")})}}}},p={Information:{element:o,title:"BIMFACE",css:{left:"50%",top:"50%",width:"330px",height:"278px",transform:"translate(-50%,-50%)",zIndex:999},enableSizable:!1}};if(!e.Toolbars||0==e.Toolbars.length)return!1;for(var h=[],f=0,m=e.Toolbars.length;f<m;f++)h.push(c[e.Toolbars[f]]);var g=new Glodon.Bimface.Application.Toolbars(h),v=g.getToolbar("MainToolbar");if(v){for(var b=[],f=0,m=e.Buttons.length;f<m;f++)b.push(u[e.Buttons[f]]);var y=new Glodon.Bimface.Application.Buttons(b);v.addControls(y.getButtons())}var w=g.getToolbar("LeftSubToolbar");w&&d.addEventListener(l.Loaded,function(e){for(var t=e.getViews(),n={type:"ComboBox",id:"Views",inheritTitle:!0,className:"bf-combobox bf-family",options:{},handles:{Change:function(e){d.showViewById(e.id)}}},o=0,i=t.length;o<i;o++){var a=t[o];n.options[a.name]={type:"ComboBoxOptionButton",title:a.name,id:a.id,className:"bf-button",html:'<span class="bf-button-name">'+a.name+"</span>"}}var n=new Glodon.Bimface.Application.Buttons([n]),r=n.getButtons()[0];d.addEventListener(l.ViewChanged,function(e){r.setSelectedControlById(e)}),w.addControls(n.getButtons())}),d.addEventListener(l.Loaded,function(){var e={eventId:"加载",loadModel:"normal",type:"2d"};n.send("Glodon.Bimface.Application.WebApplication2D","Loaded",e)})};e.WebApplication2D=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t="Glodon.Bimface.Application.WebApplicationDemo",n=Glodon.Bimface.Data.StatisticsDataManager.getInstance(),o=function(e,o){var i;if("dwgView"==e.viewType){var a=new Glodon.Bimface.Application.WebApplication2DConfig;a.domElement=o;var r=Glodon.Bimface.Application.ApplicationEvent;i=new Glodon.Bimface.Application.WebApplication2D(a),i.load(e.viewToken),i.addEventListener(r.Loaded,function(){var e={eventId:"加载",loadModel:"normal",type:"demo"};n.send(t,"Loaded",e)})}else if("rfaView"==e.viewType){var a=new Glodon.Bimface.Application.WebApplicationRfaConfig;a.domElement=o;var r=Glodon.Bimface.Application.WebApplicationRfaEvent;i=new Glodon.Bimface.Application.WebApplicationRfa(a),i.addView(e.viewToken),i.addEventListener(r.ViewAdded,function(){var e=i.getViewer().getViewer(),o=e.getNumOfElements(),a=e.getNumOfTriangles(),r={eventId:"加载",loadModel:"normal",type:"demo",elements:o,triangles:a};n.send(t,"ViewAdded",r),i.render()})}else if("drawingView"==e.viewType){var a=new Glodon.Bimface.Application.WebApplicationDrawingConfig;a.domElement=o,a.drawingUrl=e.drawingUrl,a.viewToken=e.viewToken;var r=Glodon.Bimface.Application.WebApplicationDrawingEvent;i=new Glodon.Bimface.Application.WebApplicationDrawing(a),i.load(e.viewToken),i.addEventListener(r.Loaded,function(){var e={eventId:"加载",loadModel:"normal",type:"demo"};n.send(t,"Loaded",e)})}else{var a=new Glodon.Bimface.Application.WebApplication3DConfig;a.domElement=o;var r=Glodon.Bimface.Application.WebApplication3DEvent;i=new Glodon.Bimface.Application.WebApplication3D(a),i.addView(e.viewToken),i.addEventListener(r.ViewAdded,function(){var e=i.getViewer().getViewer(),o=e.getNumOfElements(),a=e.getNumOfTriangles(),r={eventId:"加载",loadModel:"normal",type:"demo",elements:o,triangles:a};n.send(t,"ViewAdded",r)})}this._application=i};o.prototype={hideBimfaceInfo:function(){this._application.getToolbar("MainToolbar").getControl("Information").hide()}},e.WebApplicationDemo=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(){var e={Toolbars:["MainToolbar","LeftSubToolbar"],Buttons:["Home","RectZoom","DrawingMeasure","Map","Layers","Setting","FullScreen"]},t=Glodon.Bimface.Viewer.ViewerDrawingConfig(),n=Object.assign({},e,t);return n.staticPath="/api/Glodon",n};e.WebApplicationDrawingConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=Object.freeze({ViewAdded:"ViewAdded",ViewLoading:"ViewLoading",ComponentsSelectionChanged:"ComponentsSelectionChanged",ComponentsHoverChanged:"ComponentsHoverChanged",Error:"Error",Loaded:"Loaded",MouseClicked:"MouseClicked",MouseDragged:"MouseDragged",ContextMenu:"ContextMenu",Rendered:"Rendered",ViewChanged:"ViewChanged",ViewMoving:"ViewMoving",ViewMoved:"ViewMoved",ViewZooming:"ViewZooming",ViewZoomed:"ViewZoomed",Hover:"Hover",DrawingMeasure:"DrawingMeasure",ZoomFactorChanged:"ZoomFactorChanged"});e.WebApplicationDrawingEvent=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),o=function(e,o){var i=e.getViewer(),a=Glodon.Bimface.Viewer.Viewer3DEvent,r=function(e){};if(l)return l.show(),i.addEventListener(a.ComponentsSelectionChanged,r),l;var s=new Glodon.Bimface.UI.Panel.PanelConfig;s.title=BimfaceLanguage.bf_btn_layers,s.className="bf-panel bf-layers-panell",s.css=n?{left:"10px",top:"10px",width:"300px",height:"416px"}:{left:0,top:0,width:"100%",height:"100%",zIndex:9999};var l=new Glodon.Bimface.UI.Panel.Panel(s);l.element.addClass("layers-panel");var d=e.getLayers();this.layers=d;var c=0;d.map(function(e){e.visible||c++});var u=t.create("ul","bf-layers bf-scroll-bar"),p=t.create("div","bf-allLayers"),h=void 0;c==d.length?(h="gld-bf-hide",p.addClass("disable")):h="gld-bf-show",p.innerHTML="<span title='显示' class='eyes "+h+"'></span><span   class='name'>"+BimfaceLanguage.bf_panel_layers_all+"</span>",p.addEventListener("click",function(){var t=this.hasClass("disable");t?(e.showAllLayers(),f(!0)):(e.hideAllLayers(),f(!1)),this.toggleClass("disable");var n=this.querySelector(".eyes");n.setAttribute("title",t?"显示":"隐藏"),n.toggleClass("gld-bf-show"),n.toggleClass("gld-bf-hide")});var f=function(e){for(var t=u.querySelectorAll(".bf-layer"),n=0,o=t.length;n<o;++n){var i=t[n],a=i.querySelector(".eyes");e?i.removeClass("disable"):i.addClass("disable"),i.setAttribute("visible",e),a.addClass(e?"gld-bf-show":"gld-bf-hide"),a.removeClass(e?"gld-bf-hide":"gld-bf-show"),a.setAttribute("title",e?"显示":"隐藏")}};d=Glodon.Web.Lang.Utility.ClientHelper.sortByName(d);for(var m=0,g=d.length;m<g;++m){var v,b,y=t.create("li","bf-layer"),w=d[m],C=e.getColor(w.color);w.visible?(v="gld-bf-show",b="显示"):(v="gld-bf-hide",b="隐藏",y.addClass("disable")),y.innerHTML="<span title='"+b+"' class='eyes "+v+"'></span><span class='color'style='background:"+C+"'></span><span   class='name'>"+w.name+"</span>",y.setAttribute("layer-id",w.id),y.setAttribute("visible",w.visible),y.addEventListener("click",function(){this.toggleClass("disable");var t=this.querySelector(".eyes");t.toggleClass("gld-bf-show"),t.toggleClass("gld-bf-hide");var n=this.getAttribute("visible"),o=this.getAttribute("layer-id");n="true"!=n,this.setAttribute("visible",n),this.querySelector(".eyes").setAttribute("title",n?"显示":"隐藏");var i=p.querySelector(".eyes");n?(e.showLayer(o),p.removeClass("disable"),i.addClass("gld-bf-show"),i.removeClass("gld-bf-hide"),i.setAttribute("title","显示")):(0==u.querySelectorAll(".gld-bf-show").length&&(p.addClass("disable"),i.removeClass("gld-bf-show"),i.addClass("gld-bf-hide"),i.setAttribute("title","隐藏")),e.hideLayer(o))}),u.appendChild(y)}return l.container.appendChild(p),l.container.appendChild(u),e.changeLayers(d),l.element.setCss({border:"solid 1px #333333"}),l.addEventListener("Hide",function(){o.setCheckedState(!1)}),this.update=function(t){for(var n=0,o=this.layers.length;n<o;++n){var i=this.layers[n];i.id==t.id&&(i.visible=t.visible)}e.changeLayers(this.layers),e.update()},l};e.LayersPanel=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),n=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),o=function(t,o){var i,a=e.create("div","bf-tab-body"),r=e.create("div","bf-tab-container"),s=e.create("div","bf-tab-foot"),l=e.create("ul","bf-measure-tab");s.innerHTML='<div class="settingBtn">'+BimfaceLanguage.bf_panel_measure_setting+"<div>",s.addEventListener("click",function(){u()}),r.appendChild(l),r.appendChild(a),r.appendChild(s);var d={None:BimfaceLanguage.bf_general_none,Meter:"m",Centimeter:"cm",Millimeter:"mm"},c=function(e){if(e){i.setTitleContent(BimfaceLanguage.bf_btn_measure);var t=i.element.querySelector(".bf-close");t.style.display="block",p.style.display="none",r.style.display="block"}else{var t=i.element.querySelector(".bf-close");t.style.display="none",i.setTitleContent(BimfaceLanguage.bf_panel_measure_setting),p.style.display="block",r.style.display="none"}},u=function(e){c(!1);var n,o=t.getPrecision(),a=t.getScale(),r=t.getLengthUnits();n='<ul class="bf-measure-setting">\n                  <li class="bf-measure-scale">\n                      <span >'+BimfaceLanguage.bf_panel_measure_scale+' :</span>\n                      <div class="scaleWrap">\n                          1: <input type="number"min="1" max="2000" value ="'+a+'" >\n                          <span>'+BimfaceLanguage.bf_panel_measure_scaleInput+' </span>\n                      </div>\n                  </li>\n                  <li class="bf-measure-lengthUnits">\n                      <span >'+BimfaceLanguage.bf_panel_measure_units+" :</span>\n                      <div class = 'unit'></div>\n                      </li>\n                  <li class=\"bf-measure-precision\">\n                      <span >"+BimfaceLanguage.bf_panel_measure_precision+" :</span>\n                      <div class = 'unit'></div>\n                  </li>\n\n                </ul>",h.innerHTML=n;var s="";h.querySelector(".scaleWrap input").oninput=function(e){var t=e.target.value;if("."==e.data||"e"==e.data){var n=(t||s).replace(/\./g,"").replace(/e/g,"");e.target.setAttribute("value",n),e.target.value=n}s=e.target.value,!s||s>2e3||s<1?e.target.addClass("error"):e.target.removeClass("error")};var l={type:"ComboBox",id:"units",inheritTitle:!0,className:"bf-combobox",options:{},handles:{Change:function(e){}}},u=new Glodon.Bimface.Application.Button(l);for(var p in d){var g=d[p],v={type:"ComboBoxOptionButton",title:g,id:p,className:"bf-button",html:'<span class="bf-button-name">'+g+"</span>"};u.addControl(new Glodon.Bimface.Application.Button(v))}u.setSelectedControlById(r),h.querySelector(".bf-measure-lengthUnits .unit").appendChild(u.element),u.element.onclick=function(){y.element.removeClass("bf-expand")};var b={type:"ComboBox",id:"units",inheritTitle:!0,className:"bf-combobox",options:{},handles:{Change:function(e){}}},y=new Glodon.Bimface.Application.Button(b),w={0:"0",1:"0.0",2:"0.00",3:"0.000"};for(var p in w){var g=w[p],v={type:"ComboBoxOptionButton",title:g,id:p.toString(),className:"bf-button",html:'<span class="bf-button-name">'+g+"</span>"};y.addControl(new Glodon.Bimface.Application.Button(v))}y.setSelectedControlById(o),h.querySelector(".bf-measure-precision .unit").appendChild(y.element),y.element.onclick=function(){u.element.removeClass("bf-expand")},f.innerHTML="<div class=\"bf-measure-btns\">\n                                    <span class= 'save'>"+BimfaceLanguage.bf_panel_measure_save+" </span> <span class= cancel>"+BimfaceLanguage.bf_general_cancel+"</span>\n                               </div>",f.querySelector(".save").onclick=function(){var e=y.getCurrentControl().id,n=h.querySelector(".scaleWrap input").value,o=u.getCurrentControl().id;n<1||n>2e3||(t.setPrecision(e),t.setScale(n),t.setLengthUnits(o),c(!0),m(i.data),t.viewer.getEventManager().fireEvent("SettingPanelSaved"))},f.querySelector(".cancel").onclick=function(){c(!0)}},p=e.create("div","bf-setting-container"),h=e.create("div","bf-setting-body"),f=e.create("div","bf-setting-foot");p.appendChild(h),p.appendChild(f);var m=function e(n){i.data=n;var o,r=t.getMeasureType(),s=(t.getPrecision(),t.getScale(),t.getLengthUnits());s="None"!=s&&"<span class='units'>"+d[s]+"</span>"||"",l.innerHTML='<li class="bf-measure-tab-item '+(r==Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance&&"bf-active")+'" data-type="Distance">\n          <i class="gld-bimface gld-bf-distance" title="'+BimfaceLanguage.bf_tip_measure_distance+'"></i>\n        </li>\n        <li class="bf-measure-tab-item '+(r==Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Area&&"bf-active")+'" data-type="Area">\n          <i class="gld-bimface gld-bf-area" title="'+BimfaceLanguage.bf_tip_measure_area+'"></i>\n        </li>';for(var c=l.querySelectorAll(".bf-measure-tab-item"),u=0;u<c.length;u++)c[u].addEventListener("click",function(){for(var n=0;n<c.length;n++)c[n].removeClass("bf-active");var o=this.getAttribute("data-type");this.addClass("bf-active"),t.setMeasureType(o),e()});if(r==Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance){var p=n?n.distance:null,h=n?n.distanceX:null,f=n?n.distanceY:null;o='<ul class="bf-measure-info">\n                  <li class="bf-measure-distance">\n                  '+BimfaceLanguage.bf_panel_measure_distance+'\n                    <span class="bf-measure-value">'+(p?p+s:"--")+'</span>\n                    <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span></li>\n                  <li class="bf-measure-x">X： '+(h?h+s:"--")+'</li>\n                  <li class="bf-measure-y">Y： '+(f?f+s:"--")+"</li>\n\n                </ul>"}else{var m=null;n&&(m=n.area),s&&(s+="<i class='square'>2</i>"),o='<ul class="bf-measure-info">\n                <li class="bf-measure-distance">\n                '+BimfaceLanguage.bf_panel_measure_area+'\n                  <span class="bf-measure-value">'+(m?m+s:"--")+'</span>\n                  <span class="bf-measure-reset gld-bimface gld-bf-reset-box" title="'+BimfaceLanguage.bf_tip_section_resetBox+'"><span></li>\n              </ul>'}a.innerHTML=o,a.querySelector(".gld-bf-reset-box").addEventListener("click",function(){t.reset()})},g=new Glodon.Bimface.UI.Panel.PanelConfig;if(g.title=BimfaceLanguage.bf_btn_measure,g.className="bf-panel bf-measurement-panel",g.css=n?{right:"10px",bottom:"220px",width:"200px",height:"220px"}:{maxWidth:"414px",left:"50%",transform:"translate(-50%)",bottom:"0.12em",width:"100%",height:"1.7em"},g.enableSizable=!1,t.viewer.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.Measured,function(e){if(e){var n={type:e.type},o=t.getMeasureParams();if(e.area)n.area=MeasureResultFormat.formatArea(e.area,o);else{var i=e.end[0]-e.start[0],a=e.end[1]-e.start[1],r=Math.sqrt(i*i+a*a);n.distance=MeasureResultFormat.formatDistance(r,o),n.distanceX=MeasureResultFormat.formatDistance(i,o),n.distanceY=MeasureResultFormat.formatDistance(a,o)}m(n)}else m()}),t.viewer.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.MeasureSelected,function(e){if(e.isDataEmpty)return void m();var n=l.querySelectorAll(".bf-measure-tab-item"),o=!0,i=!1,a=void 0;try{for(var r,s=n[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){r.value.removeClass("bf-active")}}catch(e){i=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}var d=!0,c=!1,u=void 0;try{for(var p,h=n[Symbol.iterator]();!(d=(p=h.next()).done);d=!0){var f=p.value;if(f.getAttribute("data-type")===e.type){f.addClass("bf-active");break}}}catch(e){c=!0,u=e}finally{try{!d&&h.return&&h.return()}finally{if(c)throw u}}var g={type:e.type};t.setMeasureType(e.type);var v=t.getMeasureParams();if("Distance"===e.type){var b=e.end[0]-e.start[0],y=e.end[1]-e.start[1],w=Math.sqrt(b*b+y*y);g.distance=MeasureResultFormat.formatDistance(w,v),g.distanceX=MeasureResultFormat.formatDistance(b,v),g.distanceY=MeasureResultFormat.formatDistance(y,v)}else g.area=MeasureResultFormat.formatArea(e.area,v);m(g)}),t.viewer.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.MeasureUnselected,function(e){m()}),t.addEventListener(Glodon.Bimface.Plugins.Measure.MeasureEvent.Reset,function(){m(),c(!0)}),i=new Glodon.Bimface.UI.Panel.Panel(g),i.container.appendChild(r),i.container.appendChild(p),i.bringToFront(),!n){var v=o.offsetWidth,b=o.offsetHeight;i.element.style.fontSize=100*Math.min(v,b,414)/750+"px",i.element.addClass("measure-panel");i.element.querySelector(".bf-close").innerHTML="<span class='quit'>"+BimfaceLanguage.bf_general_exit+"</span>"}return m(),i};t.DrawingMeasurePanel=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=function(e){var n=new Glodon.Bimface.UI.Panel.PanelConfig,o=this;this.viewer=e,this.status={print:e.getDisplayMode()},n.title=BimfaceLanguage.bf_btn_settings,n.css={left:"50%",top:"50%",transform:"translate(-50%,-200px)",width:"330px",height:"auto"},n.enableSizable=!1,n.className="bf-panel bf-settings-panel"
;var i=new Glodon.Bimface.UI.Panel.Panel(n),a=t.create("form","bf-setting"),r=t.create("div","bf-setting-foot"),s='<ul class="bf-setting-tab-default bf-show">\n\n        \n        <li class="bf-setting-li">\n          <span class="bf-setting-name">'+BimfaceLanguage.bf_panel_settings_displayMode+'</span>\n          <div class="bf-setting-value printmode">\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input normal" name=\'menu\' mode="普通模式" '+(0==this.status.print?"checked":"")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_normalMode+'</span>\n            </label>\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name=\'menu\' mode="白底模式" '+(1==this.status.print?"checked":"")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_whiteBgMode+'</span>\n            </label>\n            <label class="bf-radio">\n              <input type="radio" class="bf-radio-input" name=\'menu\' mode="黑白模式" '+(2==this.status.print?"checked":"")+'>\n              <span class="bf-radio-display"></span>\n              <span class="bf-radio-value">'+BimfaceLanguage.bf_panel_settings_monoBgMode+"</span>\n            </label>\n          </div>\n        </li>\n        </ul>\n       ",l='<div class="bf-reset">\n          <span class="reset">'+BimfaceLanguage.bf_panel_settings_restore+"</span>\n        </div>";a.innerHTML=s,r.innerHTML=l;for(var d=a.querySelectorAll(".printmode .bf-radio-input"),c=0,u=d.length;c<u;c++)!function(t,n){d[t].addEventListener("change",function(){var n=t;e.setDisplayMode(n)})}(c);return r.querySelector(".reset").addEventListener("click",function(){d[o.status.print].click()}),i.container.appendChild(a),i.container.appendChild(r),i};e.PrintModePanel=n}(),function(){var e=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application")),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),Glodon.Bimface.Data.StatisticsDataManager.getInstance()),n=function(e){function n(t){if(s&&s._Toolbars&&s._Toolbars.length>0)for(var n=0,o=s._Toolbars.length;n<o;n++)s._Toolbars[n].destroy();var l=a.getViewer(),u=a.getDomElement();a.enableFullScreen=function(e){e?Glodon.Web.Lang.Utility.FullScreen.fullScreen(u):Glodon.Web.Lang.Utility.FullScreen.exitFullScreen()};var p,h,f,m,g,v,b={MainToolbar:{id:"MainToolbar",title:"MainToolbar",element:u,className:"bf-toolbar bf-toolbar-bottom"},LeftSubToolbar:{id:"LeftSubToolbar",title:"LeftSubToolbar",element:u,className:"bf-toolbar bf-toolbar-select"}},y=!1,w={},C={},M={Home:{id:"Home",title:BimfaceLanguage.bf_btn_home,className:"bf-button gld-bf-home",handles:{Click:function(){a.home()}}},Layers:{id:"Layers",title:BimfaceLanguage.bf_btn_layers,type:"ToggleButton",className:"bf-button gld-bf-layers",handles:{Click:function(){var e=B.getControl("Layers");e._checked?(e.setCheckedState(!0),p?p.show():(p=new Glodon.Bimface.Application.UI.Panel.LayersPanel(a,e),i||p.element.addClass("layers-panel"),u.appendChild(p.element))):(e.setCheckedState(!1),p.hide()),e.addEventListener(d.StateChange,function(e){e||p.hide()})}}},Setting:{id:"Setting",title:BimfaceLanguage.bf_btn_settings,type:"ToggleButton",className:"bf-button gld-bf-settings",handles:{Click:function(){var e=B.getControl("Setting");if(e._checked){if(v)return v.show();v=new Glodon.Bimface.Application.UI.Panel.PrintModePanel(a),v.addEventListener("Hide",function(){e.setCheckedState(!1),v.isShow&&v.hide()}),u.appendChild(v.element)}else v.toggle()}}},DrawingMeasure:{id:"DrawingMeasure",title:BimfaceLanguage.bf_btn_measure,type:"ToggleButton",className:"bf-button gld-bf-measure",handles:{Click:function(){var e=r.getViewer();if(!h){var n=new Glodon.Bimface.Plugins.Measure.MeasureConfig;n.viewer=e,h=new Glodon.Bimface.Plugins.Measure.Measure(n),r._plugins.push(h)}var o=B.getControl("DrawingMeasure"),i=l;o._checked?(o.setCheckedState(!0),f||(f=new Glodon.Bimface.Application.UI.Panel.DrawingMeasurePanel(h,u),u.appendChild(f.element)),f.show(),r.isMeasureEventAdded||f.addEventListener("Hide",function(){o._checked&&o.setCheckedState(!1),h.switchOff()}),h.switchOn()):(o.setCheckedState(!1),f.hide(),h.switchOff()),e.getEventManager().fireEvent(c.ButtonOnToolbarClicked,{id:"Measure",isChecked:o._checked}),r.isMeasureEventAdded||o.addEventListener(d.StateChange,function(n){n||(h.setMeasureType(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance),t.activeEditorByName("pick"),i.update(),f.hide(),e.getEventManager().fireEvent(c.ButtonOnToolbarClicked,{id:"Measure",isChecked:n}))}),r.isMeasureEventAdded=!0}}},RectZoom:{id:"RectZoom",title:BimfaceLanguage.bf_btn_zoom,type:"ToggleButton",className:"bf-button gld-bf-zoomrect",handles:{Click:function(){var e=B.getControl("RectZoom"),n=!1;!e._checked&&n?(t.activeEditorByName("pick"),n=!1):(a.rectZoom(),n=!0,a.addEventListener(c.ViewZoomed,function(){e._checked&&n&&setTimeout(function(){e.setCheckedState(!1)},200)})),e.addEventListener(d.StateChange,function(e){if(!e&&n){n=!1;var o=B.getControl("DrawingMeasure");o&&o._checked?t.activeEditorByName("measure"):t.activeEditorByName("pick")}})}}},Annotation:{id:"Annotation",title:"批注",className:"bf-button gld-bf-notes",handles:{Click:function(){if(!m){var e=new Glodon.Bimface.Plugins.Annotation.AnnotationToolbarConfig;e.viewer=a,m=r._annotation=new Glodon.Bimface.Plugins.Annotation.AnnotationToolbar(e),g=Glodon.Bimface.Plugins.Annotation.AnnotationToolbarEvent}B.hide();var t=B.getControl("Measure");t&&t.setCheckedState(!1);var n=B.getControl("DrawingMeasure"),o=B.getControl("Layers");n._checked&&n.toggleCheckedState(),o._checked&&o.toggleCheckedState(),m.show(),y=!0,w={},m.addEventListener(g.Saved,function(){B.show(),y=!1}),m.addEventListener(g.Cancelled,function(){B.show(),y=!1})}}},FullScreen:{id:"FullScreen",title:BimfaceLanguage.bf_btn_fullScreen,className:"bf-button gld-bf-maximize",handles:{Click:function(){var e=this.hasClass("gld-bf-maximize");a.enableFullScreen(e),Glodon.Web.Lang.Utility.FullScreen.onFullScreenChanged(function(){var t=B.getControl("FullScreen");t.getTitle();t.toggleClassName("gld-bf-maximize"),t.toggleClassName("gld-bf-minimize"),e?t.setTitle(BimfaceLanguage.bf_btn_fullScreen_exit):t.setTitle(BimfaceLanguage.bf_btn_fullScreen)})}}},Map:{id:"Map",title:BimfaceLanguage.bf_btn_map,type:"ToggleButton",className:"bf-button gld-bf-map",handles:{Click:function(){var e=B.getControl("Map");e._checked?(e.setCheckedState(!0),a.enableMiniMap(!0)):(e.setCheckedState(!1),a.enableMiniMap(!1))}}}};if(document.addEventListener("keydown",function(e){if(27==e.which){var t=B.getControl("DrawingMeasure"),n=B.getControl("RectZoom");t&&(f&&f.data?h.reset():t.setCheckedState(!1)),n&&n.setCheckedState(!1)}}),!e.Toolbars||0==e.Toolbars.length)return!1;for(var k=[],n=0,o=e.Toolbars.length;n<o;n++)k.push(b[e.Toolbars[n]]);s=new Glodon.Bimface.Application.Toolbars(k);var B=s.getToolbar("MainToolbar");if(B){for(var T=[],n=0,o=e.Buttons.length;n<o;n++)T.push(M[e.Buttons[n]]);var L=new Glodon.Bimface.Application.Buttons(T);B.addControls(L.getButtons())}var x=s.getToolbar("LeftSubToolbar");if(x){var S=l.getLayouts(),P={type:"ComboBox",id:"Views",inheritTitle:!0,className:"bf-combobox bf-family",options:{},handles:{Change:function(e){B.getControl("DrawingMeasure");f&&f.hide();var t=a.getCurrentViewId();y&&(w[t]=m._annotationManager.getAnnotationList()),C[t]=a.getCurrentState(),"Model"==e.id?(i||document.querySelector(".gld-bf-measure").setCss({display:"block"}),a.showViewById(0)):(i||document.querySelector(".gld-bf-measure").setCss({display:"none"}),a.showViewById(e.id)),setTimeout(function(){a.update(!0)},100),y&&w[e.id]&&m._annotationManager.setAnnotationList(w[e.id]);var n="Model"==e.id&&"0"||e.id;C[n]&&a.setState(C[n]);var o=B.getControl("Map");"Model"!=e.id?o&&(o.element.style.display="none"):o&&(o.element.style.display="inline-block");var r="Model"===e.id?0:e.id;a.getEventManager().fireEvent(c.ButtonOnToolbarClicked,{id:"LeftSubToolbar",viewId:r})}}};if(P.options.Model={type:"ComboBoxOptionButton",title:"Model",id:"model",className:"bf-button",html:'<span class="bf-button-name">Model</span>'},S.length)for(var n=0,o=S.length;n<o;n++){var _=S[n];P.options[_.name]={type:"ComboBoxOptionButton",title:_.name,id:_.id||"Model",className:"bf-button",html:'<span class="bf-button-name">'+_.name+"</span>"}}var P=new Glodon.Bimface.Application.Buttons([P]),I=P.getButtons()[0],G=a.getCurrentViewId();a.addEventListener(c.ViewChanged,function(e){I.setSelectedControlById(e||"Model")}),x.addControls(P.getButtons()),G?(I._currentControl.setCheckedState(!1),I.setSelectedControlById(G)):I.setSelectedControlById("Model")}a.getManifest(function(e){var t=e.Features,n=!0,o=!0;t&&(n=t.HasLayout,o=t.HasMiniMap),!o&&i&&B.removeControl("Map"),n||x.destroy()})}function o(e){a.contextMenu&&a.contextMenu.element&&a.contextMenu.destroy();var t=e.clientPosition,n=e.containerBox,o=a.getSelectedIds(),i=new Glodon.Bimface.Application.UI.Menu.ContextMenu(r,o),s={},l=i.element.getBoundingClientRect();n.width-t.x>2*l.width?(s.x=t.x,i.element.removeClass("bf-menu-left"),i.element.addClass("bf-menu-right")):(s.x=t.x-l.width,i.element.addClass("bf-menu-left"),i.element.removeClass("bf-menu-right")),n.height-t.y>l.height?s.y=t.y:s.y=t.y-l.height,i.setPosition(s),a.contextMenu=i}var i=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop();this._plugins=[],this.isMeasureEventAdded=!1;var a,r=this,s=[],l=e,d=Glodon.Bimface.UI.Control.ControlEvent,c=Glodon.Bimface.Viewer.ViewerDrawingEvent;i||(e.Buttons=["Home","DrawingMeasure","Layers"]);var u=new Glodon.Web.Lang.EventManager;this.getEventManager=function(){return u},a=new Glodon.Bimface.Viewer.ViewerDrawing(l),a.addEventListener(c.ViewChanged,function(e){r.getEventManager().fireEvent(c.ViewChanged,e)}),a.addEventListener(c.ContextMenu,o),this.addEventListener=function(e,t){this.getEventManager().addEvent(e,t)},this.removeEventListener=function(e,t){this.getEventManager().removeEvent(e,t)},this.loadFrame=function(e,t){a.loadFrame(e,t)},this.getRenderInfo=function(e,t){a.getRenderInfo(e,t)},a.addEventListener(c.Loaded,function(e){var o={eventId:"加载",loadModel:"normal",type:"drawing"};t.send("Glodon.Bimface.Application.WebApplicationDrawing","Loaded",o),n(e),r._mainToolbarAdaptive(),window.addEventListener("resize",function(e){r._mainToolbarAdaptive()})}),this.getViewer=function(){return a},this.getDrawingFrame=function(e){a.getDrawingFrame(e)},this.load=function(e,t){a.load(e,t)},this.getAxisInfo=function(e){a.getAxisInfo(e)},this.getToolbars=function(){return s},this.getPlugin=function(e){var t=!0,n=!1,o=void 0;try{for(var i,a=this._plugins[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var r=i.value;if(r.id===e)return r}}catch(e){n=!0,o=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw o}}return null},this.getToolbar=function(e){return s.getToolbar(e)},this._mainToolbarAdaptive=function(){var e=r.getToolbars();if(e&&e._Toolbars&&e._Toolbars.length>=2&&!!r.getToolbar("MainToolbar")){var t=r.getToolbar("MainToolbar");a.getDomElement().offsetWidth<1e3?t.addClassName("bf-toolbar-bottom-float-right"):t.removeClassName("bf-toolbar-bottom-float-right")}}};e.WebApplicationDrawing=n}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(){var e={Toolbars:["MainToolbar","LeftSubToolbar"],Buttons:["Home","RectZoom","DrawingMeasure","Layers","Annotation","FullScreen","Setting"]},t=Glodon.Bimface.Viewer.ViewerDrawingSetConfig(),n=Object.assign({},e,t);return n.staticPath="/api/Glodon",n};e.WebApplicationDrawingSetConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=Object.freeze({ViewAdded:"ViewAdded",ViewLoading:"ViewLoading",ComponentsSelectionChanged:"ComponentsSelectionChanged",ComponentsHoverChanged:"ComponentsHoverChanged",Error:"Error",Loaded:"Loaded",MouseClicked:"MouseClicked",MouseDragged:"MouseDragged",ContextMenu:"ContextMenu",ActiveViewChanged:"ActiveViewChanged",Rendered:"Rendered",ViewChanged:"ViewChanged",ViewMoving:"ViewMoving",ViewMoved:"ViewMoved",ViewZooming:"ViewZooming",ViewZoomed:"ViewZoomed",AddDrawing:"AddDrawing",Hover:"Hover",ZoomFactorChanged:"ZoomFactorChanged",DrawingMeasure:"DrawingMeasure"});e.WebApplicationDrawingSetEvent=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI.Panel"),t=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),n=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),o=function(e,o){var i,a=this,r=Glodon.Bimface.Viewer.Viewer3DEvent,s=[];if(e.sets.forEach(function(e){s.push(e.viewerDrawing),e.active&&(i=e.fileName)}),d)return d.show(),s.forEach(function(e){e.getViewer().addEventListener(r.ComponentsSelectionChanged,showLayers)}),d;var l=new Glodon.Bimface.UI.Panel.PanelConfig;l.title=BimfaceLanguage.bf_btn_layers,l.className="bf-panel bf-layers-panell",l.id="layersSet",l.css=n?{left:"10px",top:"10px",width:"300px",height:"416px"}:{left:0,top:0,width:"100%",height:"100%",zIndex:9999};var d=new Glodon.Bimface.UI.Panel.Panel(l);d.element.addClass("layers-panel");var c=0,u=[],p=t.create("ul","bf-layers bf-scroll-bar");s.forEach(function(e){var n=e.getLayers();a.layers=n,n.map(function(e){e.visible||c++}),n=Glodon.Web.Lang.Utility.ClientHelper.sortByName(n),u.push(n);for(var o=0,r=n.length;o<r;++o){var s,l,d=t.create("li","bf-layer"),f=n[o],m=e.getColor(f.color);f.visible?(s="gld-bf-show",l="显示"):(s="gld-bf-hide",l="隐藏",d.addClass("disable"));var g=e._viewMetaData.name,v=g.split(".dwg")[0];g=g==i?"":v+" | ",d.innerHTML="<span title='"+l+"' class='eyes "+s+"'></span>\n                        <span class='color'style='background:"+m+"'></span>\n                        <span class='name'>"+g+f.name+"</span>",d.setAttribute("layer-id",f.id),d.setAttribute("visible",f.visible),d.addEventListener("click",function(){this.toggleClass("disable");var t=this.querySelector(".eyes");t.toggleClass("gld-bf-show"),t.toggleClass("gld-bf-hide");var n=this.getAttribute("visible"),o=this.getAttribute("layer-id");n="true"!=n,this.setAttribute("visible",n),this.querySelector(".eyes").setAttribute("title",n?"显示":"隐藏");var i=h.querySelector(".eyes");n?(e.showLayer(o),h.removeClass("disable"),i.addClass("gld-bf-show"),i.removeClass("gld-bf-hide"),i.setAttribute("title","显示")):(0==p.querySelectorAll(".gld-bf-show").length&&(h.addClass("disable"),i.removeClass("gld-bf-show"),i.addClass("gld-bf-hide"),i.setAttribute("title","隐藏")),e.hideLayer(o))}),p.appendChild(d)}e.changeLayers(n)});var h=t.create("div","bf-allLayers"),f=void 0;c==u.length?(f="gld-bf-hide",h.addClass("disable")):f="gld-bf-show",h.innerHTML="<span title='显示' class='eyes "+f+"'></span><span class='name'>"+BimfaceLanguage.bf_panel_layers_all+"</span>",h.addEventListener("click",function(){var e=this.hasClass("disable");e?s.forEach(function(e){e.showAllLayers(),m(!0)}):s.forEach(function(e){e.hideAllLayers(),m(!1)}),this.toggleClass("disable");var t=this.querySelector(".eyes");t.setAttribute("title",e?"显示":"隐藏"),t.toggleClass("gld-bf-show"),t.toggleClass("gld-bf-hide")});var m=function(e){for(var t=document.querySelectorAll(".bf-layer"),n=0,o=t.length;n<o;++n){var i=t[n],a=i.querySelector(".eyes");e?i.removeClass("disable"):i.addClass("disable"),i.setAttribute("visible",e),a.addClass(e?"gld-bf-show":"gld-bf-hide"),a.removeClass(e?"gld-bf-hide":"gld-bf-show"),a.setAttribute("title",e?"显示":"隐藏")}};return d.container.appendChild(h),d.container.appendChild(p),d.element.setCss({border:"solid 1px #333333"}),d.addEventListener("Hide",function(){o.setCheckedState(!1)}),d};e.LayersSetPanel=o}(),function(){var e=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application")),t=(Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Viewer"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility"),Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Web.Lang.Utility.Dom"),"Glodon.Bimface.Application.WebApplicationDrawingSet"),n=Glodon.Bimface.Data.StatisticsDataManager.getInstance(),o=function(e){function o(){var o={eventId:"加载",loadModel:"normal",type:"DrawingSet"};if(n.send(t,"Loaded",o),l&&l._Toolbars&&l._Toolbars.length>0)for(var i=0,d=l._Toolbars.length;i<d;i++)l._Toolbars[i].destroy();var c,f,m,g,v,b,y={MainToolbar:{id:"MainToolbar",title:"MainToolbar",element:h,className:"bf-toolbar bf-toolbar-bottom"},LeftSubToolbar:{id:"LeftSubToolbar",title:"LeftSubToolbar",element:h,className:"bf-toolbar bf-toolbar-select"}},w={Home:{id:"Home",title:BimfaceLanguage.bf_btn_home,className:"bf-button gld-bf-home",handles:{Click:function(){s.getViewer().home()}}},Layers:{id:"Layers",title:BimfaceLanguage.bf_btn_layers,type:"ToggleButton",className:"bf-button gld-bf-layers",handles:{Click:function(){var e=M.getControl("Layers");e._checked?(e.setCheckedState(!0),c?c.show():(c=new Glodon.Bimface.Application.UI.Panel.LayersSetPanel(a,e),r||c.element.addClass("layers-panel"),h.appendChild(c.element),s.addPanel(c))):(e.setCheckedState(!1),c.hide()),e.addEventListener(u.StateChange,function(e){e||c.hide()})}}},PrintMode:{id:"PrintMode",title:BimfaceLanguage.bf_btn_settings,type:"ToggleButton",className:"bf-button gld-bf-settings",handles:{Click:function(){var e=M.getControl("PrintMode");if(e._checked){if(b)return b.show();b=new Glodon.Bimface.Application.UI.Panel.PrintModePanel(s.getActiveViewer()),b.addEventListener("Hide",function(){e.setCheckedState(!1),b.isShow&&b.hide()}),h.appendChild(b.element)}else b.toggle()}}},DrawingMeasure:{id:"DrawingMeasure",title:BimfaceLanguage.bf_btn_measure,type:"ToggleButton",className:"bf-button gld-bf-measure",handles:{Click:function(){var e=s.getActiveViewer();s.getViewer().getActiveDrawing();if(!m){var t=new Glodon.Bimface.Plugins.Measure.MeasureConfig;t.viewer=e,m=new Glodon.Bimface.Plugins.Measure.Measure(t)}var n=e.getDomElement(),o=M.getControl("DrawingMeasure");if(o._checked){o.setCheckedState(!0);var i=s.getViewer();m.addEventListener("typeChange",function(){s.getActiveViewer().getViewer().mouseEditorMgr.editors[0].captureFail=function(e,t,n){return e&&i.verify(e,t,n),!1}}),f=new Glodon.Bimface.Application.UI.Panel.DrawingMeasurePanel(m,n),f.addEventListener("Hide",function(){o.setCheckedState(!1),m.switchOff(),e.getEventManager().fireEvent("ButtonOnToolbarClicked",{id:"Measure",isChecked:!1})}),n.appendChild(f.element),m.switchOn(),s.getActiveViewer().getViewer().mouseEditorMgr.editors[0].captureFail=function(e,t,n){return i.verify(e,t,n),!1}}else o.setCheckedState(!1),n.removeChild(f.element),f=null,m.switchOff();e.getEventManager().fireEvent("ButtonOnToolbarClicked",{id:"Measure",isChecked:o._checked}),o.addEventListener(u.StateChange,function(e){if(!e){m.setMeasureType(Glodon.Bimface.Plugins.Measure.MeasureTypeOption.Distance);var t=s.getActiveViewer();t.getViewer().mouseEditorMgr.activeEditorByName("pick"),t.update(),f.hide()}})}}},RectZoom:{id:"RectZoom",title:BimfaceLanguage.bf_btn_zoom,type:"ToggleButton",className:"bf-button gld-bf-zoomrect",handles:{Click:function(){var e=M.getControl("RectZoom"),t=!1;!e._checked&&t?(a.setNavigationMode("pick"),t=!1):(a.rectZoom(),t=!0,a.addEventListener(p.ViewZoomed,function(){e._checked&&t&&setTimeout(function(){e.setCheckedState(!1),a.isAlignment&&a.startMoving(!0)},200)})),e.addEventListener(u.StateChange,function(e){if(!e&&t){t=!1;var n=M.getControl("DrawingMeasure");n&&n._checked?a.setNavigationMode("measure"):a.isAlignment?a.startMoving(!0):a.setNavigationMode("pick")}})}}},Annotation:{id:"Annotation",title:"批注",className:"bf-button gld-bf-notes",handles:{Click:function(){var e=new Glodon.Bimface.Plugins.Annotation.AnnotationToolbarConfig,t=s.getActiveViewer();e.viewer=t,g=s._annotation=new Glodon.Bimface.Plugins.Annotation.AnnotationToolbar(e),v=Glodon.Bimface.Plugins.Annotation.AnnotationToolbarEvent,M.hide();var n=M.getControl("Measure");n&&n.setCheckedState(!1);var o=M.getControl("DrawingMeasure");o._checked&&o.toggleCheckedState(),g.show(),g.addEventListener(v.Saved,function(){M.show(),t.setNavigationMode("pick")}),g.addEventListener(v.Cancelled,function(){M.show(),t.setNavigationMode("pick")})}}},FullScreen:{id:"FullScreen",title:BimfaceLanguage.bf_btn_fullScreen,className:"bf-button gld-bf-maximize",handles:{Click:function(){var e=this.hasClass("gld-bf-maximize");a.enableFullScreen(e),Glodon.Web.Lang.Utility.FullScreen.onFullScreenChanged(function(){var t=M.getControl("FullScreen");t.getTitle();t.toggleClassName("gld-bf-maximize"),t.toggleClassName("gld-bf-minimize"),e?t.setTitle(BimfaceLanguage.bf_btn_fullScreen_exit):t.setTitle(BimfaceLanguage.bf_btn_fullScreen)})}}},Setting:{id:"Setting",title:BimfaceLanguage.bf_btn_settings,type:"ToggleButton",className:"bf-button gld-bf-settings",handles:{Click:function(){var e=M.getControl("Setting");if(e._checked){if(b)return b.show();b=new Glodon.Bimface.Application.UI.Panel.PrintModePanel(a),b.addEventListener("Hide",function(){e.setCheckedState(!1),b.isShow&&b.hide()}),h.appendChild(b.element)}else b.toggle()}}}};if(document.addEventListener("keydown",function(e){if(27==e.which){var t=M.getControl("DrawingMeasure"),n=M.getControl("RectZoom");t&&(f&&f.data?m.reset():t.setCheckedState(!1)),n&&n.setCheckedState(!1)}}),!e.Toolbars||0==e.Toolbars.length)return!1;for(var C=[],i=0,d=e.Toolbars.length;i<d;i++)C.push(y[e.Toolbars[i]]);l=new Glodon.Bimface.Application.Toolbars(C);var M=l.getToolbar("MainToolbar");if(M){for(var k=[],i=0,d=e.Buttons.length;i<d;i++)k.push(w[e.Buttons[i]]);var B=new Glodon.Bimface.Application.Buttons(k);M.addControls(B.getButtons())}var T=function(e){e&&L.removeControl("Views");var t=s.getActiveViewer(),n=t.getViews(),o={type:"ComboBox",id:"Views",inheritTitle:!0,className:"bf-combobox bf-family",options:{},handles:{Change:function(e){M.getControl("DrawingMeasure");f&&f.hide(),"Model"==e.id?(r||document.querySelector(".gld-bf-measure").setCss({display:"block"}),t.showViewById(0)):(r||document.querySelector(".gld-bf-measure").setCss({display:"none"}),t.showViewById(e.id)),t.update(!0),t.getEventManager().fireEvent("ButtonOnToolbarClicked",{id:"LeftSubToolbar"})}}};if(o.options.Model={type:"ComboBoxOptionButton",title:"Model",id:"model",className:"bf-button",html:'<span class="bf-button-name">Model</span>'},n.length)for(var i=0,a=n.length;i<a;i++){var l=n[i];o.options[l.name]={type:"ComboBoxOptionButton",title:l.name,id:l.id||"Model",className:"bf-button",html:'<span class="bf-button-name">'+l.name+"</span>"}}var o=new Glodon.Bimface.Application.Buttons([o]),d=o.getButtons()[0],c=t.getCurrentViewId();t.addEventListener(p.ViewChanged,function(e){0===e&&(e="Model"),d.setSelectedControlById(e)}),L.addControls(o.getButtons()),c?(d._currentControl.setCheckedState(!1),d.setSelectedControlById(c)):d.setSelectedControlById("Model")},L=l.getToolbar("LeftSubToolbar");L&&(T(),a.addEventListener(p.ActiveViewChanged,T)),a.getManifest(function(e){var t=e.Features,n=void 0;(n=!t||t.HasLayout)||L&&L.destroy()}),a.addEventListener(p.ViewChanged,function(){var e=s.getPanel("layersSet");if(e){var t=M.getControl("Layers"),n=e.isShow;n&&e.hide(),e.destroy(),s.removePanel("layersSet"),n?t.setCheckedState(!0):t.setCheckedState(!1),c=new Glodon.Bimface.Application.UI.Panel.LayersSetPanel(a,t),h.appendChild(c.element),s.addPanel(c),n||c.hide()}})}function i(e){var t=s.getActiveViewer();t.contextMenu&&t.contextMenu.element&&t.contextMenu.destroy();var n=e.clientPosition,o=e.containerBox,i=t.getSelectedIds(),a=new Glodon.Bimface.Application.UI.Menu.ContextMenu(s,i),r={},l=a.element.getBoundingClientRect();o.width-n.x>2*l.width?(r.x=n.x,a.element.removeClass("bf-menu-left"),a.element.addClass("bf-menu-right")):(r.x=n.x-l.width,a.element.addClass("bf-menu-left"),a.element.removeClass("bf-menu-right")),o.height-n.y>l.height?r.y=n.y:r.y=n.y-l.height,a.setPosition(r),t.contextMenu=a}var a,r=Glodon.Web.Lang.Utility.ClientHelper.getIsDesktop(),s=this,l=[],d=[],c=e,u=Glodon.Bimface.UI.Control.ControlEvent,p=Glodon.Bimface.Viewer.ViewerDrawingSetEvent;a=new Glodon.Bimface.Viewer.ViewerDrawingSet(c);var h=a.getRootElement();a.addEventListener(p.Loaded,function(){o(),s._mainToolbarAdaptive(),window.addEventListener("resize",function(e){s._mainToolbarAdaptive()})}),a.addEventListener(p.ContextMenu,i),this.getViewer=function(){return a},this.getActiveViewer=function(){return a.getActiveDrawing().viewerDrawing},this.addDrawing=function(e,t,n){a.addDrawing(e,t,n)},this.addDrawings=function(e,t){a.addDrawings(e,t)},this.getRenderInfo=function(e,t){a.getRenderInfo(e,t)},this.getToolbars=function(){return l},this.getToolbar=function(e){return l.getToolbar(e)},this.addPanel=function(e){d.push(e)},this.removePanel=function(e){d.removeObjectByAttribute("id",e)},this.getPanel=function(e){return d.getObjectByAttribute("id",e)},this._mainToolbarAdaptive=function(){var e=s.getToolbars();if(e&&e._Toolbars&&e._Toolbars.length>=2&&!!s.getToolbar("MainToolbar")){var t=s.getToolbar("MainToolbar");a.getRootElement().offsetWidth<1e3?t.addClassName("bf-toolbar-bottom-float-right"):t.removeClassName("bf-toolbar-bottom-float-right")}}};e.WebApplicationDrawingSet=o}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application"),t=function(e,t){var n,o=new Glodon.Bimface.Application.WebApplicationDrawingConfig;o.domElement=document.getElementById(t),o.domElementId=t,o.drawingUrl=e.drawingUrl;Glodon.Bimface.Application.WebApplicationDrawingEvent;n=new Glodon.Bimface.Application.WebApplicationDrawing(o),this._application=n};e.ApplicationDrawingDemo=t}(),function(){function e(t,n,o){function i(r,s){if(!n[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(a)return a(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[r]={exports:{}};t[r][0].call(c.exports,function(e){return i(t[r][1][e]||e)},c,c.exports,e,t,n,o)}return n[r].exports}for(var a="function"==typeof require&&require,r=0;r<o.length;r++)i(o[r]);return i}return e}()({1:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../Markups"),a=function(e){function t(t,n,o,i){var a=e.call(this)||this;return a.rotation=i||0,a.markupType="Arrow",a.drawPoints=t,a.strokeStyle=n,a.lineWidth=o,a.bNeedHitByBbox=!1,a}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var i=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]),a=e.worldToClientPoint([this.drawPoints[1][0],this.drawPoints[1][1],this.drawPoints[1][2]]),r=10+this.lineWidth,s=i[0],l=i[1],d=a[0],c=a[1],u=180*Math.atan2(l-c,s-d)/Math.PI,p=(u+30)*Math.PI/180,h=(u-30)*Math.PI/180,f=r*Math.cos(p),m=r*Math.sin(p),g=r*Math.cos(h),v=r*Math.sin(h),b=s-f,y=l-m,w=[(i[0]+a[0])/2,(i[1]+a[1])/2];t.fillStyle=t.strokeStyle,t.beginPath(),b=d+f,y=c+m,t.moveTo(b,y),t.lineTo(d,c),b=d+g,y=c+v,t.lineTo(b,y),t.closePath(),t.fill(),t.beginPath(),t.moveTo(s,l),f=(r-3)*Math.cos(p),m=(r-3)*Math.sin(p),g=(r-3)*Math.cos(h),v=(r-3)*Math.sin(h);var C=[d+(f+g)/2,c+(m+v)/2];t.lineTo(C[0],C[1]),t.stroke(),n.drawArrow(this,s,l,d,c,f,m,g,v,w,this.rotation,o,i,a)}},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]);return t.concat(n)},t}(i.default);n.default=a},{"./../Markups":21}],2:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ArrowMarkup"),a=e("..//MarkupTool"),r=e("../Mouse"),s=r.MouseButtons,l=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n}return o(t,e),t.prototype.begin=function(e,t,n,o){this.startX=t,this.startY=n;var a=e.markupManager.getColor(),r=e.markupManager.getLineWidth();this.markup=new i.default([],a,r)},t.prototype.onEditing=function(e,t,n,o){var i=e.clientToWorldPoint([this.startX,this.startY]),a=e.clientToWorldPoint([t,n]);this.markup.setPoints([i,a]),this.redraw(e)},t.prototype.end=function(e,t,n,o){return this.startX==t&&this.startY==n?(console.log("Ignore single point."),s.FINISHED):(this.addMarkup(e,this.markup),this.markup=null,s.FINISHED)},t}(a.default);n.default=l},{"..//MarkupTool":16,"../Mouse":23,"./ArrowMarkup":1}],3:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("../MathUtil"),a=e("./../Markups"),r=e("../MarkupViewer"),s=function(e){function t(t,n,o,i,a,r,s){var l=e.call(this)||this;return l.rotation=a||0,l.fillStyle=r||0,l.close=s||!1,l.markupType="Cloud",l.drawPoints=t,l.strokeStyle=n,l.lineWidth=o,l.controlPt=[],l.editPt=null,l.bNeedHitByBbox=!0,l}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var i=e.markupManager.getMarkupCenter(e,o);i||(i=[0,0]),t.save(),t.translate(i[0],i[1]),t.rotate(this.rotation),t.beginPath(),n.ctx.save(),n.ctx.translate(i[0],i[1]),n.ctx.rotate(this.rotation),n.ctx.beginPath(),n.ctx.strokeStyle="rgba("+(2*o+2)+",60,60,1)",n.ctx.fillStyle="rgba("+(2*o+2)+",60,255,1)",n.ctx.lineWidth=r.MarkupViewer.isMobile?36:this.lineWidth+n.lineWidth;for(var a=1,s=this.drawPoints.length;a<s;a++){var l=e.worldToClientPoint([this.drawPoints[a-1][0],this.drawPoints[a-1][1],this.drawPoints[a-1][2]]),d=e.worldToClientPoint([this.drawPoints[a][0],this.drawPoints[a][1],this.drawPoints[a][2]]),c=void 0;if(1==a&&(t.moveTo(l[0]-i[0],l[1]-i[1]),n.ctx.moveTo(l[0]-i[0],l[1]-i[1])),this.editPt&&this.editPt[a-1])c=e.worldToClientPoint([this.editPt[a-1][0],this.editPt[a-1][1],this.editPt[a-1][2]]);else if(this.controlPt[a-1]&&a<s-1)c=e.worldToClientPoint([this.controlPt[a-1][0],this.controlPt[a-1][1],this.controlPt[a-1][2]]);else{c=this.getControlPt(l,d);var u=e.clientToWorldPoint(c);u[0]&&u[1]&&(this.controlPt[a-1]=u)}t.quadraticCurveTo(c[0]-i[0],c[1]-i[1],d[0]-i[0],d[1]-i[1]),n.ctx.quadraticCurveTo(c[0]-i[0],c[1]-i[1],d[0]-i[0],d[1]-i[1])}n.ctx.stroke(),this.close&&this.fillStyle&&t.fill(),t.stroke(),t.restore(),n.ctx.restore()}},t.prototype.shouldClose=function(e,t,n){if(this.drawPoints.length<3)return!1;var o=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]);return i.default.distanceByArr(o,[t,n])<5?(this.close=!0,!0):(this.close=!1,!1)},t.prototype.getControlPt=function(e,t,n){var o=[(e[0]+t[0])/2,(e[1]+t[1])/2],a=.6*i.default.distanceByArr(e,t),r=[t[1]-e[1],e[0]-t[0]];return r=i.default.normalize(r),[o[0]+r[0]*a,o[1]+r[1]*a]},
t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.addPoint=function(e){this.drawPoints.push(e)},t.prototype.getStartPoint=function(){return this.drawPoints[0]},t.prototype.popPoint=function(){this.drawPoints.pop()},t.prototype.isEmpty=function(){return 0==this.drawPoints.length},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e,t){if(void 0==t)return this.drawPoints;var n=e.markupManager.getMarkupBbox(e,t),o=[n[0],n[1]],i=[n[2],n[3]],a=[(o[0]+i[0])/2,(o[1]+i[1])/2],r=[];return r.push(o[0],o[1]),r.push(o[0],a[1]),r.push(o[0],i[1]),r.push(a[0],i[1]),r.push(i[0],i[1]),r.push(i[0],a[1]),r.push(i[0],o[1]),r.push(a[0],o[1]),r},t}(a.default);n.default=s},{"../MarkupViewer":17,"../MathUtil":22,"./../Markups":21}],4:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./CloudMarkup"),a=e("./../MarkupTool"),r=e("../MathUtil"),s=e("./../Mouse"),l=s.MouseButtons,d=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n.bFirstCloudMarkup=!0,n.uncertainty=!1,n}return o(t,e),t.prototype.begin=function(e,t,n,o){if(this.bFirstCloudMarkup){if(e.markupManager.hitTest(e,t,n)>-1)return;var a=e.markupManager.getColor(),r=e.markupManager.getLineWidth(),s=e.markupManager.getFillStyleState()?e.markupManager.getFillColor():void 0;this.markup=new i.default([],a,r,null,0,s),this.bFirstCloudMarkup=!1}if(this.markup.shouldClose(e,t,n))this.addMarkup(e,this.markup),this.markup=null,this.redraw(e),this.bFirstCloudMarkup=!0;else{var l=e.clientToWorldPoint([t,n]);this.markup.popPoint(),this.markup.addPoint(l)}this.uncertainty=!1},t.prototype.onEditing=function(e,t,n,o){if(!this.bFirstCloudMarkup){var i=void 0;i=this.markup.shouldClose(e,t,n)?this.markup.getStartPoint():e.clientToWorldPoint([t,n]),this.uncertainty&&this.markup.drawPoints.length>1?this.markup.popPoint():this.uncertainty=!0,this.markup.addPoint(i),this.redraw(e)}},t.prototype.onMouseMove=function(e,t,n,o){this.onEditing(e,t,n,o)},t.prototype.end=function(e,t,n,o){if(this.bFirstCloudMarkup)return l.FINISHED},t.prototype.onMouseRightClick=function(e,t){this.bFirstCloudMarkup||(this.markup.popPoint(),this.markup.drawPoints.length>1&&this.addMarkup(e,this.markup),this.markup.close=!1,this.markup=null,this.redraw(e),this.bFirstCloudMarkup=!0)},t.prototype.onDoubleClick=function(e,t){if(!this.bFirstCloudMarkup){this.markup.popPoint();var n=this.markup.drawPoints.length;n>1&&this.addMarkup(e,this.markup);var o=e.worldToClientPoint([this.markup.drawPoints[n-1][0],this.markup.drawPoints[n-1][1],this.markup.drawPoints[n-1][2]]);r.default.distanceByArr(o,[t.x,t.y])<5&&this.markup.popPoint(),this.markup=null,this.redraw(e),this.bFirstCloudMarkup=!0}},t}(a.default);n.default=d},{"../MathUtil":22,"./../MarkupTool":16,"./../Mouse":23,"./CloudMarkup":3}],5:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../Markups"),a=e("../MathUtil"),r=e("../MarkupViewer"),s=function(e){function t(t,n,o,i,a){var r=e.call(this)||this;return r.rotation=i||0,r.markupType="CloudRect",r.drawPoints=t,r.strokeStyle=n,r.lineWidth=o,r.fillStyle=a,r.baseUnit="30",r.bNeedHitByBbox=!0,r}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var i=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]),a=e.worldToClientPoint([this.drawPoints[1][0],this.drawPoints[1][1],this.drawPoints[1][2]]),s=this.getCenter(e),l=a[1]-i[1],d=a[0]-i[0],c=Math.abs(d),u=Math.abs(l),p=c/this.baseUnit,h=u/this.baseUnit,f=parseInt(p),m=parseInt(h),g=0==f?c:c/f,v=0==m?u:u/m;t.save(),t.translate(s[0],s[1]),t.rotate(this.rotation),t.beginPath(),n.ctx.save(),n.ctx.translate(s[0],s[1]),n.ctx.rotate(this.rotation),n.ctx.beginPath();var b=[-c/2,-u/2],y=[c/2,u/2];n.ctx.strokeStyle="rgba("+(2*o+2)+",40,40,1)",n.ctx.lineWidth=r.MarkupViewer.isMobile?36:this.lineWidth+n.lineWidth,t.lineJoin="round",this.drawSide("orientation",g,c,b[0],b[1],t,null,o,n,!0),this.drawSide("portrait",v,u,y[0],b[1],t,null,o,n),this.drawSide("orientation",g,c,y[0],y[1],t,!0,o,n),this.drawSide("portrait",v,u,b[0],y[1],t,!0,o,n),this.fillStyle&&t.fill(),t.stroke(),t.restore(),n.ctx.stroke(),n.ctx.restore()}},t.prototype.drawSide=function(e,t,n,o,i,a,r,s,l,d){var c,u=0,p=0,h=n/t,f=o,m=i;"orientation"==e?u=t:p=t;for(var g=0;g<h;g++){d&&0==g&&a.moveTo(o,i),c=r?[o-u,i-p]:[o+u,i+p],u&&Math.abs(c[0]-f)>n?c[0]=r?f-n:f+n:p&&Math.abs(c[1]-m)>n&&(c[1]=r?m-n:m+n);var v=this.getControlPt([o,i],c);a.quadraticCurveTo(v[0],v[1],c[0],c[1]),l.drawCloudRect(o,i,v,c,s),o=c[0],i=c[1]}},t.prototype.getControlPt=function(e,t,n){var o=[(e[0]+t[0])/2,(e[1]+t[1])/2],i=.5*a.default.distanceByArr(e,t),r=[t[1]-e[1],e[0]-t[0]];return r=a.default.normalize(r),[o[0]+r[0]*i,o[1]+r[1]*i]},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]),o=[(t[0]+n[0])/2,(t[1]+n[1])/2],i=[];return i.push(t[0],t[1]),i.push(t[0],o[1]),i.push(t[0],n[1]),i.push(o[0],n[1]),i.push(n[0],n[1]),i.push(n[0],o[1]),i.push(n[0],t[1]),i.push(o[0],t[1]),i},t}(i.default);n.default=s},{"../MarkupViewer":17,"../MathUtil":22,"./../Markups":21}],6:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../MarkupTool"),a=e("./CloudRectMarkup"),r=e("./../Mouse"),s=r.MouseButtons,l=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n}return o(t,e),t.prototype.begin=function(e,t,n,o){this.startX=t,this.startY=n;var i=e.markupManager.getColor(),r=e.markupManager.getLineWidth(),s=e.markupManager.getFillStyleState()?e.markupManager.getFillColor():void 0;this.markup=new a.default([],i,r,0,s)},t.prototype.onEditing=function(e,t,n,o){var i=e.clientToWorldPoint([this.startX,this.startY]),a=e.clientToWorldPoint([t,n]);this.markup.setPoints([i,a]),this.redraw(e)},t.prototype.end=function(e,t,n,o){return this.startX==t&&this.startY==n?(console.log("Ignore single point."),s.FINISHED):(this.addMarkup(e,this.markup),this.markup=null,s.FINISHED)},t}(i.default);n.default=l},{"./../MarkupTool":16,"./../Mouse":23,"./CloudRectMarkup":5}],7:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../Markups"),a=e("../MarkupViewer"),r=function(e){function t(t,n,o,i){var a=e.call(this)||this;return a.rotation=i||0,a.markupType="Cross",a.drawPoints=t,a.strokeStyle=n,a.lineWidth=o,a.bNeedHitByBbox=!1,a}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var i=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]),r=e.worldToClientPoint([this.drawPoints[1][0],this.drawPoints[1][1],this.drawPoints[1][2]]),s=this.getCenter(e);t.save(),t.translate(s[0],s[1]),t.rotate(this.rotation),t.beginPath(),t.moveTo(-.5*(r[0]-i[0]),-.5*(r[1]-i[1])),t.lineTo(.5*(r[0]-i[0]),.5*(r[1]-i[1])),t.moveTo(-.5*(r[0]-i[0]),.5*(r[1]-i[1])),t.lineTo(.5*(r[0]-i[0]),-.5*(r[1]-i[1])),t.stroke(),t.restore(),n.ctx.lineWidth=a.MarkupViewer.isMobile?36:this.lineWidth+n.lineWidth,n.drawCross(i,r,s,this.rotation,o)}},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]),o=[(t[0]+n[0])/2,(t[1]+n[1])/2],i=[];return i.push(t[0],t[1]),i.push(t[0],o[1]),i.push(t[0],n[1]),i.push(o[0],n[1]),i.push(n[0],n[1]),i.push(n[0],o[1]),i.push(n[0],t[1]),i.push(o[0],t[1]),i},t}(i.default);n.default=r},{"../MarkupViewer":17,"./../Markups":21}],8:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../MarkupTool"),a=e("./CrossMarkup"),r=e("./../Mouse"),s=r.MouseButtons,l=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n}return o(t,e),t.prototype.begin=function(e,t,n,o){this.startX=t,this.startY=n;var i=e.markupManager.getColor(),r=e.markupManager.getLineWidth();this.markup=new a.default([],i,r)},t.prototype.onEditing=function(e,t,n,o){var i=e.clientToWorldPoint([this.startX,this.startY]),a=e.clientToWorldPoint([t,n]);this.markup.setPoints([i,a]),this.redraw(e)},t.prototype.end=function(e,t,n,o){return this.startX==t&&this.startY==n?(console.log("Ignore single point."),s.FINISHED):(this.addMarkup(e,this.markup),this.markup=null,s.FINISHED)},t}(i.default);n.default=l},{"./../MarkupTool":16,"./../Mouse":23,"./CrossMarkup":7}],9:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../Markups"),a=e("../MarkupViewer"),r=function(e){function t(t,n,o,i,a){var r=e.call(this)||this;return r.rotation=i||0,r.markupType="Ellipse",r.drawPoints=t,r.strokeStyle=n,r.lineWidth=o,r.fillStyle=a,r.bNeedHitByBbox=!0,r}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var i=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]),r=e.worldToClientPoint([this.drawPoints[1][0],this.drawPoints[1][1],this.drawPoints[1][2]]),s=.5*Math.abs(r[0]-i[0]),l=.5*Math.abs(r[1]-i[1]),d=this.getCenter(e);t.save(),t.translate(d[0],d[1]),t.rotate(this.rotation),t.beginPath(),t.ellipse(0,0,s,l,0,0,2*Math.PI),t.restore(),t.closePath(),this.fillStyle&&t.fill(),t.stroke(),n.ctx.lineWidth=a.MarkupViewer.isMobile?36:this.lineWidth+n.lineWidth,n.ctx.fillStyle=this.fillStyle,n.drawEllips(i,r,d,this.rotation,o,s,l)}},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]),o=[(t[0]+n[0])/2,(t[1]+n[1])/2],i=[];return i.push(t[0],t[1]),i.push(t[0],o[1]),i.push(t[0],n[1]),i.push(o[0],n[1]),i.push(n[0],n[1]),i.push(n[0],o[1]),i.push(n[0],t[1]),i.push(o[0],t[1]),i},t}(i.default);n.default=r},{"../MarkupViewer":17,"./../Markups":21}],10:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../MarkupTool"),a=e("./EllipsMarkup"),r=e("./../Mouse"),s=r.MouseButtons,l=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n}return o(t,e),t.prototype.begin=function(e,t,n,o){this.startX=t,this.startY=n;var i=e.markupManager.getColor(),r=e.markupManager.getLineWidth(),s=e.markupManager.getFillStyleState()?e.markupManager.getFillColor():void 0;this.markup=new a.default([],i,r,0,s)},t.prototype.onEditing=function(e,t,n,o){var i=e.clientToWorldPoint([this.startX,this.startY]),a=e.clientToWorldPoint([t,n]);this.markup.setPoints([i,a]),this.redraw(e)},t.prototype.end=function(e,t,n,o){return this.startX==t&&this.startY==n?(console.log("Ignore single point."),s.FINISHED):(this.addMarkup(e,this.markup),this.markup=null,s.FINISHED)},t}(i.default);n.default=l},{"./../MarkupTool":16,"./../Mouse":23,"./EllipsMarkup":9}],11:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e("./MarkupDrawing"),e("./MarkupViewer3D"),e("./MarkupViewer2D")},{"./MarkupDrawing":12,"./MarkupViewer2D":18,"./MarkupViewer3D":19}],12:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./MarkupViewer"),a=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.modelViewer.addEventListener("Rendered",function(){o.update()}),o.viewer.clientToWorldPoint=function(e){return o.viewer.toWorldPoint(e)},o.viewer.worldToClientPoint=function(e){return e?o.viewer.toScreenPoint([e[0],e[1]]):[]},o}return o(t,e),t.prototype.getCurrentState=function(){return{annotationList:this.getAnnotationList(),state:JSON.parse(this.modelViewer.getCurrentState())}},t.prototype.startDrawing=function(){this.canvas.style.zIndex=10,this.work=!0,this.alwaysMode=!1,this.showCanvas(),this.switchMode()},t.prototype.onTouchstart=function(e){if(!this.alwaysMode){var t=Date.now();if(t-this.firstTouch<500)return void this.editor.onDoubleTouch(this.viewer,e);this.firstTouch=t,!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&e.target==this.canvas&&e.touches.length<2&&(e.preventDefault(),this.editor.onTouchstart(this.viewer,e),this.containerSize=this.getContainerSize())}},t.prototype.onTouchmove=function(e){if(this.alwaysMode)return void this.update();if(this.work){var t=e.touches[0],n=this.containerSize,o=n.left,i=n.top,a=n.width,r=n.height;e.touches.length<2?(e.preventDefault(),e.stopPropagation(),t.pageX>o&&t.pageX<o+a&&t.pageY>i&&t.pageY<i+r&&this.editor.onTouchmove(this.viewer,e)):this.update()}},t.prototype.showAnnotation=function(){this.alwaysMode=!0,this.canvas.style.zIndex=5,this.editor.editIndex=-1,this.update(),this.showCanvas()},t.prototype.hideAnnotation=function(){this.hideCanvas()},t.prototype.setState=function(e){if("string"!=typeof e.state&&(e.state=JSON.stringify(e.state)),this.modelViewer.setState(e.state),"string"==typeof e.annotationList){var t=this.markupManager.fromString(e.annotationList);this.setAnnotationList(t)}else e.annotationList[0].id?this.setAnnotationList(this.transform(e.annotationList)):this.setAnnotationList(e.annotationList)},t.prototype.onMouseWheel=function(e){if(this.alwaysMode)return void this.update();!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&(e.preventDefault(),this.update(),this.editor.onMouseWheel(this.viewer,e))},t.prototype.createSnapshot=function(e){var t=this.viewer.snapshotPure(),n=document.createElement("canvas");n.width=this.wrapDom.clientWidth,n.height=this.wrapDom.clientHeight;var o=n.getContext("2d");o.beginPath(),o.fillStyle=this.wrapDom.style.background,o.fillRect(0,0,n.width,n.height),o.drawImage(t,0,0),o.drawImage(this.canvas,0,0),e(n.toDataURL())},t.prototype.switchMode=function(){this.work&&this.getIsDesktop()?this.modelViewer.setNavigationMode("pan"):this.modelViewer.setNavigationMode("pick")},t}(i.MarkupViewer);n.MarkupDrawing=a,window.MarkupDrawing=a},{"./MarkupViewer":17}],13:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("./EllipsMarkup/EllipsMarkupTool"),i=e("./RectMarkup/RectMarkupTool"),a=e("./ArrowMarkup/ArrowMarkupTool"),r=e("./CrossMarkup/CrossMarkupTool"),s=e("./CloudMarkup/CloudMarkupTool"),l=e("./CloudRectMarkup/CloudRectMarkupTool"),d=e("./TextMarkup/TextMarkupTool"),c=e("./PolylineMarkup/PolylineMarkupTool"),u=e("./MarkupViewer"),p=e("./Mouse"),h=p.MouseButtons,f=function(){function e(e,t,n){this.canvas=e,this.MarkupVirtualPad=n,this.ctx=e.getContext("2d"),this.markupManager=t,this.setMarkupType("arrow"),this.curIndex=-1,this.editIndex=-1,this.preEdit=-1,this.inEditMode=!1,this.currentGrip=-1,this.bFirstClick=!0,this.firstPos=[],this.touchPos=[],this.hightLightColor="yellow",new d.default(this.markupManager).createDiv(d.default.divId)}return e.prototype.onDrawing=function(e,t,n){if(this.tool.onDrawing(e,t,this.MarkupVirtualPad,this.curIndex),this.curIndex!=this.highLightId&&this.highLightId>=0){var o=e.markupManager.get(this.highLightId);this.canvas.style.cursor="",this.highLightId=-1}if(this.curIndex>=0){var o=e.markupManager.get(this.curIndex);if(!o)return;n&&e.markupManager.hitTest(e,n[0],n[1])==this.curIndex&&(this.canvas.style.cursor="pointer",this.highLightId=this.curIndex)}if(this.editIndex>=0){if(0==e.markupManager.markups.length)return this.editIndex,!1;var i=e.markupManager.getMarkupBbox(e,this.editIndex);if(!i)return;var a=[i[0],i[1]],r=[i[2],i[3]],o=e.markupManager.get(this.editIndex),s=o.getGrips(e,this.editIndex),l=e.markupManager.getMarkupCenter(e,this.editIndex);if(!l)return;t.save(),t.translate(l[0],l[1]),"Arrow"!=o.markupType&&t.rotate(o.rotation),t.beginPath(),t.lineWidth="1",t.strokeStyle="red",t.fillStyle="#ffffff";var d=(o.lineWidth||0)/2;if(4!=s.length&&(t.strokeRect(-.5*(r[0]-a[0])-d,-.5*(r[1]-a[1])-d,r[0]-a[0]+2*d,r[1]-a[1]+2*d),t.arc(0,a[1]-l[1]-20,6,0,2*Math.PI,!1),t.fill(),t.stroke(),t.closePath(),t.beginPath(),t.arc(0,a[1]-l[1]-20,3,.5*Math.PI,1.8*Math.PI,!1),t.moveTo(3,a[1]-l[1]-21),t.lineTo(.5,a[1]-l[1]-19.5),t.moveTo(3,a[1]-l[1]-21),t.lineTo(3,a[1]-l[1]-24.5),t.stroke()),t.closePath(),"Arrow"==o.markupType){var c=e.markupManager.getMarkupSize(e,this.editIndex),u=Math.sqrt(c[0]*c[0]+c[1]*c[1]),p=c[0]/u*3,h=c[1]/u*3;t.beginPath(),t.arc(s[0]-l[0]+(s[0]<s[2]?-p/2:p/2),s[1]-l[1]+(s[1]<s[3]?-h/2:h/2),3,0,2*Math.PI,!1),t.fill(),t.stroke(),t.closePath(),t.beginPath(),t.arc(s[2]-l[0]+(s[0]<s[2]?p:-p),s[3]-l[1]+(s[1]<s[3]?h:-h),3,0,2*Math.PI,!1),t.fill(),t.stroke(),t.closePath()}else for(var f=0;f<s.length;f+=2){t.beginPath();var m=[s[f],s[f+1]];switch(f){case 0:t.arc(m[0]-l[0]-d,m[1]-l[1]-d,3,0,2*Math.PI,!1);break;case 2:t.arc(m[0]-l[0]-d,m[1]-l[1],3,0,2*Math.PI,!1);break;case 4:t.arc(m[0]-l[0]-d,m[1]-l[1]+d,3,0,2*Math.PI,!1);break;case 6:t.arc(m[0]-l[0],m[1]-l[1]+d,3,0,2*Math.PI,!1);break;case 8:t.arc(m[0]-l[0]+d,m[1]-l[1]+d,3,0,2*Math.PI,!1);break;case 10:t.arc(m[0]-l[0]+d,m[1]-l[1],3,0,2*Math.PI,!1);break;case 12:t.arc(m[0]-l[0]+d,m[1]-l[1]-d,3,0,2*Math.PI,!1);break;case 14:t.arc(m[0]-l[0],m[1]-l[1]-d,3,0,2*Math.PI,!1)}t.fill(),t.stroke(),t.closePath()}t.restore(),this.MarkupVirtualPad.drawEdit(a,r,l,o,s,this.editIndex,p,h,d)}},e.prototype.canCreateMarkup=function(e){if(-1==this.curIndex)return!0;var t=e.markupManager.get(this.curIndex);if(!t)return!0;var n=t.getGrips(e);return this.editIndex!=this.curIndex&&0!=n.length&&"Text"!=t.markupType},e.prototype.setMarkupType=function(e){switch(this.tool&&this.tool.onExit(),this.crtMarkupType=e,this.start=!1,e){case"ellips":this.tool=new o.default(this.markupManager);break;case"rectangle":this.tool=new i.default(this.markupManager);break;case"arrow":this.tool=new a.default(this.markupManager);break;case"cross":this.tool=new r.default(this.markupManager);break;case"cloud":this.tool=new s.default(this.markupManager);break;case"cloud-rect":this.tool=new l.default(this.markupManager);break;case"text":this.tool=new d.default(this.markupManager);break;case"polyline":this.tool=new c.default(this.markupManager);break;default:console.log("Current type is not supported.")}this.tool.redraw=this.redraw.bind(this),this.tool.type=e},e.prototype.begin=function(e,t,n,o){this.curIndex=e.markupManager.hitTest(e,t,n,!0);var i=this.curIndex<0&&this.canCreateMarkup(e),a=this.MarkupVirtualPad.isEdge(t,n);i&&!a&&(o==h.LelftButton&&(this.start=!0,this.textMarkupTool&&(this.textMarkupTool.initDom(e),this.textMarkupTool=null),this.tool.begin(e,t,n,o)),this.start&&o==h.RightButton&&this.tool.begin(e,t,n,o)),this.bFirstClick=!0;var r=this.editIndex;this.preEdit=r,this.curIndex>=0?(this.editIndex=this.curIndex,this.inEditMode=!0,this.redraw(e)):(this.editIndex=-1,this.redraw(e)),this.editIndex!=r&&e.onSelectChange(this.editIndex)},e.prototype.onEditing=function(e,t,n,o){if(this.start?-1!=this.curIndex&&this.editIndex==this.curIndex||this.tool.onEditing(e,t,n,o):this.tool.onMouseMove(e,t,n,o),this.inEditMode){var i=e.markupManager.hitGrip(e,[t,n],this.editIndex);if(this.bFirstClick){this.firstPos=[t,n],this.bFirstClick=!1,this.currentGrip=i>=0?i:-1;var a=e.markupManager.get(this.editIndex);if(!a)return;return a.originPoints=a.getPoints(),a.originRotation=a.rotation,"Text"==a.markupType&&(this.editIndex==this.preEdit&&a.userText&&a.originUserText&&this.currentGrip<9?a.userText=a.originUserText:-1!=this.currentGrip&&this.currentGrip<9&&(a.originUserText=a.userText)),a.controlPt&&(a.originControlPt=a.controlPt),void(a.editPt&&(a.originEditPt=a.editPt))}var r=[t,n];if(9==this.currentGrip)e.markupManager.gripRotate(e,this.editIndex,this.firstPos,r),this.redraw(e,r);else if(this.currentGrip>=0&&this.currentGrip<9)e.markupManager.gripDragging(e,this.editIndex,this.currentGrip,this.firstPos,r),this.redraw(e,r);else{var a=e.markupManager.get(this.editIndex);e.markupManager.translatePos(e,this.editIndex,this.firstPos,r),this.redraw(e,r)}}else this.bFirstClick=!0,this.currentGrip=-1,this.curIndex=e.markupManager.hitTest(e,t,n),this.redraw(e,[t,n])},e.prototype.end=function(e,t,n,o){this.start&&(-1!=this.curIndex&&this.editIndex==this.curIndex||h.FINISHED==this.tool.end(e,t,n,o)&&(this.start=!1)),this.inEditMode&&(this.inEditMode=!1),this.start=!1},e.prototype.onExit=function(e){this.tool.onExit(e)},e.prototype.onMouseWheel=function(e,t){this.start},e.prototype.onKeyDown=function(e,t){this.editIndex>=0&&("Delete"==t.code||"Backspace"==t.code)&&(e.markupManager.remove(this.editIndex),this.curIndex=-1,this.editIndex=-1,this.redraw(e))},e.prototype.onDoubleClick=function(e,t){this.tool.onDoubleClick&&this.tool.onDoubleClick(e,t),this.editText(e)},e.prototype.onDoubleTouch=function(e,t){this.tool.onDoubleTouch&&this.tool.onDoubleTouch(e,t),this.editText(e)},e.prototype.editText=function(e){if(!(this.curIndex<0||void 0==this.curIndex)){var t=e.markupManager.get(this.curIndex);if(t){var n=t.getPoints();if("Text"==t.markupType){var o=new d.default(this.markupManager,t.rotation);""!=d.default.lastTextareaId&&o.initDom(e);var i=e.worldToClientPoint([n[0][0],n[0][1],n[0][2]]);o.setUserText(t.getPureText()),this.tool.rotation=t.rotation,o.begin(e,i[0],i[1],h.LelftButton),o.setEditBox(t.getTextSize()),e.markupManager.remove(this.curIndex),this.highLightId=-1,this.curIndex=-1,this.editIndex=-1,this.textMarkupTool=o,this.redraw(e)}}}},e.prototype.onMouseDown=function(e,t){2==t.button?(e.startX=null,e.startY=null,this.tool.onMouseRightClick&&this.tool.onMouseRightClick(e,t)):this.begin(e,t.offsetX,t.offsetY,t.buttons)},e.prototype.onMouseMove=function(e,t){var n=this.formatEventOffset(e,t);this.onEditing(e,n.x,n.y,t.buttons)},e.prototype.onMouseUp=function(e,t,n){var o=this.formatEventOffset(e,t);if(n){var i=e.markupManager.hitTest(e,o.x,o.y,!0);if(i>-1){var a=e.markupManager.get(i);e.markupManager.viewer.alwaysMode&&0==t.button&&e.onClick(a)}}return this.end(e,o.x,o.y,t.buttons)},e.prototype.onTouchstart=function(e,t){var n=this.formatEventOffset(e,t);this.begin(e,n.x,n.y,1)},e.prototype.onTouchmove=function(e,t){var n=this.formatEventOffset(e,t);this.touchPos=[n.x,n.y],this.onEditing(e,n.x,n.y,1)},e.prototype.onTouchend=function(e,t){return this.end(e,this.touchPos[0],this.touchPos[1],1)},e.prototype.isPanMode=function(e){return e==h.MiddleButton||e==h.RightButton},e.prototype.formatEventOffset=function(e,t){var n,o,i=this.canvas.getBoundingClientRect();return u.MarkupViewer.isMobile?(n=t.touches[0].pageX-(i.x||i.left),o=t.touches[0].pageY-(i.y||i.top)):(n=t.clientX-(i.x||i.left),o=t.clientY-(i.y||i.top)),{x:n,y:o}},e.prototype.redraw=function(e,t){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.MarkupVirtualPad.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.MarkupVirtualPad.ctx.fillStyle="rgba(0,0,0,0)",this.MarkupVirtualPad.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.markupManager.draw(e,this.ctx),this.onDrawing(e,this.ctx,t)},e}();n.default=f},{"./ArrowMarkup/ArrowMarkupTool":2,"./CloudMarkup/CloudMarkupTool":4,"./CloudRectMarkup/CloudRectMarkupTool":6,"./CrossMarkup/CrossMarkupTool":8,"./EllipsMarkup/EllipsMarkupTool":10,"./MarkupViewer":17,"./Mouse":23,"./PolylineMarkup/PolylineMarkupTool":25,"./RectMarkup/RectMarkupTool":27,"./TextMarkup/TextMarkupTool":29}],14:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("./RectMarkup/RectMarkup"),i=e("./EllipsMarkup/EllipsMarkup"),a=e("./ArrowMarkup/ArrowMarkup"),r=e("./CrossMarkup/CrossMarkup"),s=e("./CloudMarkup/CloudMarkup"),l=e("./CloudRectMarkup/CloudRectMarkup"),d=e("./TextMarkup/TextMarkup"),c=e("./PolylineMarkup/PolylineMarkup"),u=function(){function e(){}return e.markups2string=function(e){return JSON.stringify(e)},e.string2markups=function(e){var t=JSON.parse(e);return this.transform2markups(t)},e.transform2markups=function(e){for(var t=[],n=0;n<e.length;n++){var u=e[n],p=u.drawPoints,h=u.strokeStyle,f=u.lineWidth,m=u.fillStyle,g=u.close,v=u.userText,b=u.fontSize,y=u.rotation,w=u.fontFamily,C=u.textAreaId,M=u.center,k=u.markupId,B=u.controlPt,T=null;switch(u.markupType){case"Ellipse":T=new i.default(p,h,f,y,m);break;case"Rectangle":T=new o.default(p,h,f,y,m);break;case"Arrow":T=new a.default(p,h,f);break;case"Cross":T=new r.default(p,h,f,y);break;case"Cloud":T=new s.default(p,h,f,B,y,m,g);break;case"CloudRect":T=new l.default(p,h,f,y,m);break;case"Text":if(2==p.length&&"number"==typeof p[0]){if(T=new d.default(p,v,h,b,w,y,C,M,!0),u.pureText){var L=T.getTextSize();T.resizeText(L)}}else T=new d.default(p[0],v,h,b,w,y,C,M);break;case"Polyline":T=new c.default(p,h,f,y,m,g);break;default:console.log("Current type is not supported.")}k&&(T.markupId=k),t.push(T)}return t},e}();n.default=u},{"./ArrowMarkup/ArrowMarkup":1,"./CloudMarkup/CloudMarkup":3,"./CloudRectMarkup/CloudRectMarkup":5,"./CrossMarkup/CrossMarkup":7,"./EllipsMarkup/EllipsMarkup":9,"./PolylineMarkup/PolylineMarkup":24,"./RectMarkup/RectMarkup":26,"./TextMarkup/TextMarkup":28}],15:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("./MarkupIO"),i=e("./MathUtil"),a=function(){function e(e,t){this.MarkupVirtualPad=e,this.viewer=t,this.markups=[],this.strokeStyle="red",this.lineWidth=3,this.fontSize=14,this.fontFamily="Arial",this.fillStyle="",this.enableFillStyle=!0}return e.prototype.toString=function(e){return o.default.markups2string(e||this.markups)},e.prototype.fromString=function(e){return o.default.string2markups(e)},e.prototype.add=function(e){e.markupId=Date.now(),this.markups.push(e)},e.prototype.setMarkups=function(e){this.markups=e.slice(),this.viewer.editor.editIndex=-1},e.prototype.clear=function(){this.markups=[],this.viewer.editor.tool.markup&&(this.viewer.editor.tool.markup.setPoints([]),this.viewer.editor.tool.bFirstCloudMarkup=!0)},e.prototype.draw=function(e,t){for(var n=this.markups,o=0,i=n.length;o<i;++o){var a=n[o];t.strokeStyle=a.strokeStyle,t.lineWidth=a.lineWidth,t.fillStyle=a.fillStyle,t.fontFamily=a.fontFamily,a.highLight&&(t.strokeStyle=a.highLight,a.highLight=null),a.draw(e,t,this.MarkupVirtualPad,o)}},e.prototype.getColor=function(){return this.strokeStyle},e.prototype.setColor=function(e){this.strokeStyle=e},e.prototype.getFillColor=function(){return this.fillStyle},e.prototype.setFillColor=function(e){this.enableFillStyle=!0,e.getRGBA&&(e=e.getRGBA()),this.fillStyle=e},e.prototype.setFillStyleState=function(e){this.enableFillStyle=e},e.prototype.getFillStyleState=function(){return this.enableFillStyle},e.prototype.getLineWidth=function(){return this.lineWidth},e.prototype.setLineWidth=function(e){this.lineWidth=e},e.prototype.getFont=function(){return this.font},e.prototype.getFontSize=function(){return this.fontSize},e.prototype.setFont=function(e){this.font=e},e.prototype.get=function(e){return this.markups[e]},e.prototype.remove=function(e){e<0||this.markups.splice(e,1)},e.prototype.hitTest=function(e,t,n,o){var a=this.MarkupVirtualPad.hitTest(t,n);if(void 0==o||a>=0)return a;a=-1;for(var r=this.markups.length-1;r>=0;r--){var s=this.markups[r];if(0!=s.bNeedHitByBbox&&"rgba(255,255,255,0)"!=s.fillStyle){var l=this.getMarkupBbox(e,r),d=this.getMarkupCenter(e,r),c=i.default.rotateAround([t,n],d,-s.rotation);if(1==!(c[0]<l[0]||c[0]>l[2]||c[1]<l[1]||c[1]>l[3])){a=r;break}}}return a},e.prototype.getMarkupBbox=function(e,t){var n=this.markups[t];if(!(t<0)&&n){var o=[Number.MAX_VALUE,Number.MAX_VALUE],i=[-Number.MAX_VALUE,-Number.MAX_VALUE],a=n.getPoints();if("Text"==n.markupType){return n.getTextBbox(e)}n.editPt?a=a.concat(n.editPt):n.controlPt&&(a=a.concat(n.controlPt));for(var r=0;r<a.length;r++){var s=e.worldToClientPoint(a[r]);s[0]<o[0]&&(o[0]=s[0]),s[1]<o[1]&&(o[1]=s[1]),s[0]>i[0]&&(i[0]=s[0]),s[1]>i[1]&&(i[1]=s[1])}return o.concat(i)}},e.prototype.getMarkupCenter=function(e,t){var n=this.getMarkupBbox(e,t);if(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}},e.prototype.setFontSize=function(e){this.fontSize=e},e.prototype.getMarkupSize=function(e,t){var n=this.getMarkupBbox(e,t);return[Math.abs(n[2]-n[0]),Math.abs(n[3]-n[1])]},e.prototype.getFontFamily=function(){return this.fontFamily},e.prototype.setFontFamily=function(e){this.fontFamily=e},e.prototype.translatePos=function(e,t,n,o){var i=this.markups[t];if(i.setPoints(i.originPoints),i.editPt&&(i.editPt=i.originEditPt),i.controlPt&&(i.controlPt=i.originControlPt),this.getMarkupCenter(e,t)){for(var a=o[0]-n[0],r=o[1]-n[1],s=i.originPoints,l=[],d=[],c=0;c<s.length;c++)d[c]=e.worldToClientPoint(s[c]),d[c][0]+=a,d[c][1]+=r,l[c]=e.clientToWorldPoint(d[c]);if(i.setPoints(l),"Cloud"==i.markupType){var u=(i.editPt&&i.originEditPt||i.controlPt&&i.originControlPt).slice();if(u){for(var p=[],c=0;c<u.length;c++)p[c]=e.worldToClientPoint(u[c]),p[c][0]+=a,p[c][1]+=r,u[c]=e.clientToWorldPoint(p[c]);i.editPt?i.editPt=u:i.controlPt=u}}}},e.prototype.isPointInCircle=function(e,t,n){return i.default.distanceByArr(e,t)<=n},e.prototype.hitGrip=function(e,t,n){return this.MarkupVirtualPad.hitGrip(t[0],t[1])},e.prototype.getX=function(e,t,n,o){return(o-t)/n+e},e.prototype.getY=function(e,t,n,o){return(o-e)*n+t},e.prototype.gripRotate=function(e,t,n,o){var i=this.markups[t];i.rotation=i.originRotation
;var a=this.getMarkupCenter(e,t),r=Math.sqrt(Math.pow(n[0]-a[0],2)+Math.pow(n[1]-a[1],2)),s=Math.sqrt(Math.pow(o[0]-a[0],2)+Math.pow(o[1]-a[1],2)),l=Math.sqrt(Math.pow(o[0]-n[0],2)+Math.pow(o[1]-n[1],2)),d=(l*l-r*r-s*s)/(-2*r*s),c=Math.acos(d),u=(n[1]-a[1])/(n[0]-a[0]),p=this.getY(n[0],n[1],u,o[0]),h=this.getX(n[0],n[1],u,o[1]);n[0]>a[0]&&n[1]<a[1]?o[0]<h&&o[1]<p&&(c=2*Math.PI-c):n[0]>a[0]&&n[1]>a[1]?o[0]>h&&o[1]<p&&(c=2*Math.PI-c):n[0]<a[0]&&n[1]>a[1]?o[0]>h&&o[1]>p&&(c=2*Math.PI-c):n[0]<a[0]&&n[1]<a[1]&&o[0]<h&&o[1]>p&&(c=2*Math.PI-c),i.rotation=i.originRotation+c},e.prototype.rotateTransform=function(e,t,n,o,i){n%=2*Math.PI,n=-n;var a,r,s=Math.sin(n),l=Math.cos(n);a=o-e,r=i-t;var d=a*l-r*s,c=a*s+r*l;return a=d+e,r=c+t,[a,r]},e.prototype.gripDragging=function(e,t,n,o,i){var a=this.markups[t],r=a.originPoints;a.setPoints(r),a.originUserText&&(a.userText=a.originUserText);var s=a.getGrips(e,t),l=this.getMarkupSize(e,t),d=l.slice(),c=this.getMarkupCenter(e,t),u=c.slice();if("Arrow"==a.markupType){var p=i[0]-o[0],h=i[1]-o[1],f=e.worldToClientPoint(r[0]),m=e.worldToClientPoint(r[1]);switch(n){case 0:f[0]+=p,f[1]+=h;break;case 4:m[0]+=p,m[1]+=h;break;default:console.log("default grip id."+n)}return f=e.clientToWorldPoint(f),m=e.clientToWorldPoint(m),void a.setPoints([f,m])}var g=this.rotateTransform(o[0],o[1],a.rotation,i[0],i[1]),v=g[0]-o[0],b=g[1]-o[1];switch(n){case 0:u[0]+=.5*v*Math.cos(a.rotation),u[1]+=.5*v*Math.sin(a.rotation),u[0]-=.5*b*Math.sin(a.rotation),u[1]+=.5*b*Math.cos(a.rotation),d[1]-=b,d[0]-=v;break;case 1:u[0]+=.5*v*Math.cos(a.rotation),u[1]+=.5*v*Math.sin(a.rotation),d[0]-=v;break;case 2:u[0]+=.5*v*Math.cos(a.rotation),u[1]+=.5*v*Math.sin(a.rotation),u[0]-=.5*b*Math.sin(a.rotation),u[1]+=.5*b*Math.cos(a.rotation),d[1]+=b,d[0]-=v;break;case 3:u[0]-=.5*b*Math.sin(a.rotation),u[1]+=.5*b*Math.cos(a.rotation),d[1]+=b;break;case 4:u[0]+=.5*v*Math.cos(a.rotation),u[1]+=.5*v*Math.sin(a.rotation),u[0]-=.5*b*Math.sin(a.rotation),u[1]+=.5*b*Math.cos(a.rotation),d[0]+=v,d[1]+=b;break;case 5:u[0]+=.5*v*Math.cos(a.rotation),u[1]+=.5*v*Math.sin(a.rotation),d[0]+=v;break;case 6:u[0]+=.5*v*Math.cos(a.rotation),u[1]+=.5*v*Math.sin(a.rotation),u[0]-=.5*b*Math.sin(a.rotation),u[1]+=.5*b*Math.cos(a.rotation),d[1]-=b,d[0]+=v;break;case 7:u[0]-=.5*b*Math.sin(a.rotation),u[1]+=.5*b*Math.cos(a.rotation),d[1]-=b}if("Cloud"==a.markupType||"Polyline"==a.markupType)return void this.draggingMultipleGrip(e,a,n,o,i,v,b,s,l,d,c,u);var y=[u[0]-.5*d[0],u[1]-.5*d[1]],w=[u[0]+.5*d[0],u[1]+.5*d[1]];"Text"==a.markupType&&a.resizeText(d),y=e.clientToWorldPoint(y),w=e.clientToWorldPoint(w),a.setPoints([y,w])},e.prototype.draggingMultipleGrip=function(e,t,n,o,i,a,r,s,l,d,c,u){var p=t.originPoints.slice(),h=c[0]-l[0]/2,f=c[1]-l[1]/2,m=u[0]-d[0]/2,g=u[1]-d[1]/2,v=function(t){for(var n=0;n<t.length;n++){var o=e.worldToClientPoint(t[n]),i=o[0],a=o[1],r=i-h,s=a-f;o[0]=r/l[0]*d[0]+m,o[1]=s/l[1]*d[1]+g,t[n]=e.clientToWorldPoint(o)}return t},b=v(p);if(t.setPoints(b),"Cloud"==t.markupType){var y=(t.originEditPt||t.originControlPt).slice();t.editPt=v(y)}},e}();n.default=a},{"./MarkupIO":14,"./MathUtil":22}],16:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.onDrawing=function(e,t,n,o){this.markup&&(t.strokeStyle=this.markup.strokeStyle,t.lineWidth=this.markup.lineWidth,t.fillStyle=this.markup.fillStyle,this.markup.draw(e,t,n,o))},e.prototype.addMarkup=function(e,t){t.drawEnd=!0,this.markupManager.add(t)},e.prototype.redraw=function(e){},e.prototype.onExit=function(e){},e.prototype.onMouseMove=function(e,t,n,o){},e}();n.default=o},{}],17:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("./MarkupEditor"),i=e("./MarkupManager"),a=e("./MarkupVirtualPad"),r=e("./MarkupIO"),s=e("./Mouse"),l=s.MouseButtons,d=function(){function e(t,n){var r=this;this.getIsDesktop=function(){var e=navigator.userAgent,t=/(?:Windows Phone)/.test(e),n=/(?:SymbianOS)/.test(e)||t,o=/(?:Android)/.test(e),i=/(?:Firefox)/.test(e),a=(/(?:Chrome|CriOS)/.test(e),/(?:iPad|PlayBook)/.test(e)||o&&!/(?:Mobile)/.test(e)||i&&/(?:Tablet)/.test(e));return!(/(?:iPhone)/.test(e)&&!a||o||n||a)},this.work=!1,this.alwaysMode=!1,this.restoreState=!1,this.firstTouch=0,this.modelViewer=t,this.canvas=document.createElement("canvas"),this.canvas.id="markup",this.canvas.style.zIndex=10,this.canvas.width=n.clientWidth,this.canvas.height=n.clientHeight,this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.left="0",this.ctx=this.canvas.getContext("2d"),this.wrapDom=n,this.canvas.style.display="none",e.isMobile=!this.getIsDesktop(),n.appendChild(this.canvas),this.bindEvent();var s=this;this.viewer=t.getViewer?t.getViewer():t,this.viewer.wrapDom=n,this.MarkupVirtualPad=new a.default(this.viewer,n,e.isMobile),this.viewer.markupManager=this.markupManager=new i.default(this.MarkupVirtualPad,this),this.editor=this.viewer.markupEditor=new o.default(this.canvas,this.markupManager,this.MarkupVirtualPad),this.editor.markupManager=this.viewer.markupManager,this.viewer.onSelectChange=function(e){},this.viewer.onClick=function(e){},this.initOnresize=window.onresize,window.onresize=function(){s.canvas.width=n.clientWidth,s.canvas.height=n.clientHeight,s.MarkupVirtualPad.canvas.width=n.clientWidth,s.MarkupVirtualPad.canvas.height=n.clientHeight,s.modelViewer.resize(),s.update(),"[object Function]"===toString.call(s.initOnresize)&&s.initOnresize()},e.isMobile&&(this.offsetHeight=this.wrapDom.offsetHeight,setInterval(function(){var e=r.wrapDom.offsetHeight;r.offsetHeight!=e&&(r.offsetHeight=e,r.resize())},1e3))}return e.prototype.resize=function(){this.editor.tool.reposition&&this.editor.tool.reposition(this.viewer)},e.prototype.getContainerSize=function(){return this.wrapDom.getBoundingClientRect()},e.prototype.hideCanvas=function(){this.canvas.style.display="none"},e.prototype.showCanvas=function(){this.canvas.style.display="block"},e.prototype.startDrawing=function(){this.work=!0,this.alwaysMode=!1,this.showCanvas()},e.prototype.switchMode=function(){},e.prototype.initStyle=function(){var e=this.viewer.markupManager;e.markups=[],e.strokeStyle="red",e.lineWidth=3,e.fontSize=14,e.fontFamily="Arial",e.fillStyle="white",e.enableFillStyle=!1},e.prototype.update=function(){this.editor.redraw(this.viewer)},e.prototype.bindEvent=function(){this.getIsDesktop()?(this.wrapDom.addEventListener("mousedown",this.onMouseDown.bind(this),!0),this.wrapDom.addEventListener("mouseup",this.onMouseUp.bind(this),!1),this.wrapDom.addEventListener("mousemove",this.onMouseMove.bind(this),!1),this.wrapDom.addEventListener("mousewheel",this.onMouseWheel.bind(this),!1),this.wrapDom.addEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),!1),this.wrapDom.addEventListener("contextmenu",this.oncontextmenu.bind(this),!1)):(this.wrapDom.addEventListener("touchstart",this.onTouchstart.bind(this),!0),this.wrapDom.addEventListener("touchend",this.onTouchend.bind(this),!0),this.wrapDom.addEventListener("touchmove",this.onTouchmove.bind(this),!0)),document.addEventListener("keydown",this.onKeyDown.bind(this)),document.addEventListener("keyup",this.onKeyUp.bind(this))},e.prototype.endDrawing=function(){this.work=!1,this.clearAnnotations(),this.editor.redraw(this.viewer),this.hideCanvas(),this.switchMode();var e=document.querySelector("#bf-drawing-textEditor");if(e){var t=e.querySelectorAll("textarea");t.length&&(t[t.length-1].style.display="none",t[t.length-1].value="")}},e.prototype.clearAnnotations=function(){this.markupManager.clear(),this.update()},e.prototype.removeSelectedAnnotation=function(){-1!=this.editor.editIndex&&(this.markupManager.remove(this.editor.editIndex),this.editor.editIndex=-1,this.update())},e.prototype.createSnapshot=function(e){},e.prototype.showAnnotation=function(){},e.prototype.setAnnotationType=function(e){this.editor.setMarkupType(e)},e.prototype.setAnnotationStyle=function(e){e["stroke-color"]&&this.markupManager.setColor(e["stroke-color"]),e["font-size"]&&this.markupManager.setFontSize(e["font-size"]),e["stroke-width"]&&this.markupManager.setLineWidth(e["stroke-width"]),e["fill-color"]&&this.markupManager.setFillColor(e["fill-color"]),e["font-family"]&&this.markupManager.setFontFamily(e["font-family"])},e.prototype.getAnnotationList=function(){return this.markupManager.markups.slice()},e.prototype.setAnnotationList=function(e){var t=e[0];if(!t)return this.clearAnnotations();if(t.drawPoints&&"number"==typeof t.drawPoints[0])for(var n=0;n<e.length;n++){for(var o=e[n].drawPoints,i=[],a=0;a<o.length;a+=2)i.push([o[a],o[a+1]]);e[n].drawPoints=i}t&&t.draw||(e=r.default.transform2markups(e)),this.markupManager.setMarkups(e),this.restoreState=!0,this.showCanvas(),this.update()},e.prototype.editAnnotationEnd=function(){this.endDrawing()},e.prototype.getCurrentState=function(){return{annotationList:this.getAnnotationList(),state:this.modelViewer.getCurrentState()}},e.prototype.transform=function(e){return e},e.prototype.setState=function(e){var t=this;this.clearAnnotations(),this.modelViewer.setState(e.state),setTimeout(function(){if("string"==typeof e.annotationList){var n=t.markupManager.fromString(e.annotationList);t.setAnnotationList(n)}else e.annotationList[0].id?t.setAnnotationList(t.transform(e.annotationList)):t.setAnnotationList(e.annotationList)},1500)},e.prototype.oncontextmenu=function(e){e.preventDefault()},e.prototype.onDoubleClick=function(e){this.alwaysMode||(!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),e.preventDefault(),this.editor.onDoubleClick(this.viewer,e))},e.prototype.onMouseDown=function(e){if(!this.alwaysMode&&(!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&e.target==this.canvas))if(e.preventDefault(),e.buttons==l.LelftButton){e.stopPropagation();var t=Date.now(),n=[e.clientX,e.clientY];t-this.prevTime<500&&this.prevPoint[0]==n[0]?this.onDoubleClick(e):(this.prevTime=t,this.prevPoint=n,this.editor.onMouseDown(this.viewer,e))}else this.editor.onMouseDown(this.viewer,e)},e.prototype.onTouchstart=function(e){if(!this.alwaysMode&&"CANVAS"==e.target.tagName.toUpperCase()){var t=Date.now();if(t-this.firstTouch<500)return void this.editor.onDoubleTouch(this.viewer,e);this.firstTouch=t,!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&e.target==this.canvas&&(e.preventDefault(),e.buttons==l.LelftButton&&e.stopPropagation(),this.editor.onTouchstart(this.viewer,e),this.containerSize=this.getContainerSize())}},e.prototype.onMouseMove=function(e){if(this.alwaysMode)return void this.update();this.work&&(e.preventDefault(),e.stopPropagation(),this.editor.onMouseMove(this.viewer,e))},e.prototype.onTouchmove=function(e){if(this.alwaysMode||"CANVAS"!=e.target.tagName.toUpperCase())return void this.update();if(this.work){var t=e.touches[0],n=this.containerSize,o=n.left,i=n.top,a=n.width,r=n.height;e.preventDefault(),e.stopPropagation(),t.pageX>o&&t.pageX<o+a&&t.pageY>i&&t.pageY<i+r&&this.editor.onTouchmove(this.viewer,e)}},e.prototype.onTouchend=function(e){this.alwaysMode||"CANVAS"!=e.target.tagName.toUpperCase()||(!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&(e.preventDefault(),e.stopPropagation(),this.editor.onTouchend(this.viewer,e)))},e.prototype.onMouseWheel=function(e){this.alwaysMode||(!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&(e.preventDefault(),e.stopPropagation(),this.editor.onMouseWheel(this.viewer,e)))},e.prototype.onMouseUp=function(e){if(this.alwaysMode)return void this.editor.onMouseUp(this.viewer,e,!0);!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&(e.preventDefault(),e.stopPropagation(),this.editor.onMouseUp(this.viewer,e,!0))},e.prototype.onKeyDown=function(e){this.work&&("textarea"!=document.activeElement.tagName.toLowerCase()&&e.stopPropagation(),this.editor.onKeyDown(this.viewer,e))},e.prototype.onKeyUp=function(e){this.work&&"textarea"!=document.activeElement.tagName.toLowerCase()&&(e.preventDefault(),e.stopPropagation())},e}();n.MarkupViewer=d},{"./MarkupEditor":13,"./MarkupIO":14,"./MarkupManager":15,"./MarkupVirtualPad":20,"./Mouse":23}],18:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./MarkupViewer"),a=e("./ArrowMarkup/ArrowMarkup"),r=e("./EllipsMarkup/EllipsMarkup"),s=e("./RectMarkup/RectMarkup"),l=e("./CrossMarkup/CrossMarkup"),d=e("./CloudMarkup/CloudMarkup"),c=e("./CloudRectMarkup/CloudRectMarkup"),u=e("./TextMarkup/TextMarkup"),p=e("./Mouse"),h=p.MouseButtons,f=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.absoluteBasePoint=null,o.screenBasePoint=null,o.zoomFactor={x:1,y:1},o.viewBox={width:1e3,height:1e3},o.viewer.clientToWorldPoint=function(e){var t=o.viewer.clientToWorld({x:e[0],y:e[1]});return[t.x,t.y]},o.viewer.worldToClientPoint=function(e){var t=o.viewer.worldToClient({x:e[0],y:e[1]});return[t.x,t.y]},o}return o(t,e),t.prototype.onMouseUp=function(e){!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&this.editor.onMouseUp(this.viewer,e)},t.prototype.setState=function(e){if(this.modelViewer.setState(e.state),"string"==typeof e.annotationList){var t=this.markupManager.fromString(e.annotationList);this.setAnnotationList(t)}else e.annotationList[0].id?this.setAnnotationList(this.transform(e.annotationList)):this.setAnnotationList(e.annotationList)},t.prototype.createSnapshot=function(e){var t=this;this.viewer._imageRender.createSnapshotAsync("",function(n){t.getScreenSnapshot(n,e)})},t.prototype.getScreenSnapshot=function(e,t){var n=document.createElement("canvas"),o=this.getContainerOffsetToClient(this.wrapDom);n.width=o.width,n.height=o.height;var i=n.getContext("2d"),a=this;if(t&&e){var r=new Image;return r.onload=function(){i.drawImage(r,0,0),i.drawImage(a.canvas,0,0);var e=n.toDataURL("image/png");n=i=null,t(e)},r.src=e,null}if(e){var r=new Image;r.src=e,i.drawImage(r,0,0)}i.drawImage(this.canvas,0,0);var s=n.toDataURL("image/png");return n=i=null,s},t.prototype.transform=function(e){for(var t=[],n=0;n<e.length;n++){var o,i=e[n],p=i.style,h=p["fill-opacity"];switch(i.shapeType){case 0:var f=this.getArrowPoints(i.size,i.position,-i.rotation);o=new a.default(f,p["stroke-color"],p["stroke-width"],i.rotation);break;case 7:o=new c.default(this.getDrawPoints(i.size,i.position),p["stroke-color"],p["stroke-width"],i.rotation,h&&p["fill-color"]);break;case 4:var m=this.getCloudPoints(i);o=new d.default(m[0],p["stroke-color"],p["stroke-width"],m[1],i.rotation,h&&p["fill-color"]);break;case 1:o=new s.default(this.getDrawPoints(i.size,i.position),p["stroke-color"],p["stroke-width"],i.rotation,h&&p["fill-color"]);break;case 2:o=new r.default(this.getDrawPoints(i.size,i.position),p["stroke-color"],p["stroke-width"],i.rotation,h&&p["fill-color"]);break;case 3:o=new l.default(this.getDrawPoints(i.size,i.position),p["stroke-color"],p["stroke-width"],i.rotation);break;case 5:var g=this.worldToClient({x:i.position.x-.5*i.size.width,y:i.position.y+.5*i.size.height,z:i.position.z}),v=this.worldToClient(i.position),b=this.viewer.clientToWorldPoint([v.x,v.y]);o=new u.default(this.viewer.clientToWorldPoint([g.x,g.y]),decodeURIComponent(i.text),p["stroke-color"],p["font-size"],p["font-family"],i.rotation,null,b)}t.push(o)}return t},t.prototype.getContainerOffsetToClient=function(e){var t,n=function(e){for(var t=0,n=0;e;)t+=e.offsetTop,n+=e.offsetLeft,e=e.offsetParent;var o=document.body,i=document.documentElement,a=window.pageYOffset||i.scrollTop||o.scrollTop,r=window.pageXOffset||i.scrollLeft||o.scrollLeft;return t-=a,n-=r,{top:t,left:n}},o=function(e){var t=e.getBoundingClientRect(),n=document.body,o=document.documentElement,i=o.clientTop||n.clientTop,a=o.clientLeft||n.clientLeft,r=t.top-i,s=t.left-a;return{top:Math.round(r),left:Math.round(s)}};if(e!=document){var i=function(e){return e.getBoundingClientRect?o(e):n(e)}(e);t={width:e.offsetWidth,height:e.offsetHeight,left:i.left,top:i.top}}else t={width:window.innerWidth,height:window.innerHeight,left:0,top:0};return t},t.prototype.getCloudPoints=function(e){for(var t=e.size.width/e.originSize.width,n=e.size.height/e.originSize.height,o=(new window.THREE.Matrix4).makeScale(t,n,1),i=(new window.THREE.Matrix4).makeRotationZ(-e.rotation),a=(new window.THREE.Matrix4).makeTranslation(e.position.x,e.position.y,e.position.z),r=a.multiply(i).multiply(o),s=e.shapePoints.split(","),l=[],d=[],c=!0,u=(e.position,1);u<s.length;u+=2){var p=new window.THREE.Vector3,h=this.viewBoxToWorld({x:parseInt(s[u-1]),y:parseInt(s[u])},e.originSize);p.x=h.x,p.y=h.y,p.z=0,p.applyMatrix4(r);var f=this.worldToClient(p),m=this.viewer.clientToWorldPoint([f.x,f.y]);c?l.push(m):d.push(m),c=!c}return[l,d]},t.prototype.worldToClient=function(e){var t=this.getContainerOffsetToClient(this.wrapDom),n=new window.THREE.Vector3,o=this.absoluteBasePoint,i=this.screenBasePoint;return this.absoluteBasePoint||(o={x:0,y:0}),this.screenBasePoint||(i={x:.5*t.width,y:.5*t.height}),n.x=(e.x-o.x)*this.zoomFactor.x+i.x,n.y=(-e.y-o.y)*this.zoomFactor.y+i.y,n.z=0,n},t.prototype.viewBoxToWorld=function(e,t){var n=t.width,o=t.height,i=this.viewBox.width,a=this.viewBox.height;return{x:e.x/i*n,y:e.y/a*o}},t.prototype.getDrawPoints=function(e,t){var n=this.worldToClient({x:t.x-.5*e.width,y:t.y-.5*e.height,z:t.z}),o=this.worldToClient({x:t.x+.5*e.width,y:t.y+.5*e.height,z:t.z});return[this.viewer.clientToWorldPoint([n.x,n.y]),this.viewer.clientToWorldPoint([o.x,o.y])]},t.prototype.getArrowPoints=function(e,t,n){var o=this.worldToClient({x:t.x-.5*e.width,y:t.y,z:t.z}),i=this.worldToClient({x:t.x+.5*e.width,y:t.y,z:t.z}),a=this.worldToClient(t);return o=this.markupManager.rotateTransform(a.x,a.y,n,o.x,o.y),i=this.markupManager.rotateTransform(a.x,a.y,n,i.x,i.y),[this.viewer.clientToWorldPoint(o),this.viewer.clientToWorldPoint(i)]},t.prototype.onMouseDown=function(e){if(!this.work&&this.restoreState&&(this.restoreState=!1,this.endDrawing()),this.work&&e.target==this.canvas)if(e.preventDefault(),e.buttons==h.LelftButton){e.stopPropagation();var t=Date.now(),n=[e.clientX,e.clientY];t-this.prevTime<500&&this.prevPoint[0]==n[0]?this.onDoubleClick(e):(this.prevTime=t,this.prevPoint=n,this.editor.onMouseDown(this.viewer,e))}else this.editor.onMouseDown(this.viewer,e)},t.prototype.onMouseWheel=function(e){this.work&&(e.preventDefault(),this.update(),this.editor.onMouseWheel(this.viewer,e))},t}(i.MarkupViewer);n.MarkupViewer2D=f,window.MarkupViewer2D=f},{"./ArrowMarkup/ArrowMarkup":1,"./CloudMarkup/CloudMarkup":3,"./CloudRectMarkup/CloudRectMarkup":5,"./CrossMarkup/CrossMarkup":7,"./EllipsMarkup/EllipsMarkup":9,"./MarkupViewer":17,"./Mouse":23,"./RectMarkup/RectMarkup":26,"./TextMarkup/TextMarkup":28}],19:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./MarkupViewer"),a=e("./ArrowMarkup/ArrowMarkup"),r=e("./EllipsMarkup/EllipsMarkup"),s=e("./RectMarkup/RectMarkup"),l=e("./CrossMarkup/CrossMarkup"),d=e("./CloudMarkup/CloudMarkup"),c=e("./CloudRectMarkup/CloudRectMarkup"),u=e("./TextMarkup/TextMarkup"),p=e("./Mouse"),h=(p.MouseButtons,function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.cameraControl=o.viewer.cameraControl,o.viewBox={width:1e3,height:1e3},o.viewer.clientToWorldPoint=function(e){var t={x:e[0],y:e[1],z:0},n=o.viewer.canvasToWorld(t);return[n.x,n.y,n.z]},o.viewer.worldToClientPoint=function(e){var t={x:e[0],y:e[1],z:e[2]||0},n=o.viewer.worldToCanvas(t);return[n.x,n.y]},o}return o(t,e),t.prototype.bindEvent=function(){this.getIsDesktop()?(this.wrapDom.addEventListener("dblclick",this.onDoubleClick.bind(this),!0),this.wrapDom.addEventListener("mousedown",this.onMouseDown.bind(this),!0),this.wrapDom.addEventListener("mouseup",this.onMouseUp.bind(this),!0),this.wrapDom.addEventListener("mousemove",this.onMouseMove.bind(this),!0),this.wrapDom.addEventListener("mousewheel",this.onMouseWheel.bind(this),!0),this.wrapDom.addEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),!0),this.wrapDom.addEventListener("contextmenu",this.oncontextmenu.bind(this),!0),document.addEventListener("keydown",this.onKeyDown.bind(this),!0),document.addEventListener("keyup",this.onKeyUp.bind(this),!0)):(this.wrapDom.addEventListener("touchstart",this.onTouchstart.bind(this),!0),this.wrapDom.addEventListener("touchend",this.onTouchend.bind(this),!0),this.wrapDom.addEventListener("touchmove",this.onTouchmove.bind(this),!0))},t.prototype.createSnapshot=function(e){var t=this.wrapDom.querySelector(".bf-view canvas"),n=document.createElement("canvas");n.width=this.wrapDom.clientWidth,n.height=this.wrapDom.clientHeight;var o=n.getContext("2d");o.beginPath();var i=window.devicePixelRatio||1;o.drawImage(t,0,0,n.width*i,n.height*i,0,0,n.width,n.height),o.drawImage(this.canvas,0,0),e(n.toDataURL())},t.prototype.transform=function(e){for(var t=[],n=0;n<e.length;n++){var o,i=e[n],p=i.style,h=p["fill-opacity"];switch(i.shapeType){case 0:var f=this.getArrowPoints(i.size,i.position,-i.rotation);o=new a.default(f,p["stroke-color"],p["stroke-width"],i.rotation);break;case 7:o=new c.default(this.getDrawPoints(i.size,i.position),p["stroke-color"],p["stroke-width"],i.rotation,h&&p["fill-color"]);break;case 4:var m=this.getCloudPoints(i);o=new d.default(m[0],p["stroke-color"],p["stroke-width"],m[1],i.rotation,h&&p["fill-color"],!0),o.close=!0;break;case 1:o=new s.default(this.getDrawPoints(i.size,i.position),p["stroke-color"],p["stroke-width"],i.rotation,h&&p["fill-color"]);break;case 2:o=new r.default(this.getDrawPoints(i.size,i.position),p["stroke-color"],p["stroke-width"],i.rotation,h&&p["fill-color"]);break;case 3:o=new l.default(this.getDrawPoints(i.size,i.position),p["stroke-color"],p["stroke-width"],i.rotation);break;case 5:var g=this.worldToClient({x:i.position.x-.5*i.size.width,y:i.position.y+.5*i.size.height,z:i.position.z}),v=this.worldToClient(i.position),b=this.viewer.clientToWorldPoint([v.x,v.y]);o=new u.default(this.viewer.clientToWorldPoint([g.x,g.y]),decodeURIComponent(i.text),p["stroke-color"],p["font-size"],p["font-family"],i.rotation,null,b)}t.push(o)}return t},t.prototype.getCloudPoints=function(e){for(var t=e.size.width/e.originSize.width,n=e.size.height/e.originSize.height,o=(new window.THREE.Matrix4).makeScale(t,n,1),i=(new window.THREE.Matrix4).makeRotationZ(-e.rotation),a=(new window.THREE.Matrix4).makeTranslation(e.position.x,e.position.y,e.position.z),r=a.multiply(i).multiply(o),s=e.shapePoints.split(","),l=[],d=[],c=!0,u=(e.position,1);u<s.length;u+=2){var p=new window.THREE.Vector3,h=this.viewBoxToWorld({x:parseInt(s[u-1]),y:parseInt(s[u])},e.originSize);p.x=h.x,p.y=h.y,p.z=0,p.applyMatrix4(r);var f=this.worldToClient(p),m=this.viewer.clientToWorldPoint([f.x,f.y]);c?l.push(m):d.push(m),c=!c}return[l,d]},t.prototype.viewBoxToWorld=function(e,t){var n=t.width,o=t.height,i=this.viewBox.width,a=this.viewBox.height;return{x:e.x/i*n,y:e.y/a*o}},t.prototype.getDrawPoints=function(e,t){var n=this.worldToClient({x:t.x-.5*e.width,y:t.y-.5*e.height,z:t.z}),o=this.worldToClient({x:t.x+.5*e.width,y:t.y+.5*e.height,z:t.z});return[this.viewer.clientToWorldPoint([n.x,n.y]),this.viewer.clientToWorldPoint([o.x,o.y])]},t.prototype.getArrowPoints=function(e,t,n){var o=this.worldToClient({x:t.x-.5*e.width,y:t.y,z:t.z}),i=this.worldToClient({x:t.x+.5*e.width,y:t.y,z:t.z}),a=this.worldToClient(t);return o=this.markupManager.rotateTransform(a.x,a.y,n,o.x,o.y),i=this.markupManager.rotateTransform(a.x,a.y,n,i.x,i.y),[this.viewer.clientToWorldPoint(o),this.viewer.clientToWorldPoint(i)]},t.prototype.worldToClient=function(e){var t=this.getContainerOffsetToClient(this.wrapDom),n=this.cameraControl.getCamera(),o=new window.THREE.Vector3(e.x,e.y,e.z);return o.applyMatrix4(n.matrixWorld),o.sub(n.position),o.project(n),o.x=Math.floor(.5*(o.x+1)*t.width+.5),o.y=Math.floor(-.5*(o.y-1)*t.height+.5),o.z=0,o},t.prototype.getContainerOffsetToClient=function(e){var t,n=function(e){for(var t=0,n=0;e;)t+=e.offsetTop,n+=e.offsetLeft,e=e.offsetParent;var o=document.body,i=document.documentElement,a=window.pageYOffset||i.scrollTop||o.scrollTop,r=window.pageXOffset||i.scrollLeft||o.scrollLeft;return t-=a,n-=r,{top:t,left:n}},o=function(e){var t=e.getBoundingClientRect(),n=document.body,o=document.documentElement,i=o.clientTop||n.clientTop,a=o.clientLeft||n.clientLeft,r=t.top-i,s=t.left-a;return{top:Math.round(r),left:Math.round(s)}};if(e!=document){var i=function(e){return e.getBoundingClientRect?o(e):n(e)}(e);t={width:e.offsetWidth,height:e.offsetHeight,left:i.left,top:i.top}}else t={width:window.innerWidth,height:window.innerHeight,left:0,top:0};return t},t}(i.MarkupViewer));n.MarkupViewer3D=h,window.MarkupViewer3D=h},{"./ArrowMarkup/ArrowMarkup":1,"./CloudMarkup/CloudMarkup":3,"./CloudRectMarkup/CloudRectMarkup":5,"./CrossMarkup/CrossMarkup":7,"./EllipsMarkup/EllipsMarkup":9,"./MarkupViewer":17,"./Mouse":23,"./RectMarkup/RectMarkup":26,"./TextMarkup/TextMarkup":28}],20:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("./MarkupViewer"),i=function(){function e(e,t,n){this.isMobile=n,this.canvas=document.createElement("canvas"),this.viewer=e,this.canvas.id="markupVirtual",this.canvas.width=t.clientWidth,this.canvas.height=t.clientHeight,document.body.appendChild(this.canvas),this.canvas.style.display="none",this.ctx=this.canvas.getContext("2d"),this.lineWidth=o.MarkupViewer.isMobile?36:2}return e.prototype.init=function(e,t){var n=this.ctx;n.save(),n.translate(e[0],e[1]),n.rotate(t),n.beginPath()},e.prototype.drawEdit=function(e,t,n,o,i,a,r,s,l){var d=this.ctx;if(d.save(),d.translate(n[0],n[1]),"Arrow"!=o.markupType&&d.rotate(o.rotation),d.beginPath(),d.lineWidth=o.lineWidth+2,d.fillStyle="rgba("+(2*a+2)+",255,255,1)",d.fillRect(-.5*(t[0]-e[0]),-.5*(t[1]-e[1]),t[0]-e[0],t[1]-e[1]),d.fillStyle=d.strokeStyle="rgba("+(2*a+2)+",100,255,1)",d.arc(0,e[1]-n[1]-20,13,0,2*Math.PI,!1),d.fill(),"Arrow"==o.markupType)d.fillStyle=d.strokeStyle="rgba("+(2*a+2)+",110,255,1)",d.beginPath(),d.arc(i[0]-n[0]+(i[0]<i[2]?-r/2:r/2),i[1]-n[1]+(i[1]<i[3]?-s/2:s/2),10,0,2*Math.PI,!1),d.fill(),d.stroke(),d.closePath(),d.fillStyle=d.strokeStyle="rgba("+(2*a+2)+",150,255,1)",d.beginPath(),d.arc(i[2]-n[0]+(i[0]<i[2]?r:-r),i[3]-n[1]+(i[1]<i[3]?s:-s),10,0,2*Math.PI,!1),d.fill(),d.stroke(),d.closePath();else for(var c=0;c<i.length;c+=2){d.fillStyle=d.strokeStyle="rgba("+(2*a+2)+","+(5*c+110)+",255,1)",d.beginPath();var u=[i[c],i[c+1]],p=this.isMobile?10:3;switch(c){case 0:d.arc(u[0]-n[0]-l,u[1]-n[1]-l,p,0,2*Math.PI,!1);break;case 2:d.arc(u[0]-n[0]-l,u[1]-n[1],p,0,2*Math.PI,!1);break;case 4:d.arc(u[0]-n[0]-l,u[1]-n[1]+l,p,0,2*Math.PI,!1);break;case 6:d.arc(u[0]-n[0],u[1]-n[1]+l,p,0,2*Math.PI,!1);break;case 8:d.arc(u[0]-n[0]+l,u[1]-n[1]+l,p,0,2*Math.PI,!1);break;case 10:d.arc(u[0]-n[0]+l,u[1]-n[1],p,0,2*Math.PI,!1);break;case 12:d.arc(u[0]-n[0]+l,u[1]-n[1]-l,p,0,2*Math.PI,!1);break;case 14:d.arc(u[0]-n[0],u[1]-n[1]-l,p,0,2*Math.PI,!1)}d.fill(),d.stroke(),d.closePath()}d.restore()},e.prototype.drawArrow=function(e,t,n,i,a,r,s,l,d,c,u,p,h,f){var m=t-r,g=n-s,v=this.ctx;v.save(),v.lineWidth=o.MarkupViewer.isMobile?36:e.lineWidth+this.lineWidth,v.strokeStyle="rgba("+(2*p+2)+",20,20,1)",v.fillStyle="rgba("+(2*p+2)+",20,255,1)",v.beginPath(),v.moveTo(t,n),v.lineTo(i,a),m=i+r,g=a+s,v.moveTo(m,g),v.lineTo(i,a),m=i+l,g=a+d,v.lineTo(m,g),v.stroke(),v.restore()},e.prototype.drawRect=function(e,t,n,i,a,r){var s=this.ctx;s.save(),s.translate(i[0],i[1]),s.rotate(a),s.beginPath(),s.lineWidth=o.MarkupViewer.isMobile?36:e.lineWidth+this.lineWidth,s.strokeStyle="rgba("+(2*r+2)+",10,10,1)",s.fillStyle="rgba("+(2*r+2)+",10,255,1)",s.rect(-.5*(n[0]-t[0]),-.5*(n[1]-t[1]),n[0]-t[0],n[1]-t[1]),s.closePath(),s.stroke(),s.restore()},e.prototype.drawCross=function(e,t,n,o,i){var a=this.ctx;a.save(),a.translate(n[0],n[1]),a.rotate(o),a.strokeStyle="rgba("+(2*i+2)+",30,30,1)",a.fillStyle="rgba("+(2*i+2)+",30,255,1)",a.beginPath(),a.moveTo(-.5*(t[0]-e[0]),-.5*(t[1]-e[1])),a.lineTo(.5*(t[0]-e[0]),.5*(t[1]-e[1])),a.moveTo(-.5*(t[0]-e[0]),.5*(t[1]-e[1])),a.lineTo(.5*(t[0]-e[0]),-.5*(t[1]-e[1])),a.stroke(),a.restore()},e.prototype.drawCloudRect=function(e,t,n,o,i){var a=this.ctx;a.moveTo(e,t),a.quadraticCurveTo(n[0],n[1],o[0],o[1])},e.prototype.drawEllips=function(e,t,n,o,i,a,r){var s=this.ctx;s.save(),s.strokeStyle="rgba("+(2*i+2)+",50,50,1)",s.fillStyle="rgba("+(2*i+2)+",50,255,1)",s.translate(n[0],n[1]),s.rotate(o),s.beginPath(),s.ellipse(0,0,a,r,0,0,2*Math.PI),s.closePath(),s.stroke(),s.restore()},e.prototype.drawPolyline=function(e,t,n,o,i){var a=this.ctx;a.strokeStyle="rgba("+(2*i+2)+",70,70,1)",a.moveTo(e[0]-n[0],e[1]-n[1]),a.lineTo(t[0]-n[0],t[1]-n[1]),a.stroke()},e.prototype.isEdge=function(e,t){var n=this.ctx.getImageData(e,t,1,1),o=n.data,i=o[0],a=o[1],r=o[2],s=o[3];return r==a&&a<100&&r%10==0&&i>=2&&255==s},e.prototype.hitTest=function(e,t){var n=this.ctx.getImageData(e,t,1,1),o=n.data,i=o[0],a=o[1],r=o[2],s=o[3];return i+a+r<3?-1:r==a&&a<100&&r%10==0&&i>=2&&255==s?(i-2)/2:255==r&&a>99?(i-2)/2:void 0},e.prototype.hitGrip=function(e,t){var n=this.ctx.getImageData(e,t,1,1),o=n.data,i=o[0],a=o[1],r=o[2];if(i+a+r+o[3]<3)return-1;if(255==r){if(100==a)return 9;if(255==a)return 10;if(a>100)return(a-110)/10}return-1},e}();n.MarkupVirtualPad=i,n.default=i},{"./MarkupViewer":17}],21:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.getCenter=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]);return[(t[0]+n[0])/2,(t[1]+n[1])/2]},e.prototype.setColor=function(e){e&&(this.highLight=e)},e.prototype.getColor=function(){return this.strokeStyle},e}();n.default=o},{}],22:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){}return e.distance=function(e,t){var n=t.x-e.x,o=t.y-e.y;return Math.sqrt(n*n+o*o)},e.center=function(e,t){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}},e.centerByArr=function(e,t){return[(t[0]+e[0])/2,(t[1]+e[1])/2]},e.distanceByArr=function(e,t){var n=t[0]-e[0],o=t[1]-e[1];return Math.sqrt(n*n+o*o)},e.normalize=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]},e.isPointInBBox=function(e,t,n,o){var i=.5*o[0];if(e<n[0]-i||e>n[0]+i)return!1;var a=.5*o[1];return!(t<n[1]-a||t>n[1]+a)},e.rotateAround=function(e,t,n){var o=[0,0],i=Math.cos(n),a=Math.sin(n),r=e[0]-t[0],s=e[1]-t[1];return o[0]=r*i-s*a+t[0],o[1]=r*a+s*i+t[1],o},e}();n.default=o},{}],23:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});!function(e){e[e.CONTINUE=0]="CONTINUE",e[e.FINISHED=1]="FINISHED",e[e.LelftButton=1]="LelftButton",e[e.RightButton=2]="RightButton",e[e.MiddleButton=4]="MiddleButton",e[e.MouseMode=1]="MouseMode",e[e.TouchMode=2]="TouchMode"}(n.MouseButtons||(n.MouseButtons={}))},{}],24:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0})
;var i=e("../MathUtil"),a=e("../MarkupViewer"),r=e("../Markups"),s=function(e){function t(t,n,o,i,a,r){var s=e.call(this)||this;return s.rotation=i||0,s.close=r||!1,s.fillStyle=a,s.markupType="Polyline",s.drawPoints=t,s.strokeStyle=n,s.lineWidth=o,s.editPt=null,s.bNeedHitByBbox=!1,s}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var i=e.markupManager.getMarkupCenter(e,o);i||(i=[0,0]),t.save(),t.translate(i[0],i[1]),t.rotate(this.rotation),t.beginPath(),t.lineJoin="round",n.init(i,this.rotation),n.ctx.lineWidth=a.MarkupViewer.isMobile?36:this.lineWidth+n.lineWidth;for(var r=1,s=this.drawPoints.length;r<s;r++){var l=e.worldToClientPoint([this.drawPoints[r-1][0],this.drawPoints[r-1][1],this.drawPoints[r-1][2]]),d=e.worldToClientPoint([this.drawPoints[r][0],this.drawPoints[r][1],this.drawPoints[r][2]]);1==r&&t.moveTo(l[0]-i[0],l[1]-i[1]),t.lineTo(d[0]-i[0],d[1]-i[1]),n.drawPolyline(l,d,i,this.rotation,o)}this.close&&this.fillStyle&&t.fill(),t.stroke(),t.restore(),n.ctx.restore()}},t.prototype.shouldClose=function(e,t,n){if(this.drawPoints.length<3)return!1;var o=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]);return i.default.distanceByArr(o,[t,n])<5?(this.close=!0,!0):(this.close=!1,!1)},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.addPoint=function(e){this.drawPoints.push(e)},t.prototype.getStartPoint=function(){return this.drawPoints[0]},t.prototype.popPoint=function(){this.drawPoints.pop()},t.prototype.isEmpty=function(){return 0==this.drawPoints.length},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e,t){if(void 0==t)return this.drawPoints;var n=e.markupManager.getMarkupBbox(e,t),o=[n[0],n[1]],i=[n[2],n[3]],a=[(o[0]+i[0])/2,(o[1]+i[1])/2],r=[];return r.push(o[0],o[1]),r.push(o[0],a[1]),r.push(o[0],i[1]),r.push(a[0],i[1]),r.push(i[0],i[1]),r.push(i[0],a[1]),r.push(i[0],o[1]),r.push(a[0],o[1]),r},t}(r.default);n.default=s},{"../MarkupViewer":17,"../Markups":21,"../MathUtil":22}],25:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./PolylineMarkup"),a=e("../MarkupTool"),r=e("../Mouse"),s=r.MouseButtons,l=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n.bFirstCloudMarkup=!0,n.uncertainty=!1,n}return o(t,e),t.prototype.begin=function(e,t,n,o){if(this.bFirstCloudMarkup){if(e.markupManager.hitTest(e,t,n)>-1)return;var a=e.markupManager.getColor(),r=e.markupManager.getLineWidth(),s=e.markupManager.getFillStyleState()?e.markupManager.getFillColor():void 0;this.markup=new i.default([],a,r,0,s),this.bFirstCloudMarkup=!1}if(this.markup.shouldClose(e,t,n))this.addMarkup(e,this.markup),this.markup=null,this.redraw(e),this.bFirstCloudMarkup=!0;else{var l=e.clientToWorldPoint([t,n]);this.markup.popPoint(),this.markup.addPoint(l)}this.uncertainty=!1},t.prototype.onEditing=function(e,t,n,o){if(!this.bFirstCloudMarkup){var i=void 0;i=this.markup.shouldClose(e,t,n)?this.markup.getStartPoint():e.clientToWorldPoint([t,n]),this.uncertainty&&this.markup.drawPoints.length>1?this.markup.popPoint():this.uncertainty=!0,this.markup.addPoint(i),this.redraw(e)}},t.prototype.onMouseMove=function(e,t,n,o){this.onEditing(e,t,n,o)},t.prototype.end=function(e,t,n,o){if(this.bFirstCloudMarkup)return s.FINISHED},t.prototype.onMouseRightClick=function(e,t){this.bFirstCloudMarkup||(this.markup.popPoint(),this.markup.drawPoints.length>1&&this.addMarkup(e,this.markup),this.markup=null,this.redraw(e),this.bFirstCloudMarkup=!0)},t.prototype.onDoubleClick=function(e,t){if(!this.bFirstCloudMarkup){this.markup.popPoint();this.markup.drawPoints.length>1&&this.addMarkup(e,this.markup),this.markup=null,this.redraw(e),this.bFirstCloudMarkup=!0}},t}(a.default);n.default=l},{"../MarkupTool":16,"../Mouse":23,"./PolylineMarkup":24}],26:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../Markups"),a=e("../MarkupViewer"),r=function(e){function t(t,n,o,i,a){var r=e.call(this)||this;return r.rotation=i||0,r.markupType="Rectangle",r.drawPoints=t,r.strokeStyle=n,r.lineWidth=o,r.fillStyle=a,r.bNeedHitByBbox=!0,r}return o(t,e),t.prototype.draw=function(e,t,n,o){if(!(this.drawPoints.length<2)){var i=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]),r=e.worldToClientPoint([this.drawPoints[1][0],this.drawPoints[1][1],this.drawPoints[1][2]]),s=this.getCenter(e);t.save(),t.translate(s[0],s[1]),t.rotate(this.rotation),t.beginPath(),t.rect(-.5*(r[0]-i[0]),-.5*(r[1]-i[1]),r[0]-i[0],r[1]-i[1]),t.restore(),t.closePath(),this.fillStyle&&t.fill(),t.stroke(),n.ctx.lineWidth=a.MarkupViewer.isMobile?36:this.lineWidth+n.lineWidth,n.ctx.fillStyle=this.fillStyle,n.drawRect(this,i,r,s,this.rotation,o)}},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]),o=[(t[0]+n[0])/2,(t[1]+n[1])/2],i=[];return i.push(t[0],t[1]),i.push(t[0],o[1]),i.push(t[0],n[1]),i.push(o[0],n[1]),i.push(n[0],n[1]),i.push(n[0],o[1]),i.push(n[0],t[1]),i.push(o[0],t[1]),i},t.prototype.getRotateGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]),n=e.worldToClientPoint(this.drawPoints[1]);return[[(t[0]+n[0])/2,(t[1]+n[1])/2][0],t[1]-20]},t}(i.default);n.default=r},{"../MarkupViewer":17,"./../Markups":21}],27:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../MarkupTool"),a=e("./RectMarkup"),r=e("./../Mouse"),s=r.MouseButtons,l=function(e){function t(t){var n=e.call(this)||this;return n.markupManager=t,n}return o(t,e),t.prototype.begin=function(e,t,n,o){this.startX=t,this.startY=n;var i=e.markupManager.getColor(),r=e.markupManager.getLineWidth(),s=e.markupManager.getFillStyleState()?e.markupManager.getFillColor():void 0;this.markup=new a.default([],i,r,0,s)},t.prototype.onEditing=function(e,t,n,o){var i=e.clientToWorldPoint([this.startX,this.startY]),a=e.clientToWorldPoint([t,n]);this.markup.setPoints([i,a]),this.redraw(e)},t.prototype.end=function(e,t,n,o){return this.startX==t&&this.startY==n?(console.log("Ignore single point."),s.FINISHED):(this.addMarkup(e,this.markup),this.markup=null,s.FINISHED)},t}(i.default);n.default=l},{"./../MarkupTool":16,"./../Mouse":23,"./RectMarkup":26}],28:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../Markups"),a=function(e){function t(t,n,o,i,a,r,s,l,d){var c=e.call(this)||this;c.rotation=r||0,c.textAreaId=s||null,c.center=l||null,c.markupType="Text",c.drawPoints=d?t:[t],c.pureText=n,c.userText=n,c.strokeStyle=o,c.fontSize=i,c.fontFamily=a;var u=document.createElement("canvas");return c.virtualCtx=u.getContext("2d"),c.bNeedHitByBbox=!1,c}return o(t,e),t.prototype.draw=function(e,t,n,o){var i=e.worldToClientPoint(this.drawPoints[0]),a=this.getTextBbox(e),r=[(a[2]+a[0])/2,(a[3]+a[1])/2];this.center&&(r=e.worldToClientPoint(this.center)),t.save(),t.translate(r[0],r[1]),t.rotate(this.rotation),t.beginPath(),n.init(r,this.rotation),t.fillStyle=t.strokeStyle,t.font=this.fontSize+"px "+this.fontFamily,t.zIndex=120,n.ctx.font="bold "+this.fontSize+"px "+this.fontFamily,n.ctx.strokeStyle="rgba("+(2*o+2)+",80,80,1)",n.ctx.fillStyle="rgba("+(2*o+2)+",80,80,1)";for(var s=this.userText.split(/\n/),l=0;l<s.length;l++){t.fillText(s[l],i[0]-r[0],i[1]-r[1]+(l+1)*this.fontSize),n.ctx.fillText(s[l],i[0]-r[0],i[1]-r[1]+(l+1)*this.fontSize);var d=s[l].replace(/[a-z]/g,"aa").replace(/[^\u0000-\u00ff]/g,"aaaa").replace(/[A-Z]/g,"aaa").replace(/[0-9]/g,"aa").length;n.ctx.fillRect(i[0]-r[0],i[1]-r[1]+l*this.fontSize,d*this.fontSize*4/14,20)}t.restore(),n.ctx.restore()},t.prototype.setPoints=function(e){this.drawPoints=e},t.prototype.getPoints=function(){return this.drawPoints},t.prototype.getId=function(){return this.textAreaId},t.prototype.getUserText=function(){return this.userText},t.prototype.getPureText=function(){return this.pureText},t.prototype.setUserText=function(e){this.userText=e},t.prototype.setPureText=function(e){this.pureText=e},t.prototype.show=function(e){var t=e.worldToClientPoint([this.drawPoints[0][0],this.drawPoints[0][1],this.drawPoints[0][2]]),n=document.getElementById(this.textAreaId),o=e.wrapDom,i=o.getBoundingClientRect();n.style.left=t[0]+i.left+"px",n.style.top=t[1]+i.top+"px",n.style.fontFamily=this.fontFamily,n.style.fontSize=this.fontSize,n.style.border="4px",n.style.resize="none",n.style.zIndex=100,n.style.display="block",n.value=this.userText},t.prototype.resizeText=function(e){this.virtualCtx.font=this.fontSize+"px "+this.fontFamily;for(var t=this.pureText||this.userText,n=t.split(/\n/),o=e[0],i=e[1],a=(this.fontSize,0);a<n.length;a++){for(var r="",s=n[a].slice(),l="",d=0,c=0;c<s.length;c++){var u=this.virtualCtx.measureText(s[c]).width;d+=u,r+=s[c],d>o&&r.length>1?(l+="\n"+s[c],d=u,r=s[c]):d==o?(n[a]=s.slice(0,c+1)+"\n"+s.slice(c+1),l+=s[c]+"\n",d=0,r=""):l+=s[c]}n[a]=l}this.userText=n.join("\n")},t.prototype.resizeTextarea=function(){var e=document.getElementById(this.textAreaId);e.value=this.userText;var t=this.userText.split(/\n/),n=0;e.rows=t.length;for(var o=0;o<t.length;o++){var i=t[o].replace(/[^\u0000-\u00ff]/g,"aa").replace(/[A-Z]/g,"aa").length;i>n&&(n=i)}e.cols=n},t.prototype.getTextBbox=function(e){var t,n=this.getTextSize(),o=e.worldToClientPoint(this.drawPoints[0]);return t=this.drawPoints[1]?e.worldToClientPoint(this.drawPoints[1]):[o[0]+n[0],o[1]+n[1]],o.concat(t)},t.prototype.getTextSize=function(){var e=0,t=0;this.virtualCtx.font=this.fontSize+"px "+this.fontFamily;for(var n,o=this.userText.split(/\n/),i=0;i<o.length;i++)n=this.virtualCtx.measureText(o[i]),n.width>e&&(e=n.width);return t=o.length*this.fontSize,[e,t]},t.prototype.getEndPt=function(e){var t=this.getTextBbox(e);return[t[2],t[3]]},t.prototype.getGrips=function(e){var t=e.worldToClientPoint(this.drawPoints[0]);if(this.drawPoints[1]){i=e.worldToClientPoint(this.drawPoints[1]);var n=[(t[0]+i[0])/2,(t[1]+i[1])/2]}else var o=this.getTextBbox(e),n=[(o[2]+o[0])/2,(o[3]+o[1])/2],i=[o[2],o[3]];var a=[];return a.push(t[0],t[1]),a.push(t[0],n[1]),a.push(t[0],i[1]),a.push(n[0],i[1]),a.push(i[0],i[1]),a.push(i[0],n[1]),a.push(i[0],t[1]),a.push(n[0],t[1]),a},t}(i.default);n.default=a},{"./../Markups":21}],29:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./TextMarkup"),a=e("./../MarkupTool"),r=e("./../Mouse"),s=r.MouseButtons,l=function(e){function t(t,n){var o=e.call(this)||this;return o.editorMode=-1,o.rotation=n,o.worldPoint=[],o.markupManager=t,o}return o(t,e),t.prototype.begin=function(e,n,o,i){this.startX=n,this.startY=o,this.textAreaId="";var a=!0;void 0==this.userText&&(a=this.initDom(e)),a&&""==t.lastTextareaId&&(this.createDiv(t.divId),this.insertTextArea2Dom(e),this.addKeyDownListener(e),this.addInputListener(e))},t.prototype.onEditing=function(e,t,n,o){},t.prototype.end=function(e,t,n,o){return s.FINISHED},t.prototype.onExit=function(e){""!=t.lastTextareaId&&(this.removeTextAreaInDom(t.lastTextareaId),t.lastTextareaId="")},t.prototype.initDom=function(e){if(""!=t.lastTextareaId){var n=document.getElementById(t.lastTextareaId),o=n.value.trim();if(""==o)this.removeTextAreaInDom(t.lastTextareaId);else{var a=e.wrapDom,r=a.getBoundingClientRect(),s=parseInt(n.style.left.split("px")[0]),l=parseInt(n.style.top.split("px")[0]),d=[s-r.left,l-r.top],c=e.clientToWorldPoint(d),u=n.style.color,p=e.markupManager.getFontSize(),h=n.style.fontFamily,f=new i.default(c,o,u,p,h,this.rotation||0,t.lastTextareaId);this.size&&(f.setPureText(o),this.setPureText(o),f.resizeText(this.size)),this.rotation=0,this.hideTextArea(t.lastTextareaId),this.addMarkup(e,f),f=null,this.redraw(e)}return t.lastTextareaId="",!1}return!0},t.prototype.createDiv=function(e){if(null==document.getElementById(e)){console.log("Create div in dom.");var n=document.createElement("div");n.addEventListener("mousedown",function(){event.stopImmediatePropagation()}),n.addEventListener("mouseup",function(){event.stopImmediatePropagation()}),n.addEventListener("mousemove",function(){event.stopImmediatePropagation()}),n.setAttribute("id",t.divId),n.style.position="absolute",n.style.left="0",n.style.top="0",this.markupManager.viewer.wrapDom.appendChild(n);var o=document.createElement("span");o.id="box",o.style.visibility="hidden",n.appendChild(o);var i=document.createElement("span");o.id="boxEdit",o.style.visibility="hidden",o.style.wordBreak="break-all",o.style.display="inline-block",n.appendChild(i)}},t.prototype.setEditBox=function(e){this.size=e},t.prototype.hideTextArea=function(e){document.getElementById(e).style.display="none"},t.prototype.showTextArea=function(e){document.getElementById(e).style.display="block"},t.prototype.setUserText=function(e){this.userText=e},t.prototype.setPureText=function(e){this.pureText=e},t.prototype.addKeyDownListener=function(e){var t=this,n=document.getElementById(this.textAreaId);n&&n.addEventListener("keydown",function(n){return t.keyDownFunction(e,n)},!0)},t.prototype.addInputListener=function(e){var t=this,n=document.getElementById(this.textAreaId);n&&(n.addEventListener("input",function(o){t.resize(n,e)}),n.addEventListener("blur",function(n){t.onExit(e)}))},t.prototype.resize=function(e,n){var o=e.value.split(/\n/),i=document.querySelectorAll("#"+t.divId+" span")[0];i.innerText=e.value,i.style.fontSize=n.markupManager.getFontSize()+"px",e.style.width=i.offsetWidth+10+"px",e.rows=o.length},t.prototype.keyDownFunction=function(e,t){var n=document.getElementById(this.textAreaId);13==t.keyCode&&(n.rows=n.rows+1,console.log("Key enter pressed."))},t.prototype.addMouseDownListener=function(){var e=document.getElementById(this.textAreaId);e&&e.addEventListener("click",function(e){console.log("Mouse click textarea now.")})},t.prototype.createTextArea=function(e){var t=[this.startX,this.startY];this.worldPoint=e.clientToWorldPoint(t);var n=document.createElement("textArea");n.setAttribute("id",this.textAreaId),n.setAttribute("maxlength",999),n.value=void 0==this.userText?"":this.userText,n.style.color=e.markupManager.getColor(),n.style.position="fixed",n.style.lineHeight="100%";this.editorMode;n.style.width="10px",n.style.paddingLeft="6px",n.style.overflow="hidden",void 0!=this.userText?this.resize(n,e):n.rows="1";var o=e.wrapDom,i=o.getBoundingClientRect();return n.style.left=t[0]+i.left+"px",n.style.top=t[1]+i.top+"px",n.style.fontFamily=e.markupManager.getFontFamily(),n.style.fontSize=e.markupManager.getFontSize()+"px",n.style.border="1px solid red",n.style.background="transparent",n.style.outline="none",n.style.resize="none",n.style.zIndex=100,n.style.display="block",n},t.prototype.insertTextArea2Dom=function(e){var n=document.getElementById(t.divId),o=n.childElementCount+1;this.textAreaId="textArea_"+o;var i=this.createTextArea(e);this.textArea=i,n.appendChild(i),i.focus(),t.lastTextareaId=this.textAreaId},t.prototype.reposition=function(e){var t=e.worldToClientPoint(this.worldPoint),n=e.wrapDom.getBoundingClientRect();this.textArea.style.left=t[0]+n.left+"px",this.textArea.style.top=t[1]+n.top+"px"},t.prototype.removeTextAreaInDom=function(e){var n=document.getElementById(t.divId),o=document.getElementById(e);try{n.removeChild(o)}catch(e){}},t.lastTextareaId="",t.divId="bf-drawing-textEditor",t}(a.default);n.default=l},{"./../MarkupTool":16,"./../Mouse":23,"./TextMarkup":28}]},{},[11]),function(){function e(t,n,o){function i(r,s){if(!n[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(a)return a(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[r]={exports:{}};t[r][0].call(c.exports,function(e){return i(t[r][1][e]||e)},c,c.exports,e,t,n,o)}return n[r].exports}for(var a="function"==typeof require&&require,r=0;r<o.length;r++)i(o[r]);return i}return e}()({1:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){}return e.create=function(e,t,n){var o=document.createElement(e);return o.id=t||"",o.style.position="absolute",o.style.width="100%",o.style.top=0,o.style.bottom=0,n&&n.appendChild(o),o},e.remove=function(e){var t=e.parentNode;t&&t.removeChild(e)},e.setPosition=function(e,t){e.position=t,e.style.left=t.x+"px",e.style.top=t.y+"px"},e.setOpacity=function(t,n){"opacity"in t.style?t.style.opacity=n:"filter"in t.style&&e._setOpacityIE(t,n)},e._setOpacityIE=function(e,t){var n=!1,o="DXImageTransform.Microsoft.Alpha";try{n=e.filters.item(o)}catch(e){if(1===t)return}t=Math.round(100*t),n?(n.Enabled=100!==t,n.Opacity=t):e.style.filter+=" progid:"+o+"(opacity="+t+")"},e.splitStr=function(e){return e.trim().split(/\s+/g)},e.getContainerOffsetToClient=function(e){var t,n=function(e){for(var t=0,n=0;e;)t+=e.offsetTop,n+=e.offsetLeft,e=e.offsetParent;var o=document.body,i=document.documentElement,a=window.pageYOffset||i.scrollTop||o.scrollTop,r=window.pageXOffset||i.scrollLeft||o.scrollLeft;return t-=a,n-=r,{top:t,left:n}},o=function(e){var t=e.getBoundingClientRect(),n=document.body,o=document.documentElement,i=o.clientTop||n.clientTop,a=o.clientLeft||n.clientLeft,r=t.top-i,s=t.left-a;return{top:Math.round(r),left:Math.round(s)}};if(e!=document){var i=function(e){return e.getBoundingClientRect?o(e):n(e)}(e);t={width:e.offsetWidth,height:e.offsetHeight,left:i.left,top:i.top}}else t={width:window.innerWidth,height:window.innerHeight,left:0,top:0};return t},e.setClassName=function(e,t){var n=document.getElementById(e);n&&(n.className=t)},e.addClassName=function(e,t){var n,o,i,a,r,s=/\s+/,l=document.getElementById(e);if(l&&(o=l,t&&"string"==typeof t&&(n=t.split(s),1===o.nodeType)))if(o.className||1!==n.length){for(i=" "+o.className+" ",a=0,r=n.length;a<r;++a)i.indexOf(" "+n[a]+" ")<0&&(i+=n[0]+" ");o.className=i.trim()}else o.className=t},e.removeClassName=function(e,t){var n,o,i,a,r,s=/\s+/,l=document.getElementById(e);if(l&&(i=l,t&&"string"==typeof t&&(n=(t||"").split(s),1===i.nodeType&&i.className))){for(o=(" "+i.className+" ").replace("O"," "),a=0,r=n.length;a<r;a++)for(;o.indexOf(" "+n[a]+" ")>=0;)o=o.replace(" "+n[a]+" "," ");i.className=t?o.trim():""}},e.showOrHideElement=function(e,t){var n=document.getElementById(e);n&&(n.style.display=t?"":"none")},e.prototype.getStyleString=function(e){var t=[];for(var n in e){var o=e[n];t.push(n),t.push(":"),t.push(o),t.push("; ")}return t.join("")},e.cloneStyle=function(e){var t={};for(var n in e)t[n]=e[n];return t},e.removeStyleAttribute=function(e,t){Array.isArray(t)||(t=[t]),t.forEach(function(t){t in e&&delete e[t]})},e.trimRight=function(e){if(0===e.length)return"";for(var t=e.length-1,n=t;n>=0;--n)if(" "!==e.charAt(n)){t=n;break}return e.substr(0,t+1)},e.trimLeft=function(e){if(0===e.length)return"";for(var t=0,n=0;n<e.length;++n)if(" "!==e.charAt(n)){t=n;break}return e.substr(t)},e.matchesSelector=function(e,t){if(e.matches)return e.matches(t);if(e.matchesSelector)return e.matchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.mozMatchesSelector)return e.mozMatchesSelector(t);if(e.oMatchesSelector)return e.oMatchesSelector(t);if(e.querySelectorAll){for(var n=(e.document||e.ownerDocument).querySelectorAll(t),o=0;n[o]&&n[o]!==e;)o++;return!!n[o]}return!1},e.toTranslate3d=function(e,t){return"translate3d("+e+"px,"+t+"px,0)"},e.setCursorStyle=function(e,t){var n;switch(t){case"n":case"s":n="ns-resize";break;case"w":case"e":n="ew-resize";break;case"ne":case"sw":n="nesw-resize";break;case"nw":case"se":n="nwse-resize"}e.style.cursor=n},e}();n.DomUtil2D=o},{}],2:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){}return e.createSvgElement=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg",e);return t.setAttribute("pointer-events","inherit"),t},e.getRGBAString=function(e,t){return t<=0?"none":["rgba("+parseInt("0x"+e.substr(1,2)),",",parseInt("0x"+e.substr(3,2)),",",parseInt("0x"+e.substr(5,2)),",",t,")"].join("")},e.makeFlag=function(){var e=this.createSvgElement("path");return e.setAttribute("d","M0 0 L0 -20 L15 -13 L4 -6.87 L4 0Z"),e},e.makeBubble=function(){var e=this.createSvgElement("path");return e.setAttribute("d","m0.0035,-19.88544c-3.838253,0 -6.95,2.581968 -6.95,5.766754c0,3.185555 6.95,13.933247 6.95,13.933247s6.95,-10.747692 6.95,-13.933247c0,-3.184786 -3.11082,-5.766754 -6.95,-5.766754z"),e},e.makeCommon=function(e,t){var n=this.createSvgElement("image");return n.href.baseVal=e,n.setAttribute("height",t.height.toString()+"px"),n.setAttribute("width",t.width.toString()+"px"),n},e}();n.Shape2D=o},{}],3:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),e("./View3dAdapter"),e("./View2dAdapter"),e("./MarkerEditor")},{"./MarkerEditor":7,"./View2dAdapter":9,"./View3dAdapter":10}],4:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../Common/Utils/DomUtil2D"),i=function(){function e(t,n){this.id=t,this.editor=n,this.position=new window.THREE.Vector3,this.boundingBox=new window.THREE.Box3,this.shape=null,this.style=e.getDefaultStyle(),this.selected=!1,this.highlighted=!1,this.highlightColor="#000088",this.isDisableInteractions=!1,this.ratioW=1,this.ratioH=1,this.keys={BACKSPACE:8,ALT:18,ESC:27,LEFT:37,UP:38,RIGHT:39,BOTTOM:40,DELETE:46,ZERO:48,A:65,D:68,E:69,Q:81,S:83,W:87,PLUS:187,SUB:189},this.onMouseDownBinded=this.onMouseDown.bind(this),this.onKeyUpBinded=this.onKeyUp.bind(this)}return e.prototype.addDomEventListeners=function(){this.shape.addEventListener("mousedown",this.onMouseDownBinded,!0),this.shape.addEventListener("touchstart",this.onMouseDownBinded,!0),window.addEventListener("keyup",this.onKeyUpBinded)},e.prototype.removeDomEventListeners=function(){this.shape.removeEventListener("mousedown",this.onMouseDownBinded,!0),this.shape.removeEventListener("touchstart",this.onMouseDownBinded,!0),window.removeEventListener("keyup",this.onKeyUpBinded)},e.prototype.onMouseDown=function(e){e.preventDefault(),e.stopPropagation(),this.select(e.button)},e.prototype.onKeyUp=function(e){switch(e.keyCode){case this.keys.DELETE:this.editor.deselectMarker(),this.delete()}},e.prototype.createShape=function(){},e.prototype.destroy=function(){this.removeDomEventListeners(),this.deselect(),this.setParent(null)},e.prototype.set=function(e,t,n,i){this.userId=e,this.position.set(t.x,t.y,t.z),this.boundingBox=n&&n.clone(),i&&(this.style=o.DomUtil2D.cloneStyle(i)),this.update()},e.prototype.setRatio=function(e,t){this.ratioW=e,this.ratioH=t},e.prototype.setParent=function(e){var t=this.shape;t&&(t.parentNode&&t.parentNode.removeChild(t),e&&e.appendChild(t))},e.prototype.setStyle=function(e){this.style=o.DomUtil2D.cloneStyle(e),this.update()},e.prototype.select=function(e){this.selected||(this.selected=!0,this.highlight(!0)),this.editor.selectMarker(this,e)},e.prototype.deselect=function(){this.highlight(!1),this.selected=!1},e.prototype.highlight=function(e){this.isDisableInteractions||(this.highlighted=e,this.update())},e.prototype.disableInteractions=function(e){this.isDisableInteractions=e},e.prototype.delete=function(){this.editor.deleteMarker(this)},e.prototype.getClientPosition=function(){return this.editor.getAdapter().worldToClient(this.position)},e.prototype.getBoundingBox=function(){return this.boundingBox},e.prototype.toNewObject=function(){return{id:this.id,userId:this.userId,shapeType:this.shapeType,cx:this.cx,cy:this.cy,position:this.position?this.position.clone():null,boundingBox:this.boundingBox?this.boundingBox.clone():null}},e.prototype.show=function(){this.shape.style.display="block"},e.prototype.hide=function(){this.shape.style.display="none"},e.prototype.update=function(){var e=this.style["stroke-width"],t=this.highlighted?this.highlightColor:this.style["stroke-color"],n=this.style["stroke-opacity"],o=this.style["fill-color"],i=this.style["fill-opacity"],a=this.getClientPosition();if(!a)return void(this.shape.style.display="none");var r=a.x,s=a.y;if(2==this.shapeType)var l=["translate(",r-this.pictureSize.width*this.ratioW*.5,",",s-this.pictureSize.height*this.ratioH*.5,") "].join("");else var l=["translate(",r,",",s,") "].join("");this.cx=r,this.cy=s,this.shape.setAttribute("transform",l),this.shape.setAttribute("stroke-width",e),this.shape.setAttribute("stroke",t),this.shape.setAttribute("stroke-opacity",n),this.shape.setAttribute("fill",o),this.shape.setAttribute("fill-opacity",i)},e.shapeTypes={BUBBLE:0,FLAG:1,COMMON:2},e.getDefaultStyle=function(){var e={};return e["stroke-width"]=2,e["stroke-color"]="#fffaff",e["stroke-opacity"]=1,e["fill-color"]="#ff2129",e["fill-opacity"]=1,e},e}();n.Marker=i},{"../../Common/Utils/DomUtil2D":1}],5:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./Marker"),a=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.shapeType=i.Marker.shapeTypes.BUBBLE,o.createShape(),o.addDomEventListeners(),o}return o(t,e),t}(i.Marker);n.MarkerBubble=a},{"./Marker":4}],6:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./Marker"),a=e("./../../Common/Utils/Shape2D"),r=function(e){function t(t,n,o,a){var r=e.call(this,t,n)||this;return r.shapeType=i.Marker.shapeTypes.COMMON,r.pictureSize=a||{width:20,height:20},r.createShape(o),r.addDomEventListeners(),r}return o(t,e),t.prototype.createShape=function(e){this.shape=a.Shape2D.makeCommon(e,this.pictureSize)},t.prototype.reset=function(){var e=this.pictureSize.width*this.ratioW,t=this.pictureSize.height*this.ratioH;this.shape.setAttribute("width",e.toString()+"px"),this.shape.setAttribute("height",t.toString()+"px")},t}(i.Marker);n.MarkerCommon=r},{"./../../Common/Utils/Shape2D":2,"./Marker":4}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("./MarkerBubble"),i=e("./MarkerCommon"),a=e("./MarkerFlag"),r=e("./../../Common/Utils/Shape2D"),s=e("./Marker"),l=function(){function e(e){this.disableInteractions=function(e){this.isDisableInteractions=e},this.adapter=e,this.markers=[],this.mapGroupMarkers={},this.groups=null,this.selectedMarker=null,this.flagColors={red:"#ff2129",green:"#85af03",yellow:"#fe9829"},this.bubbleColors={red:"#f92a24",green:"#86b507",gray:"#ff9326"},this.nextMarkerId=0,this.initialized=!1,this.markerClickCallback=null,this.markerRightClickCallback=null,this.markersRatioH=1,this.markersRatioW=1}return e.prototype.getAdapter=function(){return this.adapter},e.prototype.updateDomContainer=function(){var e=this.adapter.getDomContainer();this.adapter.setDomContainer(e)},e.prototype.getMarkers=function(){return this.markers},e.prototype.getMarkersByGroupName=function(e){return this.mapGroupMarkers.hasOwnProperty(e)?this.mapGroupMarkers[e]:[]},e.prototype.addMarkerToGroup=function(e,t){this.mapGroupMarkers.hasOwnProperty(t)||(this.mapGroupMarkers[t]=[]),this.mapGroupMarkers[t].push(e)},e.prototype.setMarkerGroups=function(e){this.groups=e},e.prototype.removeMarkerInGroup=function(e,t){for(var n=this.mapGroupMarkers[t],o=0,i=n.length;o<i;o++)if(n[o].userId==e)return n.splice(o,1),void this.updateByGroup()},e.prototype.removeMarker=function(e){for(var t=this.markers,n=0,o=t.length;n<o;n++)if(t[n].userId==e)return t[n].destroy(),void t.splice(n,1)},e.prototype.clearMarkers=function(){this.unloadMarkers(!0),this.markers=[],this.mapGroupMarkers={}},e.prototype.setVisible=function(e,t){var n=this.mapGroupMarkers;for(var o in n){var i=n[o];if(i instanceof Array){var a=i.getObjectByAttribute("id",e);a&&(!0===t?a.show():a.hide())}}},e.prototype.updateByGroup=function(e){var t=e||this.groupName;this.unloadMarkers();var n=this.mapGroupMarkers[t];if(n instanceof Array)for(var o=0,i=n.length;o<i;o++)n[o]&&n[o].setParent(this.svgGroup)},e.prototype.resize=function(e){var t=this.adapter.getInitialDomSize(),n=e.width/t.width,o=e.height/t.height;this.markersRatioH=o,this.markersRatioW=n;var i=this.mapGroupMarkers[this.groupName];if(i instanceof Array){for(var a=0,r=i.length;a<r;a++){var s=i[a];s.setRatio(n,o),s.reset(),s.update()}e.width==t.width&&e.height==t.height||(t=e),this.svg.setAttribute("width",e.width+""),this.svg.setAttribute("height",e.height+"")}},e.prototype.setGroupName=function(e){this.groupName=e},e.prototype.updateGroupName=function(){var e=this.adapter.getMinimap();e&&(this.groupName=e.getFloorPlaneName())},e.prototype.onResize=function(){if(this.svg){var e=this.adapter.getDomContainerBounds();this.svg.setAttribute("width",e.width+""),this.svg.setAttribute("height",e.height+""),this.updateMarkers()}},e.prototype.init=function(){if(!this.svg){var e=this.adapter.getDomContainerBounds(),t=e.width,n=e.height;this.svg=r.Shape2D.createSvgElement("svg"),this.svg.style.position="absolute",this.svg.style.display="block",this.svg.style.position="absolute",this.svg.style.display="block",this.svg.style.left="0",this.svg.style.top="0",this.svg.setAttribute("width",t+""),this.svg.setAttribute("height",n+"");this.adapter.getDomContainer().appendChild(this.svg),this.svgGroup=r.Shape2D.createSvgElement("g"),this.svg.insertBefore(this.svgGroup,this.svg.firstChild)}this.initialized=!0},e.prototype.uninit=function(){this.initialized=!1,this.svg&&(this.unloadMarkers(),this.svgGroup&&this.svgGroup.parentNode&&this.svgGroup.parentNode.removeChild(this.svgGroup),this.svg.parentNode&&this.svg.parentNode.removeChild(this.svg),this.svgGroup=null,this.svg=null,this.markerClickCallback=null,this.markerRightClickCallback=null)},e.prototype.isInitialized=function(){return this.initialized},
e.prototype.generateMarkerId=function(){return++this.nextMarkerId,this.nextMarkerId.toString(10)},e.prototype.clear=function(e){var t=this.markers;if(1==e)for(;t.length;){var n=t[0];this.deleteMarker(n)}var o=this.svgGroup;if(o&&o.childNodes.length>0)for(;o.childNodes.length;)o.removeChild(o.childNodes[0])},e.prototype.addMarker=function(e){if("VIEW3D"==this.adapter.getName()&&e.setParent(this.svgGroup),this.markers.push(e),this.groups)for(var t=0,n=this.groups.length;t<n;t++)this.addMarkerToGroup(e,this.groups[t]);this.groupName&&this.updateByGroup(this.groupName)},e.prototype.deleteMarker=function(e){if(e){this.removeMarker(e.userId);var t=this.mapGroupMarkers;for(var n in t)this.removeMarkerInGroup(e.userId,n);t&&this.updateByGroup()}},e.prototype.selectMarker=function(e,t){if(!0===this.isDisableInteractions)return this.markerClickCallback&&0==t&&this.markerClickCallback(e.toNewObject()),void(this.markerRightClickCallback&&2==t&&this.markerRightClickCallback(e.toNewObject()));this.selectedMarker!==e?(this.deselectMarker(),this.selectedMarker=e):this.deselectMarker(),this.markerClickCallback&&(this.selectedMarker?this.markerClickCallback(this.selectedMarker.toNewObject()):this.markerClickCallback(null))},e.prototype.deselectMarker=function(){this.selectedMarker&&(this.selectedMarker.deselect(),this.selectedMarker=null)},e.prototype.enableSVGPaint=function(e){e?this.svg&&this.svg.setAttribute("pointer-events","painted"):this.svg&&this.svg.setAttribute("pointer-events","none")},e.prototype.getMarkerColor=function(e,t){var n=this.bubbleColors.red;switch(e<0&&e>1&&(e=0),t>2&&(t-=3),t<0&&t>2&&(t=0),t){case 0:n=0===e?this.bubbleColors.red:this.flagColors.red;break;case 1:n=0===e?this.bubbleColors.green:this.flagColors.green;break;case 2:n=0===e?this.bubbleColors.gray:this.flagColors.yellow}return n},e.prototype.createMarkerByIntersect=function(e,t,n,o){var i=e.id||this.generateMarkerId(),a=e.userId,r=e.worldPosition||e.object.point,s=e.worldBoundingBox||e.object&&e.object.boundingBox,l={size:o,id:i,userId:a,position:r,boundingBox:s,shapeType:t,state:n};this.createMarker(l)},e.prototype.createMarker=function(e){if(e){var t=s.Marker.getDefaultStyle();t["fill-color"]=this.getMarkerColor(e.shapeType,e.state);var n,r=e.id||this.generateMarkerId(),l=s.Marker.shapeTypes;switch(e.shapeType){case l.BUBBLE:n=new o.MarkerBubble(r,this);break;case l.COMMON:n=new i.MarkerCommon(r,this,e.state,e.size),n.setRatio(this.markersRatioW,this.markersRatioH),n.reset();break;case l.FLAG:default:n=new a.MarkerFlag(r,this)}this.isDisableInteractions&&n.disableInteractions(!0),n.set(e.userId,e.position,e.boundingBox,t),this.addMarker(n)}},e.prototype.getMarkersBoundingBox=function(){if(this.markers.length<1)return null;for(var e=new window.THREE.Box3,t=0,n=this.markers.length;t<n;t++){var o=this.markers[t];o.getBoundingBox()&&e.union(o.getBoundingBox())}return e},e.prototype.getMarkerInfoList=function(){for(var e=[],t=0,n=this.markers.length;t<n;t++){var o=this.markers[t],i=o.userId+"_"+t,a={id:o.id||i,userId:o.userId,shapeType:o.shapeType,position:o.position,boundingBox:o.boundingBox,state:o.state};e.push(a)}return e},e.prototype.loadMarkers=function(e){this.clear();for(var t=0,n=e.length;t<n;t++){var o=e[t],i=o.userId+"_"+t,a=o.id||i,r=o.userId,s=o.shapeType,l=o.state,d=o.position,c=new window.THREE.Box3;c.max.x=o.boundingBox.max.x,c.max.y=o.boundingBox.max.y,c.max.z=o.boundingBox.max.z,c.min.x=o.boundingBox.min.x,c.min.y=o.boundingBox.min.y,c.min.z=o.boundingBox.min.z;var u={id:a,userId:r,position:d,boundingBox:c,shapeType:s,state:l};this.createMarker(u)}},e.prototype.loadMarkersFromIntersect=function(e,t,n){this.clear(),this.createMarkerByIntersect(e,t,n)},e.prototype.unloadMarkers=function(e){this.clear(e)},e.prototype.updateMarkers=function(){for(var e=0,t=this.markers.length;e<t;e++){this.markers[e].update()}},e.prototype.getMarker=function(e){for(var t=this.markers,n=t.length,o=0;o<n;++o)if(t[o].userId==e)return t[o];return null},e.prototype.getMarkerByUserId=function(e){for(var t=this.markers,n=t.length,o=0;o<n;++o)if(t[o].userId==e)return t[o];return null},e.prototype.setMarkerClickCallback=function(e){this.markerClickCallback=e},e.prototype.setMarkerRightClickCallback=function(e){this.markerRightClickCallback=e},e.prototype.zoomAndPanMarkerById=function(e,t,n,o){var i=this.mapGroupMarkers,a=this.svg.getAttribute("width"),r=this.svg.getAttribute("height"),s=new THREE.Vector2(.5*a,.5*r);for(var l in i){var d=i[l];if(d instanceof Array){var c=d.getObjectByAttribute("id",e);if(c){var u=c.getClientPosition(),p=c.pictureSize.width*c.ratioW,h=c.pictureSize.height*c.ratioH,f=new THREE.Vector2(u.x,u.y),m=f.clone().sub(s);m.multiplyScalar(o);var g=s.x+m.x-.5*p,v=s.y+m.y-.5*h,b=g+t,y=v+n,w="translate("+b+","+y+")";c.shape.setAttribute("transform",w)}}}},e}();n.MarkerEditor=l,window.MarkerEditor=l},{"./../../Common/Utils/Shape2D":2,"./Marker":4,"./MarkerBubble":5,"./MarkerCommon":6,"./MarkerFlag":8}],8:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./Marker"),a=e("./../../Common/Utils/Shape2D"),r=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.shapeType=i.Marker.shapeTypes.COMMON,o.createShape(),o.addDomEventListeners(),o}return o(t,e),t.prototype.createShape=function(){this.shape=a.Shape2D.makeFlag()},t}(i.Marker);n.MarkerFlag=r},{"./../../Common/Utils/Shape2D":2,"./Marker":4}],9:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ViewAdapter"),a=function(e){function t(t,n){var o=e.call(this)||this;o.name="VIEW2D",o.minimap=t,o.domContainer=t.getMapContainer(),o.cameraControl=n.cameraControl,o.scene=n.getScene();var i=t.viewerFloor.vfData,a=i.width||298,r=i.height||198;return o.initialDomSize={width:a,height:r},o.currentDomSize={width:a,height:r},o}return o(t,e),t.prototype.getInitialDomSize=function(){return this.initialDomSize},t.prototype.resize=function(e){this.currentDomSize=e},t.prototype.getDomContainerBounds=function(){return this.currentDomSize},t.prototype.getMinimap=function(){return this.minimap},t.prototype.worldToClient=function(e){var t=new window.THREE.Vector3(e.x,e.y,e.z),n=this.minimap.getAxisGridBox2D();this.worldToNormalizedPoint(t,n);var o=this.getDomContainerBounds(),i={width:o.width/2,height:o.height/2};return this.normalizedPointToScreen(t,i),t.x+=i.width,t.y+=i.height,t},t.prototype.normalizedPointToScreen=function(e,t){e.x=e.x*t.width,e.y=-e.y*t.height},t.prototype.worldToNormalizedPoint=function(e,t){var n=t.getSize();e.x=(e.x-t.min.x)/n.x*2-1,e.y=(e.y-t.min.y)/n.y*2-1},t}(i.ViewAdapter);window.Glodon.Bimface.Marker.View2dAdapter=a},{"./ViewAdapter":11}],10:[function(e,t,n){var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ViewAdapter"),a=function(e){function t(t){var n=e.call(this)||this;return n.name="VIEW3D",n.domContainer=t.domElement,n.cameraControl=t.cameraControl,n.scene=t.getScene(),n}return o(t,e),t.prototype.worldToClient=function(e){var t=this.getDomContainerBounds(),n=this.cameraControl.camera,o=this.getSceneMatrix(),i=new window.THREE.Vector3(e.x,e.y,e.z);return i.applyMatrix4(o),i.project(n),Math.abs(i.z)>1?null:(i.x=Math.round(.5*(i.x+1)*t.width),i.y=Math.round(-.5*(i.y-1)*t.height),i.z=0,i)},t}(i.ViewAdapter);window.Glodon.Bimface.Marker.View3dAdapter=a},{"./ViewAdapter":11}],11:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o=e("../../Common/Utils/DomUtil2D"),i=function(){function e(){this.domContainer=null,this.cameraControl=null,this.scene=null,this.name=""}return e.prototype.getName=function(){return this.name},e.prototype.setDomContainer=function(e){this.domContainer=e},e.prototype.getDomContainer=function(){return this.domContainer},e.prototype.worldToClient=function(e){},e.prototype.clientToWorld=function(e){var t=this.getDomContainerBounds(),n=this.cameraControl.camera,o=new window.THREE.Vector3;o.x=e.x/t.width*2-1,o.y=-e.y/t.height*2+1,o.z=0,o.unproject(n);var i=this.getInverseSceneMatrix();return o.applyMatrix4(i),o},e.prototype.getSceneMatrix=function(){return this.scene.getMatrixGlobal()},e.prototype.getInverseSceneMatrix=function(){var e=this.getSceneMatrix(),t=new window.THREE.Matrix4;return t.getInverse(e),t},e.prototype.clientToViewport=function(e){var t=this.getDomContainerBounds(),n=new window.THREE.Vector3;return n.x=e.x/t.width*2-1,n.y=-e.y/t.height*2+1,n.z=0,n},e.prototype.getDomContainerBounds=function(e){return o.DomUtil2D.getContainerOffsetToClient(e||this.domContainer)},e}();n.ViewAdapter=i,window.Glodon.Bimface.Marker={}},{"../../Common/Utils/DomUtil2D":1}]},{},[3]),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI"),t=function(){return{Toolbars:["MainToolbar","ModelTree"],Buttons:["Home","RectangleSelect","Measure","Section","Walk","Map","Property","Setting","Information","FullScreen"],contextMenu:!0,viewer:null,element:null}};e.UIConfig=t}(),function(){var e=Glodon.Web.Lang.Utility.Namespace.ensureNamespace(Glodon,"Bimface.Application.UI"),t=function(e){var t=this,n=e.viewer;this._toolbars=[],this._panels=[],this._plugins=[],this._opt=e,this._objectTypes={},this._contextMenuCb=function(e){n.contextMenu&&n.contextMenu.element&&n.contextMenu.destroy();var o=e.clientPosition,i=e.containerBox,a=n.getSelectedComponents(),r=new Glodon.Bimface.Application.UI.Menu.ContextMenu(t,a,t._objectTypes),s={},l=r.element.getBoundingClientRect();i.width-o.x>2*l.width?(s.x=o.x,r.element.removeClass("bf-menu-left"),r.element.addClass("bf-menu-right")):(s.x=o.x-l.width,r.element.addClass("bf-menu-left"),r.element.removeClass("bf-menu-right")),i.height-o.y>l.height?s.y=o.y:s.y=o.y-l.height,r.setPosition(s),n.contextMenu=r};var o={initialized:!1,menu:!0,hobby:!0,hover:!1,scroll:!1,backgroundColor:1,borderLine:!1,environment:"color",effect:"low",exposure:0,enableIBLBackground:!1,ambientLight:!1,IBLName:"none",SSAO:!1};o.setDefault=function(){var e=n.getInformation(),t=n.getLoadIBLScene();o=Object.assign(o,{menu:n.isEnableToggleContextMenuDisplay(),hover:n.isEnableHover(),borderLine:n.isEnableBorderLine(),exposure:n.getExposureShift(),ambientLight:n.isEnableIBLBackground(),IBLName:t.IBLSceneOption,enableIBLBackground:t.withBackground}),e.elements>8e4&&e.triangles>2e7?o.effect="high":o.effect="low"},this.state=o};t.prototype={init:function(){if(this.state.initialized)return!1;var e,t=this,n=this._opt,o=n.viewer,i=o._data,a=n.Toolbars,r=o._manifest,s=r.Features.HasComponentStructure||r.Features.HasFileList||r.Features.HasLinkRelation||r.Features.HasRoom||r.Features.HasArea||r.Features.HasDrawing||r.Features.HasMEPSystem||r.Features.HasGroup||r.Features.HasAssemble;if(r.Metadata.filetype){var l=r.Metadata.FileType;e="rfa"!=l&&"stp"!=l&&"step"!=l}else e=!i.workerType||-1==i.workerType.indexOf("rfa-")&&-1==i.workerType.indexOf("stp-")&&-1==i.workerType.indexOf("step-");if(-1!=a.indexOf("MainToolbar")){var d=Glodon.Bimface.UI.Toolbar.ToolbarConfig();d.id="MainToolbar",d.title="主菜单",d.className="bf-toolbar bf-toolbar-bottom",d.element=n.element,d.buttons=[].concat(_toConsumableArray(n.Buttons)),r.Features.HasComponentProperty||(d.buttons.removeByValue("Property"),d.buttons.removeByValue("MobileProperty")),r.Features.HasMiniMap||d.buttons.removeByValue("Map"),e||d.buttons.removeByValue("Walk"),this.addToolbar(d)}if(s&&-1!=a.indexOf("ModelTree")&&!t._modelTree){var c=Glodon.Bimface.UI.Toolbar.ToolbarConfig();c.id="ModelTree",c.title="目录树",c.className="bf-toolbar bf-toolbar bf-tree-toolbar",c.element=n.element,c.buttons=["ModelTree"],this.addToolbar(c)}if(r.Features.HasFamilyTypeList&&n.EnableFamilyList){var u=Glodon.Bimface.UI.Toolbar.ToolbarConfig();u.id="FamilyTypes",u.title="FamilyTypes",u.className="bf-toolbar bf-toolbar bf-toolbar-select",u.element=n.element,u.buttons=["FamilyList"],this.addToolbar(u)}n.contextMenu&&(o.addEventListener(Glodon.Bimface.Viewer.Viewer3DEvent.ContextMenu,t._contextMenuCb),o.addEventListener(Glodon.Bimface.Viewer.Viewer3DEvent.ComponentsSelectionChanged,function(e){e.objectId&&(t._objectTypes[e.objectId]=e.objectType)})),this.onKeyUp=function(e){if(e&&27==e.keyCode&&!CLOUD.EditorConfig.NoKey){var n=t.getToolbar("MainToolbar"),i=n.getControl("RectangleSelect"),a=n.getControl("Measure"),r=getSectionState(t),s=n.getControl("Walk");if(i&&i.isChecked())i.setCheckedState(!1);else if(a&&a.isChecked()){var l=t.getPlugin("Measure");l&&l.getInfo().points.length>0?l.redo():a.setCheckedState(!1)}else r.enable?clearSection(t):s&&s.isChecked()&&s.setCheckedState(!1);o.render()}},document.addEventListener("keyup",this.onKeyUp),t.state.setDefault(),t.state.initialized=!0},addToolbar:function(e){var t=this,n=Glodon.Bimface.Application.UI.Toolbar.Toolbar(e,t);this._toolbars.push(n)},removeToolbar:function(e){return this._toolbars.removeObjectByAttribute("id",e),[].concat(_toConsumableArray(this._toolbars))},getToolbar:function(e){return this._toolbars.getObjectByAttribute("id",e)},getToolbars:function(){return[].concat(_toConsumableArray(this._toolbars))},getViewer:function(){return this._opt.viewer},getRootElement:function(){return this._opt.element},addPanel:function(e){this._panels.push(e)},removePanel:function(e){this._panels.removeObjectByAttribute("id",e)},getPanel:function(e){return this._panels.getObjectByAttribute("id",e)},getPanels:function(e){return[].concat(_toConsumableArray(this._panels))},addPlugin:function(e){this._plugins.push(e)},removePlugin:function(e){this._plugins.removeObjectByAttribute("id",e)},getPlugin:function(e){return this._plugins.getObjectByAttribute("id",e)},getPlugins:function(e){return[].concat(_toConsumableArray(this._plugins))},destroy:function(){document.removeEventListener("keyup",this.onKeyUp),this._opt.viewer.removeEventListener(Glodon.Bimface.Viewer.Viewer3DEvent.ContextMenu,this._contextMenuCb);for(var e=0;e<this._toolbars.length;e++)this._toolbars[e].destroy();for(var t=0;t<this._panels.length;t++)this._panels[t].destroy();for(var n=0;n<this._plugins.length;n++)this._plugins[n].exit();this._toolbars=[],this._panels=[],this._plugins=[],this.state.initialized=!1,this._opt.viewer.render(),this._opt=null},updateModelTree:function(){var e=this,t=this._opt,n=t.viewer,o=n._manifest,i=o.Features.HasComponentStructure||o.Features.HasFileList||o.Features.HasLinkRelation||o.Features.HasRoom||o.Features.HasArea||o.Features.HasDrawing||o.Features.HasMEPSystem||o.Features.HasGroup||o.Features.HasAssemble,a=e.getPanel("ModelTree"),r=e.getToolbar("ModelTree");if(a){var s=a.isShow;if(s&&a.hide(),a.destroy(),e.removePanel("ModelTree"),s){r.hide();var l=new Glodon.Bimface.Application.UI.Panel.ModelTreePanel(e,r);e.getRootElement().appendChild(l.element),e.addPanel(l)}}if(!i&&r)r.destroy(),e.removeToolbar("ModelTree");else if(i&&!r){var d=Glodon.Bimface.UI.Toolbar.ToolbarConfig();d.id="ModelTree",d.title="目录树",d.className="bf-toolbar bf-toolbar bf-tree-toolbar",d.element=t.element,d.buttons=["ModelTree"],e.addToolbar(d)}}},e.UI=t}();